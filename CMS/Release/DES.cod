; Listing generated by Microsoft (R) Optimizing Compiler Version 15.00.30729.01 

	TITLE	i:\?n????j\My Project\CMS\CMS\ASN1\Algorithm\DES.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB OLDNAMES

PUBLIC	?decrypt_ecb@DES@@UAEXPAX@Z			; DES::decrypt_ecb
PUBLIC	?encrypt_ecb@DES@@UAEXPAX@Z			; DES::encrypt_ecb
PUBLIC	?Clear_Key@DES@@UAEXXZ				; DES::Clear_Key
PUBLIC	??_R4DES@@6B@					; DES::`RTTI Complete Object Locator'
PUBLIC	??_R3DES@@8					; DES::`RTTI Class Hierarchy Descriptor'
PUBLIC	??_R2DES@@8					; DES::`RTTI Base Class Array'
PUBLIC	??_R1A@?0A@EA@DES@@8				; DES::`RTTI Base Class Descriptor at (0,-1,0,64)'
PUBLIC	??_R0?AVDES@@@8					; DES `RTTI Type Descriptor'
PUBLIC	?Set_Key@DES@@UAEXPAX@Z				; DES::Set_Key
PUBLIC	??_7DES@@6B@					; DES::`vftable'
;	COMDAT ??_7DES@@6B@
CONST	SEGMENT
??_7DES@@6B@ DD	FLAT:??_R4DES@@6B@			; DES::`vftable'
	DD	FLAT:?encodeBER@Sequence@@UAEXXZ
	DD	FLAT:?Get_BERcode@ASN1@@UAEPBDXZ
	DD	FLAT:?Get_BERsize@ASN1@@UAEIXZ
	DD	FLAT:?Set_Key@DES@@UAEXPAX@Z
	DD	FLAT:?Clear_Key@DES@@UAEXXZ
	DD	FLAT:?init@Encryption@@UAEXXZ
	DD	FLAT:?encrypt@Encryption@@UAEXPAX@Z
	DD	FLAT:?decrypt@Encryption@@UAEXPAX@Z
	DD	FLAT:?encrypt_ecb@DES@@UAEXPAX@Z
	DD	FLAT:?decrypt_ecb@DES@@UAEXPAX@Z
	DD	FLAT:?SetIV@Encryption@@UAEXPAX@Z
	DD	FLAT:?encipher@Encryption@@UAEXPAXI@Z
	DD	FLAT:?decipher@Encryption@@UAEXPAXI@Z
	DD	FLAT:?encipher_last@Encryption@@UAEHPAXI@Z
	DD	FLAT:?decipher_last@Encryption@@UAEHPAXI@Z
	DD	FLAT:?KeyWrap@Encryption@@UAEHPAXI@Z
	DD	FLAT:?KeyUnWrap@Encryption@@UAEHPAXI@Z
	DD	FLAT:?GetKey@Encryption@@UAEPAXXZ
	DD	FLAT:?GetEncrptedKey@Encryption@@UAEPAXXZ
CONST	ENDS
;	COMDAT ??_R4DES@@6B@
rdata$r	SEGMENT
??_R4DES@@6B@ DD 00H					; DES::`RTTI Complete Object Locator'
	DD	00H
	DD	00H
	DD	FLAT:??_R0?AVDES@@@8
	DD	FLAT:??_R3DES@@8
rdata$r	ENDS
;	COMDAT ??_R3DES@@8
rdata$r	SEGMENT
??_R3DES@@8 DD	00H					; DES::`RTTI Class Hierarchy Descriptor'
	DD	00H
	DD	05H
	DD	FLAT:??_R2DES@@8
rdata$r	ENDS
;	COMDAT ??_R2DES@@8
rdata$r	SEGMENT
??_R2DES@@8 DD	FLAT:??_R1A@?0A@EA@DES@@8		; DES::`RTTI Base Class Array'
	DD	FLAT:??_R1A@?0A@EA@Encryption@@8
	DD	FLAT:??_R1A@?0A@EA@AlgorithmIdentifier@@8
	DD	FLAT:??_R1A@?0A@EA@Sequence@@8
	DD	FLAT:??_R1A@?0A@EA@ASN1@@8
rdata$r	ENDS
;	COMDAT ??_R1A@?0A@EA@DES@@8
rdata$r	SEGMENT
??_R1A@?0A@EA@DES@@8 DD FLAT:??_R0?AVDES@@@8		; DES::`RTTI Base Class Descriptor at (0,-1,0,64)'
	DD	04H
	DD	00H
	DD	0ffffffffH
	DD	00H
	DD	040H
	DD	FLAT:??_R3DES@@8
rdata$r	ENDS
;	COMDAT ??_R0?AVDES@@@8
_DATA	SEGMENT
??_R0?AVDES@@@8 DD FLAT:??_7type_info@@6B@		; DES `RTTI Type Descriptor'
	DD	00H
	DB	'.?AVDES@@', 00H
_DATA	ENDS
;	COMDAT ?s@?1??f@DES@@QAEII_K@Z@4QAY0EA@$$CBEA
CONST	SEGMENT
?s@?1??f@DES@@QAEII_K@Z@4QAY0EA@$$CBEA DB 0eH		; `DES::f'::`2'::s
	DB	00H
	DB	04H
	DB	0fH
	DB	0dH
	DB	07H
	DB	01H
	DB	04H
	DB	02H
	DB	0eH
	DB	0fH
	DB	02H
	DB	0bH
	DB	0dH
	DB	08H
	DB	01H
	DB	03H
	DB	0aH
	DB	0aH
	DB	06H
	DB	06H
	DB	0cH
	DB	0cH
	DB	0bH
	DB	05H
	DB	09H
	DB	09H
	DB	05H
	DB	00H
	DB	03H
	DB	07H
	DB	08H
	DB	04H
	DB	0fH
	DB	01H
	DB	0cH
	DB	0eH
	DB	08H
	DB	08H
	DB	02H
	DB	0dH
	DB	04H
	DB	06H
	DB	09H
	DB	02H
	DB	01H
	DB	0bH
	DB	07H
	DB	0fH
	DB	05H
	DB	0cH
	DB	0bH
	DB	09H
	DB	03H
	DB	07H
	DB	0eH
	DB	03H
	DB	0aH
	DB	0aH
	DB	00H
	DB	05H
	DB	06H
	DB	00H
	DB	0dH
	DB	0fH
	DB	03H
	DB	01H
	DB	0dH
	DB	08H
	DB	04H
	DB	0eH
	DB	07H
	DB	06H
	DB	0fH
	DB	0bH
	DB	02H
	DB	03H
	DB	08H
	DB	04H
	DB	0eH
	DB	09H
	DB	0cH
	DB	07H
	DB	00H
	DB	02H
	DB	01H
	DB	0dH
	DB	0aH
	DB	0cH
	DB	06H
	DB	00H
	DB	09H
	DB	05H
	DB	0bH
	DB	0aH
	DB	05H
	DB	00H
	DB	0dH
	DB	0eH
	DB	08H
	DB	07H
	DB	0aH
	DB	0bH
	DB	01H
	DB	0aH
	DB	03H
	DB	04H
	DB	0fH
	DB	0dH
	DB	04H
	DB	01H
	DB	02H
	DB	05H
	DB	0bH
	DB	08H
	DB	06H
	DB	0cH
	DB	07H
	DB	06H
	DB	0cH
	DB	09H
	DB	00H
	DB	03H
	DB	05H
	DB	02H
	DB	0eH
	DB	0fH
	DB	09H
	DB	0aH
	DB	0dH
	DB	00H
	DB	07H
	DB	09H
	DB	00H
	DB	0eH
	DB	09H
	DB	06H
	DB	03H
	DB	03H
	DB	04H
	DB	0fH
	DB	06H
	DB	05H
	DB	0aH
	DB	01H
	DB	02H
	DB	0dH
	DB	08H
	DB	0cH
	DB	05H
	DB	07H
	DB	0eH
	DB	0bH
	DB	0cH
	DB	04H
	DB	0bH
	DB	02H
	DB	0fH
	DB	08H
	DB	01H
	DB	0dH
	DB	01H
	DB	06H
	DB	0aH
	DB	04H
	DB	0dH
	DB	09H
	DB	00H
	DB	08H
	DB	06H
	DB	0fH
	DB	09H
	DB	03H
	DB	08H
	DB	00H
	DB	07H
	DB	0bH
	DB	04H
	DB	01H
	DB	0fH
	DB	02H
	DB	0eH
	DB	0cH
	DB	03H
	DB	05H
	DB	0bH
	DB	0aH
	DB	05H
	DB	0eH
	DB	02H
	DB	07H
	DB	0cH
	DB	07H
	DB	0dH
	DB	0dH
	DB	08H
	DB	0eH
	DB	0bH
	DB	03H
	DB	05H
	DB	00H
	DB	06H
	DB	06H
	DB	0fH
	DB	09H
	DB	00H
	DB	0aH
	DB	03H
	DB	01H
	DB	04H
	DB	02H
	DB	07H
	DB	08H
	DB	02H
	DB	05H
	DB	0cH
	DB	0bH
	DB	01H
	DB	0cH
	DB	0aH
	DB	04H
	DB	0eH
	DB	0fH
	DB	09H
	DB	0aH
	DB	03H
	DB	06H
	DB	0fH
	DB	09H
	DB	00H
	DB	00H
	DB	06H
	DB	0cH
	DB	0aH
	DB	0bH
	DB	01H
	DB	07H
	DB	0dH
	DB	0dH
	DB	08H
	DB	0fH
	DB	09H
	DB	01H
	DB	04H
	DB	03H
	DB	05H
	DB	0eH
	DB	0bH
	DB	05H
	DB	0cH
	DB	02H
	DB	07H
	DB	08H
	DB	02H
	DB	04H
	DB	0eH
	DB	02H
	DB	0eH
	DB	0cH
	DB	0bH
	DB	04H
	DB	02H
	DB	01H
	DB	0cH
	DB	07H
	DB	04H
	DB	0aH
	DB	07H
	DB	0bH
	DB	0dH
	DB	06H
	DB	01H
	DB	08H
	DB	05H
	DB	05H
	DB	00H
	DB	03H
	DB	0fH
	DB	0fH
	DB	0aH
	DB	0dH
	DB	03H
	DB	00H
	DB	09H
	DB	0eH
	DB	08H
	DB	09H
	DB	06H
	DB	04H
	DB	0bH
	DB	02H
	DB	08H
	DB	01H
	DB	0cH
	DB	0bH
	DB	07H
	DB	0aH
	DB	01H
	DB	0dH
	DB	0eH
	DB	07H
	DB	02H
	DB	08H
	DB	0dH
	DB	0fH
	DB	06H
	DB	09H
	DB	0fH
	DB	0cH
	DB	00H
	DB	05H
	DB	09H
	DB	06H
	DB	0aH
	DB	03H
	DB	04H
	DB	00H
	DB	05H
	DB	0eH
	DB	03H
	DB	0cH
	DB	0aH
	DB	01H
	DB	0fH
	DB	0aH
	DB	04H
	DB	0fH
	DB	02H
	DB	09H
	DB	07H
	DB	02H
	DB	0cH
	DB	06H
	DB	09H
	DB	08H
	DB	05H
	DB	00H
	DB	06H
	DB	0dH
	DB	01H
	DB	03H
	DB	0dH
	DB	04H
	DB	0eH
	DB	0eH
	DB	00H
	DB	07H
	DB	0bH
	DB	05H
	DB	03H
	DB	0bH
	DB	08H
	DB	09H
	DB	04H
	DB	0eH
	DB	03H
	DB	0fH
	DB	02H
	DB	05H
	DB	0cH
	DB	02H
	DB	09H
	DB	08H
	DB	05H
	DB	0cH
	DB	0fH
	DB	03H
	DB	0aH
	DB	07H
	DB	0bH
	DB	00H
	DB	0eH
	DB	04H
	DB	01H
	DB	0aH
	DB	07H
	DB	01H
	DB	06H
	DB	0dH
	DB	00H
	DB	0bH
	DB	08H
	DB	06H
	DB	0dH
	DB	04H
	DB	0dH
	DB	0bH
	DB	00H
	DB	02H
	DB	0bH
	DB	0eH
	DB	07H
	DB	0fH
	DB	04H
	DB	00H
	DB	09H
	DB	08H
	DB	01H
	DB	0dH
	DB	0aH
	DB	03H
	DB	0eH
	DB	0cH
	DB	03H
	DB	09H
	DB	05H
	DB	07H
	DB	0cH
	DB	05H
	DB	02H
	DB	0aH
	DB	0fH
	DB	06H
	DB	08H
	DB	01H
	DB	06H
	DB	01H
	DB	06H
	DB	04H
	DB	0bH
	DB	0bH
	DB	0dH
	DB	0dH
	DB	08H
	DB	0cH
	DB	01H
	DB	03H
	DB	04H
	DB	07H
	DB	0aH
	DB	0eH
	DB	07H
	DB	0aH
	DB	09H
	DB	0fH
	DB	05H
	DB	06H
	DB	00H
	DB	08H
	DB	0fH
	DB	00H
	DB	0eH
	DB	05H
	DB	02H
	DB	09H
	DB	03H
	DB	02H
	DB	0cH
	DB	0dH
	DB	01H
	DB	02H
	DB	0fH
	DB	08H
	DB	0dH
	DB	04H
	DB	08H
	DB	06H
	DB	0aH
	DB	0fH
	DB	03H
	DB	0bH
	DB	07H
	DB	01H
	DB	04H
	DB	0aH
	DB	0cH
	DB	09H
	DB	05H
	DB	03H
	DB	06H
	DB	0eH
	DB	0bH
	DB	05H
	DB	00H
	DB	00H
	DB	0eH
	DB	0cH
	DB	09H
	DB	07H
	DB	02H
	DB	07H
	DB	02H
	DB	0bH
	DB	01H
	DB	04H
	DB	0eH
	DB	01H
	DB	07H
	DB	09H
	DB	04H
	DB	0cH
	DB	0aH
	DB	0eH
	DB	08H
	DB	02H
	DB	0dH
	DB	00H
	DB	0fH
	DB	06H
	DB	0cH
	DB	0aH
	DB	09H
	DB	0dH
	DB	00H
	DB	0fH
	DB	03H
	DB	03H
	DB	05H
	DB	05H
	DB	06H
	DB	08H
	DB	0bH
CONST	ENDS
;	COMDAT ?p@?1??P@DES@@QAEII@Z@4QBEB
CONST	SEGMENT
?p@?1??P@DES@@QAEII@Z@4QBEB DB 010H			; `DES::P'::`2'::p
	DB	019H
	DB	0cH
	DB	0bH
	DB	03H
	DB	014H
	DB	04H
	DB	0fH
	DB	01fH
	DB	011H
	DB	09H
	DB	06H
	DB	01bH
	DB	0eH
	DB	01H
	DB	016H
	DB	01eH
	DB	018H
	DB	08H
	DB	012H
	DB	00H
	DB	05H
	DB	01dH
	DB	017H
	DB	0dH
	DB	013H
	DB	02H
	DB	01aH
	DB	0aH
	DB	015H
	DB	01cH
	DB	07H
CONST	ENDS
;	COMDAT ?pc2@?1??KeyExpansion@DES@@QAEXPAXQA_K@Z@4QBEB
CONST	SEGMENT
?pc2@?1??KeyExpansion@DES@@QAEXPAXQA_K@Z@4QBEB DB 02aH	; `DES::KeyExpansion'::`2'::pc2
	DB	027H
	DB	02dH
	DB	020H
	DB	037H
	DB	033H
	DB	035H
	DB	01cH
	DB	029H
	DB	032H
	DB	023H
	DB	02eH
	DB	021H
	DB	025H
	DB	02cH
	DB	034H
	DB	01eH
	DB	030H
	DB	028H
	DB	031H
	DB	01dH
	DB	024H
	DB	02bH
	DB	036H
	DB	0fH
	DB	04H
	DB	019H
	DB	013H
	DB	09H
	DB	01H
	DB	01aH
	DB	010H
	DB	05H
	DB	0bH
	DB	017H
	DB	08H
	DB	0cH
	DB	07H
	DB	011H
	DB	00H
	DB	016H
	DB	03H
	DB	0aH
	DB	0eH
	DB	06H
	DB	014H
	DB	01bH
	DB	018H
CONST	ENDS
;	COMDAT ?pc1@?1??KeyExpansion@DES@@QAEXPAXQA_K@Z@4QBEB
CONST	SEGMENT
?pc1@?1??KeyExpansion@DES@@QAEXPAXQA_K@Z@4QBEB DB 03fH	; `DES::KeyExpansion'::`2'::pc1
	DB	037H
	DB	02fH
	DB	027H
	DB	01fH
	DB	017H
	DB	0fH
	DB	07H
	DB	03eH
	DB	036H
	DB	02eH
	DB	026H
	DB	01eH
	DB	016H
	DB	0eH
	DB	06H
	DB	03dH
	DB	035H
	DB	02dH
	DB	025H
	DB	01dH
	DB	015H
	DB	0dH
	DB	05H
	DB	03cH
	DB	034H
	DB	02cH
	DB	024H
	DB	039H
	DB	031H
	DB	029H
	DB	021H
	DB	019H
	DB	011H
	DB	09H
	DB	01H
	DB	03aH
	DB	032H
	DB	02aH
	DB	022H
	DB	01aH
	DB	012H
	DB	0aH
	DB	02H
	DB	03bH
	DB	033H
	DB	02bH
	DB	023H
	DB	01bH
	DB	013H
	DB	0bH
	DB	03H
	DB	01cH
	DB	014H
	DB	0cH
	DB	04H
CONST	ENDS
;	COMDAT ?nshift@?1??KeyExpansion@DES@@QAEXPAXQA_K@Z@4QBEB
CONST	SEGMENT
?nshift@?1??KeyExpansion@DES@@QAEXPAXQA_K@Z@4QBEB DB 01H ; `DES::KeyExpansion'::`2'::nshift
	DB	01H
	DB	02H
	DB	02H
	DB	02H
	DB	02H
	DB	02H
	DB	02H
	DB	01H
	DB	02H
	DB	02H
	DB	02H
	DB	02H
	DB	02H
	DB	02H
	DB	01H
PUBLIC	?P@DES@@QAEII@Z					; DES::P
; Function compile flags: /Ogtpy
; File i:\“n•”“ÄŽj\my project\cms\cms\asn1\algorithm\des.cpp
;	COMDAT ?P@DES@@QAEII@Z
_TEXT	SEGMENT
?P@DES@@QAEII@Z PROC					; DES::P, COMDAT
; _iData$ = esi

; 310  : 	static	const	unsigned	char	p[32]={
; 311  : 		16,25,12,11,
; 312  : 		 3,20, 4,15,
; 313  : 		31,17, 9, 6,
; 314  : 		27,14, 1,22,
; 315  : 		30,24, 8,18,
; 316  : 		 0, 5,29,23,
; 317  : 		13,19, 2,26,
; 318  : 		10,21,28, 7};
; 319  : 
; 320  : 	unsigned	int	result = 0;

  00000	33 c0		 xor	 eax, eax

; 321  : 	unsigned	int	i = 0;

  00002	33 d2		 xor	 edx, edx
  00004	57		 push	 edi
$LL2@P:

; 322  : 
; 323  : 	while(i < 32){	//56
; 324  : 		result <<= 1;
; 325  : 		result |= (iData >> p[i]) & 0x01;

  00005	0f b6 8a 00 00
	00 00		 movzx	 ecx, BYTE PTR ?p@?1??P@DES@@QAEII@Z@4QBEB[edx]
  0000c	03 c0		 add	 eax, eax
  0000e	8b fe		 mov	 edi, esi
  00010	d3 ef		 shr	 edi, cl
  00012	0f b6 8a 01 00
	00 00		 movzx	 ecx, BYTE PTR ?p@?1??P@DES@@QAEII@Z@4QBEB[edx+1]
  00019	83 e7 01	 and	 edi, 1
  0001c	0b f8		 or	 edi, eax
  0001e	8b c6		 mov	 eax, esi
  00020	d3 e8		 shr	 eax, cl
  00022	0f b6 8a 02 00
	00 00		 movzx	 ecx, BYTE PTR ?p@?1??P@DES@@QAEII@Z@4QBEB[edx+2]
  00029	83 e0 01	 and	 eax, 1
  0002c	03 ff		 add	 edi, edi
  0002e	0b f8		 or	 edi, eax
  00030	8b c6		 mov	 eax, esi
  00032	d3 e8		 shr	 eax, cl
  00034	0f b6 8a 03 00
	00 00		 movzx	 ecx, BYTE PTR ?p@?1??P@DES@@QAEII@Z@4QBEB[edx+3]
  0003b	83 e0 01	 and	 eax, 1
  0003e	03 ff		 add	 edi, edi
  00040	0b f8		 or	 edi, eax
  00042	8b c6		 mov	 eax, esi
  00044	d3 e8		 shr	 eax, cl
  00046	03 ff		 add	 edi, edi
  00048	83 c2 04	 add	 edx, 4
  0004b	83 e0 01	 and	 eax, 1
  0004e	0b c7		 or	 eax, edi
  00050	83 fa 20	 cmp	 edx, 32			; 00000020H
  00053	72 b0		 jb	 SHORT $LL2@P
  00055	5f		 pop	 edi

; 326  : 		i++;
; 327  : 	}
; 328  : 
; 329  : 	return(result);
; 330  : }

  00056	c3		 ret	 0
?P@DES@@QAEII@Z ENDP					; DES::P
_TEXT	ENDS
PUBLIC	?E@DES@@QAE_KI@Z				; DES::E
; Function compile flags: /Ogtpy
;	COMDAT ?E@DES@@QAE_KI@Z
_TEXT	SEGMENT
?E@DES@@QAE_KI@Z PROC					; DES::E, COMDAT
; _iData$ = ecx

; 281  : 	unsigned	__int64	result;
; 282  : 	unsigned	char	a,b,c,d,e,f,g,h;
; 283  : 
; 284  : 	a =	((iData<< 1) & 0x3E) | (iData>>31);
; 285  : 	b = ((iData>> 3) & 0x3F);
; 286  : 	c = ((iData>> 7) & 0x3F);
; 287  : 	d = ((iData>>11) & 0x3F);

  00000	8b c1		 mov	 eax, ecx
  00002	c1 e8 0b	 shr	 eax, 11			; 0000000bH

; 288  : 	e = ((iData>>15) & 0x3F);
; 289  : 	f = ((iData>>19) & 0x3F);
; 290  : 	g = ((iData>>23) & 0x3F);
; 291  : 	h = ((iData>>27) & 0x1F) | ((iData & 1)<<5);
; 292  : 
; 293  : 	//Œ®‚àŠÜ‚ßA6bit‚Ì‚Ü‚Æ‚Ü‚è‚ðA8bit–ˆ‚É‚µ‚Ä‚¨‚¢‚½•û‚ªAˆ—‚ª‘‚¢B
; 294  : 	result	  =	(h<<24) | (g<<16) | (f<<8) | (e);
; 295  : 	result	<<=	32;
; 296  : 	result	 |=	(d<<24) | (c<<16) | (b<<8) | (a);
; 297  : 
; 298  : 	return(result);

  00005	83 e0 3f	 and	 eax, 63			; 0000003fH
  00008	c1 e0 08	 shl	 eax, 8
  0000b	8b d1		 mov	 edx, ecx
  0000d	c1 ea 07	 shr	 edx, 7
  00010	83 e2 3f	 and	 edx, 63			; 0000003fH
  00013	0b c2		 or	 eax, edx
  00015	c1 e0 08	 shl	 eax, 8
  00018	8b d1		 mov	 edx, ecx
  0001a	c1 ea 03	 shr	 edx, 3
  0001d	83 e2 3f	 and	 edx, 63			; 0000003fH
  00020	0b c2		 or	 eax, edx
  00022	8a d1		 mov	 dl, cl
  00024	80 e2 1f	 and	 dl, 31			; 0000001fH
  00027	02 d2		 add	 dl, dl
  00029	0f b6 d2	 movzx	 edx, dl
  0002c	c1 e0 08	 shl	 eax, 8
  0002f	56		 push	 esi
  00030	8b f1		 mov	 esi, ecx
  00032	c1 ee 1f	 shr	 esi, 31			; 0000001fH
  00035	0b d6		 or	 edx, esi
  00037	0b c2		 or	 eax, edx
  00039	99		 cdq
  0003a	8b f0		 mov	 esi, eax
  0003c	57		 push	 edi
  0003d	8b fa		 mov	 edi, edx
  0003f	8a d1		 mov	 dl, cl
  00041	80 e2 01	 and	 dl, 1
  00044	c0 e2 05	 shl	 dl, 5
  00047	0f b6 d2	 movzx	 edx, dl
  0004a	8b c1		 mov	 eax, ecx
  0004c	c1 e8 1b	 shr	 eax, 27			; 0000001bH
  0004f	83 e0 1f	 and	 eax, 31			; 0000001fH
  00052	0b c2		 or	 eax, edx
  00054	8b d1		 mov	 edx, ecx
  00056	c1 ea 17	 shr	 edx, 23			; 00000017H
  00059	c1 e0 08	 shl	 eax, 8
  0005c	83 e2 3f	 and	 edx, 63			; 0000003fH
  0005f	0b c2		 or	 eax, edx
  00061	8b d1		 mov	 edx, ecx
  00063	c1 e0 08	 shl	 eax, 8
  00066	c1 ea 13	 shr	 edx, 19			; 00000013H
  00069	83 e2 3f	 and	 edx, 63			; 0000003fH
  0006c	0b c2		 or	 eax, edx
  0006e	c1 e9 0f	 shr	 ecx, 15			; 0000000fH
  00071	c1 e0 08	 shl	 eax, 8
  00074	83 e1 3f	 and	 ecx, 63			; 0000003fH
  00077	0b c1		 or	 eax, ecx
  00079	99		 cdq
  0007a	0b f8		 or	 edi, eax
  0007c	33 c9		 xor	 ecx, ecx
  0007e	0b f1		 or	 esi, ecx
  00080	8b d7		 mov	 edx, edi

; 299  : }

  00082	5f		 pop	 edi
  00083	8b c6		 mov	 eax, esi
  00085	5e		 pop	 esi
  00086	c3		 ret	 0
?E@DES@@QAE_KI@Z ENDP					; DES::E
_TEXT	ENDS
PUBLIC	?invIP@DES@@QAE_K_K@Z				; DES::invIP
; Function compile flags: /Ogtpy
;	COMDAT ?invIP@DES@@QAE_K_K@Z
_TEXT	SEGMENT
_temp$ = 8						; size = 8
_data$ = 8						; size = 8
?invIP@DES@@QAE_K_K@Z PROC				; DES::invIP, COMDAT

; 220  : 	unsigned	__int64	temp;
; 221  : 
; 222  : 	unsigned	__int64	temp0;
; 223  : 	unsigned	__int64	temp1;
; 224  : 	unsigned	__int64	temp2;
; 225  : 	unsigned	__int64	temp3;
; 226  : 	unsigned	__int64	temp4;
; 227  : 	unsigned	__int64	temp5;
; 228  : 	unsigned	__int64	temp6;
; 229  : 	unsigned	__int64	temp7;
; 230  : 
; 231  : 	const	unsigned	__int64	iMask =	0x8040201008040201;
; 232  : 
; 233  : 	//Byte’PˆÊ‚Ì“ü‚ê‘Ö‚¦iL,R‚Ì”½“]‚àŠÜ‚Þj
; 234  : 	temp  = ( data      & 0xFF);	//ÅãˆÊ
; 235  : 	temp |= ((data>> 8) & 0xFF) << 16;
; 236  : 	temp |= ((data>>16) & 0xFF) << 32;
; 237  : 	temp |= ((data>>24) & 0xFF) << 48;
; 238  : 
; 239  : 	temp |= ((data>>32) & 0xFF) <<  8;
; 240  : 	temp |= ((data>>40) & 0xFF) << 24;
; 241  : 	temp |= ((data>>48) & 0xFF) << 40;
; 242  : 	temp |= ((data>>56) & 0xFF) << 56;

  00000	8b 44 24 04	 mov	 eax, DWORD PTR _data$[esp-4]
  00004	8b 4c 24 08	 mov	 ecx, DWORD PTR _data$[esp]
  00008	8b d0		 mov	 edx, eax
  0000a	53		 push	 ebx
  0000b	55		 push	 ebp
  0000c	56		 push	 esi
  0000d	57		 push	 edi
  0000e	33 ff		 xor	 edi, edi
  00010	8b f1		 mov	 esi, ecx
  00012	0f ac f2 08	 shrd	 edx, esi, 8
  00016	81 e2 00 00 00
	ff		 and	 edx, -16777216		; ff000000H
  0001c	0b d7		 or	 edx, edi
  0001e	33 f6		 xor	 esi, esi
  00020	8b d9		 mov	 ebx, ecx
  00022	81 e3 00 ff 00
	00		 and	 ebx, 65280		; 0000ff00H
  00028	0b f3		 or	 esi, ebx
  0002a	0f ac f2 08	 shrd	 edx, esi, 8
  0002e	0b d7		 or	 edx, edi
  00030	8b d8		 mov	 ebx, eax
  00032	c1 ee 08	 shr	 esi, 8
  00035	81 e1 00 00 ff
	00		 and	 ecx, 16711680		; 00ff0000H
  0003b	0b f1		 or	 esi, ecx
  0003d	8b ca		 mov	 ecx, edx
  0003f	8b d0		 mov	 edx, eax
  00041	81 e2 00 00 00
	ff		 and	 edx, -16777216		; ff000000H
  00047	0f a4 d7 08	 shld	 edi, edx, 8
  0004b	c1 e2 08	 shl	 edx, 8
  0004e	25 00 ff 00 00	 and	 eax, 65280		; 0000ff00H
  00053	81 e3 00 00 ff
	00		 and	 ebx, 16711680		; 00ff0000H
  00059	0b d3		 or	 edx, ebx
  0005b	33 ed		 xor	 ebp, ebp
  0005d	0b fd		 or	 edi, ebp
  0005f	0f a4 d7 08	 shld	 edi, edx, 8
  00063	c1 e2 08	 shl	 edx, 8
  00066	0b d0		 or	 edx, eax
  00068	8b 44 24 18	 mov	 eax, DWORD PTR _data$[esp+16]
  0006c	33 db		 xor	 ebx, ebx
  0006e	0b fb		 or	 edi, ebx
  00070	0f a4 d7 08	 shld	 edi, edx, 8
  00074	c1 e2 08	 shl	 edx, 8
  00077	25 00 00 00 ff	 and	 eax, -16777216		; ff000000H
  0007c	0f ac f1 08	 shrd	 ecx, esi, 8
  00080	0b ca		 or	 ecx, edx
  00082	0f b6 54 24 14	 movzx	 edx, BYTE PTR _data$[esp+12]
  00087	0b ca		 or	 ecx, edx
  00089	c1 ee 08	 shr	 esi, 8
  0008c	0b f7		 or	 esi, edi
  0008e	0b f0		 or	 esi, eax

; 243  : 
; 244  : 	//Bit’PˆÊ‚Ì“ü‚ê‘Ö‚¦
; 245  : 	temp0  = ( temp				) & iMask;
; 246  : 
; 247  : 	temp1  = ((temp >>      8	) & iMask) << 1;
; 248  : 	temp1 |= ((temp << (64- 8)	) & iMask) >> 7;
; 249  : 
; 250  : 	temp2  = ((temp >>     16	) & iMask) << 2;
; 251  : 	temp2 |= ((temp << (64-16)	) & iMask) >> 6;
; 252  : 
; 253  : 	temp3  = ((temp >>     24	) & iMask) << 3;
; 254  : 	temp3 |= ((temp << (64-24)	) & iMask) >> 5;
; 255  : 
; 256  : 	temp4  = ((temp >>     32	) & iMask) << 4;
; 257  : 	temp4 |= ((temp << (64-32)	) & iMask) >> 4;
; 258  : 
; 259  : 	temp5  = ((temp >>     40	) & iMask) << 5;
; 260  : 	temp5 |= ((temp << (64-40)	) & iMask) >> 3;
; 261  : 
; 262  : 	temp6  = ((temp >>     48	) & iMask) << 6;
; 263  : 	temp6 |= ((temp << (64-48)	) & iMask) >> 2;
; 264  : 
; 265  : 	temp7  = ((temp >>     56	) & iMask) << 7;
; 266  : 	temp7 |= ((temp << (64-56)	) & iMask) >> 1;
; 267  : 
; 268  : 	return(temp0 | temp1 | temp2 | temp3 | temp4 | temp5 | temp6 | temp7);

  00090	33 d2		 xor	 edx, edx
  00092	8b c1		 mov	 eax, ecx
  00094	25 80 00 00 00	 and	 eax, 128		; 00000080H
  00099	0f a4 c2 07	 shld	 edx, eax, 7
  0009d	c1 e0 07	 shl	 eax, 7
  000a0	0b d3		 or	 edx, ebx
  000a2	8b f9		 mov	 edi, ecx
  000a4	81 e7 40 80 00
	00		 and	 edi, 32832		; 00008040H
  000aa	0b c7		 or	 eax, edi
  000ac	0f a4 c2 07	 shld	 edx, eax, 7
  000b0	c1 e0 07	 shl	 eax, 7
  000b3	0b d3		 or	 edx, ebx
  000b5	8b f9		 mov	 edi, ecx
  000b7	81 e7 20 40 80
	00		 and	 edi, 8405024		; 00804020H
  000bd	0b c7		 or	 eax, edi
  000bf	0f a4 c2 07	 shld	 edx, eax, 7
  000c3	c1 e0 07	 shl	 eax, 7
  000c6	0b d3		 or	 edx, ebx
  000c8	8b f9		 mov	 edi, ecx
  000ca	81 e7 10 20 40
	80		 and	 edi, -2143281136	; 80402010H
  000d0	0b c7		 or	 eax, edi
  000d2	0f a4 c2 07	 shld	 edx, eax, 7
  000d6	c1 e0 07	 shl	 eax, 7
  000d9	8b f9		 mov	 edi, ecx
  000db	81 e7 08 10 20
	40		 and	 edi, 1075843080		; 40201008H
  000e1	8b de		 mov	 ebx, esi
  000e3	81 e3 80 00 00
	00		 and	 ebx, 128		; 00000080H
  000e9	0b c7		 or	 eax, edi
  000eb	0b d3		 or	 edx, ebx
  000ed	0f a4 c2 07	 shld	 edx, eax, 7
  000f1	89 74 24 18	 mov	 DWORD PTR _temp$[esp+16], esi
  000f5	c1 e0 07	 shl	 eax, 7
  000f8	8b f9		 mov	 edi, ecx
  000fa	81 e7 04 08 10
	20		 and	 edi, 537921540		; 20100804H
  00100	0b c7		 or	 eax, edi
  00102	8b de		 mov	 ebx, esi
  00104	81 e3 40 80 00
	00		 and	 ebx, 32832		; 00008040H
  0010a	0b d3		 or	 edx, ebx
  0010c	0f a4 c2 07	 shld	 edx, eax, 7
  00110	8b de		 mov	 ebx, esi
  00112	81 e3 20 40 80
	00		 and	 ebx, 8405024		; 00804020H
  00118	0b d3		 or	 edx, ebx
  0011a	8b de		 mov	 ebx, esi
  0011c	c1 e0 07	 shl	 eax, 7
  0011f	8b f9		 mov	 edi, ecx
  00121	81 e7 02 04 08
	10		 and	 edi, 268960770		; 10080402H
  00127	0b c7		 or	 eax, edi
  00129	8b f9		 mov	 edi, ecx
  0012b	0f ac df 07	 shrd	 edi, ebx, 7
  0012f	c1 eb 07	 shr	 ebx, 7
  00132	81 e3 00 00 02
	00		 and	 ebx, 131072		; 00020000H
  00138	33 ff		 xor	 edi, edi
  0013a	0b fd		 or	 edi, ebp
  0013c	8b 6c 24 18	 mov	 ebp, DWORD PTR _temp$[esp+16]
  00140	81 e6 00 00 01
	02		 and	 esi, 33619968		; 02010000H
  00146	0b de		 or	 ebx, esi
  00148	0f ac df 07	 shrd	 edi, ebx, 7
  0014c	c1 eb 07	 shr	 ebx, 7
  0014f	33 f6		 xor	 esi, esi
  00151	0b fe		 or	 edi, esi
  00153	81 e5 00 01 02
	04		 and	 ebp, 67240192		; 04020100H
  00159	0b dd		 or	 ebx, ebp
  0015b	8b 6c 24 18	 mov	 ebp, DWORD PTR _temp$[esp+16]
  0015f	0f ac df 07	 shrd	 edi, ebx, 7
  00163	0b fe		 or	 edi, esi
  00165	c1 eb 07	 shr	 ebx, 7
  00168	81 e5 01 02 04
	08		 and	 ebp, 134480385		; 08040201H
  0016e	0b dd		 or	 ebx, ebp
  00170	8b 6c 24 18	 mov	 ebp, DWORD PTR _temp$[esp+16]
  00174	0f ac df 07	 shrd	 edi, ebx, 7
  00178	c1 eb 07	 shr	 ebx, 7
  0017b	81 e5 02 04 08
	10		 and	 ebp, 268960770		; 10080402H
  00181	0b dd		 or	 ebx, ebp
  00183	8b 6c 24 18	 mov	 ebp, DWORD PTR _temp$[esp+16]
  00187	8b f1		 mov	 esi, ecx
  00189	81 e6 00 00 00
	01		 and	 esi, 16777216		; 01000000H
  0018f	0b fe		 or	 edi, esi
  00191	0f ac df 07	 shrd	 edi, ebx, 7
  00195	c1 eb 07	 shr	 ebx, 7
  00198	8b f1		 mov	 esi, ecx
  0019a	81 e6 00 00 01
	02		 and	 esi, 33619968		; 02010000H
  001a0	0b fe		 or	 edi, esi
  001a2	81 e5 04 08 10
	20		 and	 ebp, 537921540		; 20100804H
  001a8	0b dd		 or	 ebx, ebp
  001aa	8b 6c 24 18	 mov	 ebp, DWORD PTR _temp$[esp+16]
  001ae	0f ac df 07	 shrd	 edi, ebx, 7
  001b2	c1 eb 07	 shr	 ebx, 7
  001b5	8b f1		 mov	 esi, ecx
  001b7	81 e6 00 01 02
	04		 and	 esi, 67240192		; 04020100H
  001bd	0b fe		 or	 edi, esi
  001bf	8b 74 24 18	 mov	 esi, DWORD PTR _temp$[esp+16]
  001c3	81 e5 08 10 20
	40		 and	 ebp, 1075843080		; 40201008H
  001c9	0b dd		 or	 ebx, ebp
  001cb	0f a4 c2 07	 shld	 edx, eax, 7
  001cf	0f ac df 07	 shrd	 edi, ebx, 7
  001d3	c1 e0 07	 shl	 eax, 7
  001d6	c1 eb 07	 shr	 ebx, 7
  001d9	0b c7		 or	 eax, edi
  001db	0b d3		 or	 edx, ebx
  001dd	81 e6 10 20 40
	80		 and	 esi, -2143281136	; 80402010H

; 269  : 
; 270  : }

  001e3	5f		 pop	 edi
  001e4	0b d6		 or	 edx, esi
  001e6	5e		 pop	 esi
  001e7	81 e1 01 02 04
	08		 and	 ecx, 134480385		; 08040201H
  001ed	5d		 pop	 ebp
  001ee	0b c1		 or	 eax, ecx
  001f0	5b		 pop	 ebx
  001f1	c2 08 00	 ret	 8
?invIP@DES@@QAE_K_K@Z ENDP				; DES::invIP
_TEXT	ENDS
PUBLIC	?IP@DES@@QAE_K_K@Z				; DES::IP
; Function compile flags: /Ogtpy
;	COMDAT ?IP@DES@@QAE_K_K@Z
_TEXT	SEGMENT
_l$ = 8							; size = 4
_r$ = 8							; size = 4
_data$ = 8						; size = 8
?IP@DES@@QAE_K_K@Z PROC					; DES::IP, COMDAT

; 131  : 
; 132  : 	unsigned	__int64	temp;
; 133  : 
; 134  : 	unsigned	int	l, r;
; 135  : 
; 136  : 	unsigned	int	temp_l,temp_r;
; 137  : 
; 138  : 	const	unsigned	int	iMaskL =	0x40100401;
; 139  : 	const	unsigned	int	iMaskR =	0x80200802;
; 140  : 
; 141  : 	//Byte’PˆÊ‚Ì“ü‚ê‘Ö‚¦
; 142  : 	temp  = ( data      & 0xFF) << 32;	//ÅãˆÊ
; 143  : 	temp |= ((data>> 8) & 0xFF);
; 144  : 	temp |= ((data>>16) & 0xFF) << 40;
; 145  : 	temp |= ((data>>24) & 0xFF) <<  8;
; 146  : 	temp |= ((data>>32) & 0xFF) << 48;
; 147  : 	temp |= ((data>>40) & 0xFF) << 16;
; 148  : 	temp |= ((data>>48) & 0xFF) << 56;
; 149  : 	temp |= ((data>>56) & 0xFF) << 24;

  00000	8b 54 24 04	 mov	 edx, DWORD PTR _data$[esp-4]
  00004	53		 push	 ebx
  00005	55		 push	 ebp
  00006	56		 push	 esi
  00007	8b 74 24 14	 mov	 esi, DWORD PTR _data$[esp+12]
  0000b	57		 push	 edi
  0000c	33 ff		 xor	 edi, edi
  0000e	8b c2		 mov	 eax, edx
  00010	8b ce		 mov	 ecx, esi
  00012	0f ac c8 08	 shrd	 eax, ecx, 8
  00016	c1 e9 08	 shr	 ecx, 8
  00019	81 e1 00 00 ff
	00		 and	 ecx, 16711680		; 00ff0000H
  0001f	33 c0		 xor	 eax, eax
  00021	0b c7		 or	 eax, edi
  00023	8b de		 mov	 ebx, esi
  00025	81 e3 00 ff 00
	00		 and	 ebx, 65280		; 0000ff00H
  0002b	0b cb		 or	 ecx, ebx
  0002d	0f ac c8 08	 shrd	 eax, ecx, 8
  00031	33 db		 xor	 ebx, ebx
  00033	8b fa		 mov	 edi, edx
  00035	81 e7 00 00 00
	ff		 and	 edi, -16777216		; ff000000H
  0003b	0b c7		 or	 eax, edi
  0003d	c1 e9 08	 shr	 ecx, 8
  00040	0b cb		 or	 ecx, ebx
  00042	0f ac c8 08	 shrd	 eax, ecx, 8
  00046	8b fa		 mov	 edi, edx
  00048	81 e7 00 ff 00
	00		 and	 edi, 65280		; 0000ff00H
  0004e	0b c7		 or	 eax, edi
  00050	c1 e9 08	 shr	 ecx, 8
  00053	0b cb		 or	 ecx, ebx
  00055	8b f9		 mov	 edi, ecx
  00057	0f ac f8 08	 shrd	 eax, edi, 8
  0005b	c1 ef 08	 shr	 edi, 8
  0005e	8b c8		 mov	 ecx, eax
  00060	8b c7		 mov	 eax, edi
  00062	0f b6 fa	 movzx	 edi, dl
  00065	0f a4 fb 08	 shld	 ebx, edi, 8
  00069	c1 e7 08	 shl	 edi, 8
  0006c	33 ed		 xor	 ebp, ebp
  0006e	0b dd		 or	 ebx, ebp
  00070	0f b6 6c 24 18	 movzx	 ebp, BYTE PTR _data$[esp+16]
  00075	81 e2 00 00 ff
	00		 and	 edx, 16711680		; 00ff0000H
  0007b	0b fa		 or	 edi, edx
  0007d	0f a4 fb 08	 shld	 ebx, edi, 8
  00081	c1 e7 08	 shl	 edi, 8
  00084	0b dd		 or	 ebx, ebp
  00086	33 d2		 xor	 edx, edx
  00088	0b fa		 or	 edi, edx
  0008a	0f a4 fb 08	 shld	 ebx, edi, 8
  0008e	c1 e7 08	 shl	 edi, 8
  00091	0b fa		 or	 edi, edx
  00093	81 e6 00 00 ff
	ff		 and	 esi, -65536		; ffff0000H
  00099	0b de		 or	 ebx, esi
  0009b	0f a4 fb 08	 shld	 ebx, edi, 8
  0009f	c1 e7 08	 shl	 edi, 8
  000a2	0b cf		 or	 ecx, edi
  000a4	0b c3		 or	 eax, ebx

; 150  : 
; 151  : 	//Bit’PˆÊ‚Ì“ü‚ê‘Ö‚¦
; 152  : 	r			 =  (unsigned int)(temp>>32);
; 153  : 	temp_l		 = (r & iMaskL);
; 154  : 	r			 =  (unsigned int)(temp & 0xFFFFFFFF);
; 155  : 	temp_r		 = (r & iMaskR);
; 156  : 
; 157  : 	temp_l		|= (r & iMaskL) << 1;

  000a6	8b f1		 mov	 esi, ecx
  000a8	81 e6 01 04 10
	c0		 and	 esi, -1072692223	; c0100401H
  000ae	8b f8		 mov	 edi, eax
  000b0	81 e7 01 04 10
	40		 and	 edi, 1074791425		; 40100401H
  000b6	03 f6		 add	 esi, esi
  000b8	0b f7		 or	 esi, edi

; 158  : 	r			 = ((unsigned int)(temp>>32) >>      8 );
; 159  : 	l			 = ((unsigned int)(temp>>32) << (32- 8));

  000ba	8b f8		 mov	 edi, eax
  000bc	c1 e7 18	 shl	 edi, 24			; 00000018H
  000bf	8b d8		 mov	 ebx, eax
  000c1	c1 eb 08	 shr	 ebx, 8
  000c4	89 5c 24 14	 mov	 DWORD PTR _r$[esp+12], ebx

; 160  : 	temp_r		|= (r & iMaskR) << 1;
; 161  : 	temp_r		|= (l & iMaskR) >> 7;

  000c8	8b ef		 mov	 ebp, edi
  000ca	c1 ed 07	 shr	 ebp, 7
  000cd	81 e3 02 08 20
	00		 and	 ebx, 2099202		; 00200802H
  000d3	03 db		 add	 ebx, ebx
  000d5	81 e5 10 40 00
	01		 and	 ebp, 16793616		; 01004010H
  000db	8b d1		 mov	 edx, ecx
  000dd	0b eb		 or	 ebp, ebx

; 162  : 
; 163  : 	temp_l		|= (r & iMaskL) << 2;
; 164  : 	temp_l		|= (l & iMaskL) >> 6;

  000df	8b 5c 24 14	 mov	 ebx, DWORD PTR _r$[esp+12]
  000e3	81 e2 02 08 20
	80		 and	 edx, -2145384446	; 80200802H
  000e9	c1 ef 06	 shr	 edi, 6
  000ec	0b d5		 or	 edx, ebp
  000ee	81 e7 10 40 00
	01		 and	 edi, 16793616		; 01004010H
  000f4	81 e3 01 04 10
	00		 and	 ebx, 1049601		; 00100401H
  000fa	03 db		 add	 ebx, ebx
  000fc	03 db		 add	 ebx, ebx
  000fe	0b fb		 or	 edi, ebx
  00100	0b f7		 or	 esi, edi

; 165  : 	r			 = ((unsigned int)(temp & 0xFFFFFFFF) >>      8 );

  00102	8b f9		 mov	 edi, ecx
  00104	c1 ef 08	 shr	 edi, 8

; 166  : 	l			 = ((unsigned int)(temp & 0xFFFFFFFF) << (32- 8));
; 167  : 	temp_r		|= (r & iMaskR) << 2;
; 168  : 	temp_r		|= (l & iMaskR) >> 6;

  00107	8b ef		 mov	 ebp, edi
  00109	81 e5 02 08 20
	00		 and	 ebp, 2099202		; 00200802H

; 169  : 
; 170  : 	temp_l		|= (r & iMaskL) << 3;
; 171  : 	temp_l		|= (l & iMaskL) >> 5;

  0010f	81 e7 01 04 10
	00		 and	 edi, 1049601		; 00100401H
  00115	03 ed		 add	 ebp, ebp
  00117	03 ff		 add	 edi, edi
  00119	03 ed		 add	 ebp, ebp
  0011b	03 ff		 add	 edi, edi
  0011d	8b d9		 mov	 ebx, ecx
  0011f	c1 e3 18	 shl	 ebx, 24			; 00000018H
  00122	89 5c 24 14	 mov	 DWORD PTR _l$[esp+12], ebx
  00126	c1 eb 06	 shr	 ebx, 6
  00129	81 e3 20 80 00
	02		 and	 ebx, 33587232		; 02008020H
  0012f	0b eb		 or	 ebp, ebx
  00131	8b 5c 24 14	 mov	 ebx, DWORD PTR _l$[esp+12]
  00135	c1 eb 05	 shr	 ebx, 5
  00138	81 e3 20 80 00
	02		 and	 ebx, 33587232		; 02008020H
  0013e	03 ff		 add	 edi, edi
  00140	0b fb		 or	 edi, ebx
  00142	0b f7		 or	 esi, edi
  00144	0b d5		 or	 edx, ebp

; 172  : 	r			 = ((unsigned int)(temp>>32) >>     16 );

  00146	8b d8		 mov	 ebx, eax
  00148	c1 eb 10	 shr	 ebx, 16			; 00000010H
  0014b	89 5c 24 14	 mov	 DWORD PTR _r$[esp+12], ebx

; 173  : 	l			 = ((unsigned int)(temp>>32) << (32-16));
; 174  : 	temp_r		|= (r & iMaskR) << 3;
; 175  : 	temp_r		|= (l & iMaskR) >> 5;

  0014f	81 e3 02 08 20
	00		 and	 ebx, 2099202		; 00200802H
  00155	03 db		 add	 ebx, ebx
  00157	03 db		 add	 ebx, ebx
  00159	03 db		 add	 ebx, ebx
  0015b	8b f8		 mov	 edi, eax
  0015d	c1 e7 10	 shl	 edi, 16			; 00000010H
  00160	8b ef		 mov	 ebp, edi
  00162	c1 ed 05	 shr	 ebp, 5
  00165	81 e5 40 00 01
	04		 and	 ebp, 67174464		; 04010040H
  0016b	0b dd		 or	 ebx, ebp
  0016d	0b d3		 or	 edx, ebx

; 176  : 
; 177  : 	temp_l		|= (r & iMaskL) << 4;
; 178  : 	temp_l		|= (l & iMaskL) >> 4;

  0016f	8b 5c 24 14	 mov	 ebx, DWORD PTR _r$[esp+12]
  00173	81 e3 01 04 10
	00		 and	 ebx, 1049601		; 00100401H
  00179	c1 e3 04	 shl	 ebx, 4
  0017c	c1 ef 04	 shr	 edi, 4
  0017f	81 e7 40 00 01
	04		 and	 edi, 67174464		; 04010040H
  00185	0b fb		 or	 edi, ebx
  00187	0b f7		 or	 esi, edi

; 179  : 	r			 = ((unsigned int)(temp & 0xFFFFFFFF) >>     16 );
; 180  : 	l			 = ((unsigned int)(temp & 0xFFFFFFFF) << (32-16));

  00189	8b f9		 mov	 edi, ecx
  0018b	c1 e7 10	 shl	 edi, 16			; 00000010H

; 181  : 	temp_r		|= (r & iMaskR) << 4;
; 182  : 	temp_r		|= (l & iMaskR) >> 4;

  0018e	8b ef		 mov	 ebp, edi
  00190	c1 ed 04	 shr	 ebp, 4
  00193	8b d9		 mov	 ebx, ecx
  00195	c1 eb 10	 shr	 ebx, 16			; 00000010H
  00198	89 5c 24 14	 mov	 DWORD PTR _r$[esp+12], ebx
  0019c	81 e3 02 08 20
	00		 and	 ebx, 2099202		; 00200802H
  001a2	c1 e3 04	 shl	 ebx, 4
  001a5	81 e5 80 00 02
	08		 and	 ebp, 134348928		; 08020080H
  001ab	0b eb		 or	 ebp, ebx

; 183  : 
; 184  : 	temp_l		|= (r & iMaskL) << 5;
; 185  : 	temp_l		|= (l & iMaskL) >> 3;

  001ad	8b 5c 24 14	 mov	 ebx, DWORD PTR _r$[esp+12]
  001b1	81 e3 01 04 10
	00		 and	 ebx, 1049601		; 00100401H
  001b7	c1 ef 03	 shr	 edi, 3
  001ba	c1 e3 05	 shl	 ebx, 5
  001bd	81 e7 80 00 02
	08		 and	 edi, 134348928		; 08020080H
  001c3	0b fb		 or	 edi, ebx
  001c5	0b f7		 or	 esi, edi
  001c7	0b d5		 or	 edx, ebp

; 186  : 	r			 = ((unsigned int)(temp>>32) >>     24 );
; 187  : 	l			 = ((unsigned int)(temp>>32) << (32-24));

  001c9	8b f8		 mov	 edi, eax
  001cb	c1 e7 08	 shl	 edi, 8
  001ce	8b d8		 mov	 ebx, eax
  001d0	c1 eb 18	 shr	 ebx, 24			; 00000018H

; 188  : 	temp_r		|= (r & iMaskR) << 5;
; 189  : 	temp_r		|= (l & iMaskR) >> 3;

  001d3	8b ef		 mov	 ebp, edi
  001d5	89 5c 24 14	 mov	 DWORD PTR _r$[esp+12], ebx
  001d9	c1 ed 03	 shr	 ebp, 3
  001dc	81 e3 02 08 20
	00		 and	 ebx, 2099202		; 00200802H
  001e2	c1 e3 05	 shl	 ebx, 5
  001e5	81 e5 00 01 04
	10		 and	 ebp, 268697856		; 10040100H
  001eb	0b eb		 or	 ebp, ebx

; 190  : 
; 191  : 	temp_l		|= (r & iMaskL) << 6;
; 192  : 	temp_l		|= (l & iMaskL) >> 2;

  001ed	8b 5c 24 14	 mov	 ebx, DWORD PTR _r$[esp+12]
  001f1	c1 ef 02	 shr	 edi, 2
  001f4	0b d5		 or	 edx, ebp
  001f6	81 e7 00 01 04
	10		 and	 edi, 268697856		; 10040100H
  001fc	81 e3 01 04 10
	00		 and	 ebx, 1049601		; 00100401H
  00202	c1 e3 06	 shl	 ebx, 6
  00205	0b fb		 or	 edi, ebx
  00207	0b f7		 or	 esi, edi

; 193  : 	r			 = ((unsigned int)(temp & 0xFFFFFFFF) >>     24 );

  00209	8b f9		 mov	 edi, ecx

; 194  : 	l			 = ((unsigned int)(temp & 0xFFFFFFFF) << (32-24));

  0020b	c1 e1 08	 shl	 ecx, 8
  0020e	c1 ef 18	 shr	 edi, 24			; 00000018H

; 195  : 	temp_r		|= (r & iMaskR) << 6;
; 196  : 	temp_r		|= (l & iMaskR) >> 2;

  00211	8b d9		 mov	 ebx, ecx
  00213	8b ef		 mov	 ebp, edi
  00215	c1 eb 02	 shr	 ebx, 2
  00218	81 e5 02 08 20
	00		 and	 ebp, 2099202		; 00200802H
  0021e	81 e3 00 02 08
	20		 and	 ebx, 537395712		; 20080200H
  00224	c1 e5 06	 shl	 ebp, 6

; 197  : 
; 198  : 	temp_l		|= (r & iMaskL) << 7;
; 199  : 	temp_l		|= (l & iMaskL) >> 1;

  00227	d1 e9		 shr	 ecx, 1
  00229	0b dd		 or	 ebx, ebp
  0022b	81 e7 01 04 10
	00		 and	 edi, 1049601		; 00100401H

; 200  : 	l			 =  (unsigned int)(temp>>32);
; 201  : 	temp_r		|= (l & iMaskR) >> 1;
; 202  : 
; 203  : 	temp	 = temp_l;
; 204  : 	temp	<<=32;
; 205  : 	temp	|= temp_r;
; 206  : 
; 207  : 	return(temp);

  00231	d1 e8		 shr	 eax, 1
  00233	0b d3		 or	 edx, ebx
  00235	81 e1 00 02 08
	20		 and	 ecx, 537395712		; 20080200H
  0023b	c1 e7 07	 shl	 edi, 7
  0023e	0b cf		 or	 ecx, edi
  00240	25 01 04 10 40	 and	 eax, 1074791425		; 40100401H
  00245	0b c2		 or	 eax, edx
  00247	0b f1		 or	 esi, ecx

; 208  : 
; 209  : }

  00249	5f		 pop	 edi
  0024a	33 d2		 xor	 edx, edx
  0024c	0b d6		 or	 edx, esi
  0024e	5e		 pop	 esi
  0024f	33 c9		 xor	 ecx, ecx
  00251	5d		 pop	 ebp
  00252	0b c1		 or	 eax, ecx
  00254	5b		 pop	 ebx
  00255	c2 08 00	 ret	 8
?IP@DES@@QAE_K_K@Z ENDP					; DES::IP
_TEXT	ENDS
PUBLIC	?KeyExpansion@DES@@QAEXPAXQA_K@Z		; DES::KeyExpansion
EXTRN	__allshl:PROC
EXTRN	__aullshr:PROC
; Function compile flags: /Ogtpy
;	COMDAT ?KeyExpansion@DES@@QAEXPAXQA_K@Z
_TEXT	SEGMENT
tv1284 = -48						; size = 4
tv1276 = -44						; size = 4
tv1292 = -40						; size = 4
_C$ = -36						; size = 4
tv1228 = -32						; size = 4
_D$ = -32						; size = 4
tv1240 = -28						; size = 4
tv1238 = -28						; size = 4
tv1236 = -28						; size = 4
tv1234 = -28						; size = 4
tv1232 = -28						; size = 4
tv1230 = -28						; size = 4
_i$ = -28						; size = 4
tv1438 = -24						; size = 4
tv1450 = -20						; size = 4
tv1462 = -16						; size = 4
tv854 = -16						; size = 8
_CD$ = -8						; size = 8
_ptKS$ = 8						; size = 4
?KeyExpansion@DES@@QAEXPAXQA_K@Z PROC			; DES::KeyExpansion, COMDAT
; _key$ = eax

; 55   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 e4 f8	 and	 esp, -8			; fffffff8H
  00006	83 ec 34	 sub	 esp, 52			; 00000034H
  00009	53		 push	 ebx

; 56   : 	static	const	unsigned	char	nshift[16]={
; 57   : 		1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1};
; 58   : 
; 59   : 	static	const	unsigned	char	pc1[56]={
; 60   : 		63,55,47,39,31,23,15,
; 61   : 		 7,62,54,46,38,30,22,
; 62   : 		14, 6,61,53,45,37,29,
; 63   : 		21,13, 5,60,52,44,36,
; 64   : 		57,49,41,33,25,17, 9,
; 65   : 		 1,58,50,42,34,26,18,
; 66   : 		10, 2,59,51,43,35,27,
; 67   : 		19,11, 3,28,20,12, 4};
; 68   : 
; 69   : 	static	const	unsigned	 char	pc2[48]={
; 70   : 		42,39,45,32,55,51,
; 71   : 		53,28,41,50,35,46,
; 72   : 		33,37,44,52,30,48,
; 73   : 		40,49,29,36,43,54,
; 74   : 		15, 4,25,19, 9, 1,
; 75   : 		26,16, 5,11,23, 8,
; 76   : 		12, 7,17, 0,22, 3,
; 77   : 		10,14, 6,20,27,24};
; 78   : 
; 79   : 	unsigned	__int64*	iKey	= (unsigned	__int64*)key;
; 80   : 
; 81   : 	unsigned	__int64		CD;
; 82   : 	unsigned	int			C = 0;
; 83   : 	unsigned	int			D = 0;
; 84   : 				int			i,j;
; 85   : 	unsigned	char		r;
; 86   : 
; 87   : 	//--------------
; 88   : 	//Permuted Chose 1
; 89   : 	i = 0;

  0000a	8b 58 04	 mov	 ebx, DWORD PTR [eax+4]
  0000d	56		 push	 esi
  0000e	33 f6		 xor	 esi, esi
  00010	57		 push	 edi
  00011	8b 38		 mov	 edi, DWORD PTR [eax]
  00013	89 74 24 1c	 mov	 DWORD PTR _C$[esp+64], esi
  00017	89 74 24 20	 mov	 DWORD PTR _D$[esp+64], esi
  0001b	89 5c 24 34	 mov	 DWORD PTR tv854[esp+68], ebx
  0001f	eb 04		 jmp	 SHORT $LN6@KeyExpansi
$LL17@KeyExpansi:
  00021	8b 5c 24 34	 mov	 ebx, DWORD PTR tv854[esp+68]
$LN6@KeyExpansi:

; 90   : 	while(i < 28){	//56
; 91   : 		C <<= 1;
; 92   : 		D <<= 1;
; 93   : 		C |= (*iKey >> pc1[ 0+i]) & 0x01;

  00025	0f b6 8e 00 00
	00 00		 movzx	 ecx, BYTE PTR ?pc1@?1??KeyExpansion@DES@@QAEXPAXQA_K@Z@4QBEB[esi]
  0002c	8b c7		 mov	 eax, edi
  0002e	8b d3		 mov	 edx, ebx
  00030	e8 00 00 00 00	 call	 __aullshr
  00035	8b 4c 24 1c	 mov	 ecx, DWORD PTR _C$[esp+64]
  00039	83 e0 01	 and	 eax, 1
  0003c	8d 14 09	 lea	 edx, DWORD PTR [ecx+ecx]
  0003f	0f b6 8e 01 00
	00 00		 movzx	 ecx, BYTE PTR ?pc1@?1??KeyExpansion@DES@@QAEXPAXQA_K@Z@4QBEB[esi+1]
  00046	0b c2		 or	 eax, edx
  00048	03 c0		 add	 eax, eax
  0004a	89 44 24 24	 mov	 DWORD PTR tv1240[esp+64], eax
  0004e	8b c7		 mov	 eax, edi
  00050	8b d3		 mov	 edx, ebx
  00052	e8 00 00 00 00	 call	 __aullshr
  00057	8b 4c 24 24	 mov	 ecx, DWORD PTR tv1240[esp+64]
  0005b	8b 54 24 34	 mov	 edx, DWORD PTR tv854[esp+68]
  0005f	83 e0 01	 and	 eax, 1
  00062	0b c8		 or	 ecx, eax
  00064	03 c9		 add	 ecx, ecx
  00066	89 4c 24 24	 mov	 DWORD PTR tv1238[esp+64], ecx
  0006a	0f b6 8e 02 00
	00 00		 movzx	 ecx, BYTE PTR ?pc1@?1??KeyExpansion@DES@@QAEXPAXQA_K@Z@4QBEB[esi+2]
  00071	8b c7		 mov	 eax, edi
  00073	e8 00 00 00 00	 call	 __aullshr
  00078	8b 4c 24 24	 mov	 ecx, DWORD PTR tv1238[esp+64]
  0007c	8b 54 24 34	 mov	 edx, DWORD PTR tv854[esp+68]
  00080	83 e0 01	 and	 eax, 1
  00083	0b c8		 or	 ecx, eax
  00085	03 c9		 add	 ecx, ecx
  00087	89 4c 24 24	 mov	 DWORD PTR tv1236[esp+64], ecx
  0008b	0f b6 8e 03 00
	00 00		 movzx	 ecx, BYTE PTR ?pc1@?1??KeyExpansion@DES@@QAEXPAXQA_K@Z@4QBEB[esi+3]
  00092	8b c7		 mov	 eax, edi
  00094	e8 00 00 00 00	 call	 __aullshr
  00099	8b 4c 24 24	 mov	 ecx, DWORD PTR tv1236[esp+64]

; 94   : 		D |= (*iKey >> pc1[28+i]) & 0x01;

  0009d	8b 5c 24 34	 mov	 ebx, DWORD PTR tv854[esp+68]
  000a1	83 e0 01	 and	 eax, 1
  000a4	0b c8		 or	 ecx, eax
  000a6	89 4c 24 1c	 mov	 DWORD PTR _C$[esp+64], ecx
  000aa	0f b6 8e 1c 00
	00 00		 movzx	 ecx, BYTE PTR ?pc1@?1??KeyExpansion@DES@@QAEXPAXQA_K@Z@4QBEB[esi+28]
  000b1	8b c7		 mov	 eax, edi
  000b3	8b d3		 mov	 edx, ebx
  000b5	e8 00 00 00 00	 call	 __aullshr
  000ba	8b 4c 24 20	 mov	 ecx, DWORD PTR _D$[esp+64]
  000be	83 e0 01	 and	 eax, 1
  000c1	8d 14 09	 lea	 edx, DWORD PTR [ecx+ecx]
  000c4	0f b6 8e 1d 00
	00 00		 movzx	 ecx, BYTE PTR ?pc1@?1??KeyExpansion@DES@@QAEXPAXQA_K@Z@4QBEB[esi+29]
  000cb	0b c2		 or	 eax, edx
  000cd	03 c0		 add	 eax, eax
  000cf	89 44 24 24	 mov	 DWORD PTR tv1234[esp+64], eax
  000d3	8b c7		 mov	 eax, edi
  000d5	8b d3		 mov	 edx, ebx
  000d7	e8 00 00 00 00	 call	 __aullshr
  000dc	8b 4c 24 24	 mov	 ecx, DWORD PTR tv1234[esp+64]
  000e0	83 e0 01	 and	 eax, 1
  000e3	0b c8		 or	 ecx, eax
  000e5	03 c9		 add	 ecx, ecx
  000e7	89 4c 24 24	 mov	 DWORD PTR tv1232[esp+64], ecx
  000eb	0f b6 8e 1e 00
	00 00		 movzx	 ecx, BYTE PTR ?pc1@?1??KeyExpansion@DES@@QAEXPAXQA_K@Z@4QBEB[esi+30]
  000f2	8b c7		 mov	 eax, edi
  000f4	8b d3		 mov	 edx, ebx
  000f6	e8 00 00 00 00	 call	 __aullshr
  000fb	8b 4c 24 24	 mov	 ecx, DWORD PTR tv1232[esp+64]
  000ff	83 e0 01	 and	 eax, 1
  00102	0b c8		 or	 ecx, eax
  00104	03 c9		 add	 ecx, ecx
  00106	89 4c 24 24	 mov	 DWORD PTR tv1230[esp+64], ecx
  0010a	0f b6 8e 1f 00
	00 00		 movzx	 ecx, BYTE PTR ?pc1@?1??KeyExpansion@DES@@QAEXPAXQA_K@Z@4QBEB[esi+31]
  00111	8b c7		 mov	 eax, edi
  00113	8b d3		 mov	 edx, ebx
  00115	e8 00 00 00 00	 call	 __aullshr
  0011a	8b 4c 24 24	 mov	 ecx, DWORD PTR tv1230[esp+64]
  0011e	83 e0 01	 and	 eax, 1
  00121	0b c8		 or	 ecx, eax
  00123	83 c6 04	 add	 esi, 4
  00126	83 fe 1c	 cmp	 esi, 28			; 0000001cH
  00129	89 4c 24 20	 mov	 DWORD PTR _D$[esp+64], ecx
  0012d	0f 8c ee fe ff
	ff		 jl	 $LL17@KeyExpansi

; 95   : 		i++;
; 96   : 	}
; 97   : 
; 98   : 	i = 0;

  00133	8b 75 08	 mov	 esi, DWORD PTR _ptKS$[ebp]
  00136	b8 00 00 00 00	 mov	 eax, OFFSET ?pc2@?1??KeyExpansion@DES@@QAEXPAXQA_K@Z@4QBEB
  0013b	48		 dec	 eax
  0013c	89 44 24 28	 mov	 DWORD PTR tv1438[esp+64], eax
  00140	b8 02 00 00 00	 mov	 eax, OFFSET ?pc2@?1??KeyExpansion@DES@@QAEXPAXQA_K@Z@4QBEB+2
  00145	83 e8 03	 sub	 eax, 3
  00148	89 44 24 2c	 mov	 DWORD PTR tv1450[esp+64], eax
  0014c	b8 04 00 00 00	 mov	 eax, OFFSET ?pc2@?1??KeyExpansion@DES@@QAEXPAXQA_K@Z@4QBEB+4
  00151	83 e8 05	 sub	 eax, 5
  00154	c7 44 24 24 00
	00 00 00	 mov	 DWORD PTR _i$[esp+64], 0
  0015c	89 44 24 30	 mov	 DWORD PTR tv1462[esp+64], eax
$LN4@KeyExpansi:

; 99   : 	while(i < DES_Round){
; 100  : 		//--------------
; 101  : 		//Left rotate
; 102  : 		r	= nshift[i];
; 103  : 		C	= ((C<<r) | (C>>(28-r))) & 0x0FFFFFFF;	

  00160	8b 44 24 24	 mov	 eax, DWORD PTR _i$[esp+64]
  00164	0f b6 80 00 00
	00 00		 movzx	 eax, BYTE PTR ?nshift@?1??KeyExpansion@DES@@QAEXPAXQA_K@Z@4QBEB[eax]
  0016b	8b 7c 24 1c	 mov	 edi, DWORD PTR _C$[esp+64]
  0016f	8b df		 mov	 ebx, edi
  00171	ba 1c 00 00 00	 mov	 edx, 28			; 0000001cH
  00176	2b d0		 sub	 edx, eax
  00178	8b ca		 mov	 ecx, edx
  0017a	d3 eb		 shr	 ebx, cl
  0017c	8b c8		 mov	 ecx, eax
  0017e	d3 e7		 shl	 edi, cl
  00180	c7 44 24 14 05
	00 00 00	 mov	 DWORD PTR tv1276[esp+64], 5
  00188	c7 44 24 10 03
	00 00 00	 mov	 DWORD PTR tv1284[esp+64], 3
  00190	c7 44 24 18 01
	00 00 00	 mov	 DWORD PTR tv1292[esp+64], 1
  00198	0b df		 or	 ebx, edi
  0019a	81 e3 ff ff ff
	0f		 and	 ebx, 268435455		; 0fffffffH
  001a0	8b fb		 mov	 edi, ebx

; 104  : 		D	= ((D<<r) | (D>>(28-r))) & 0x0FFFFFFF;	//28bit

  001a2	8b 5c 24 20	 mov	 ebx, DWORD PTR _D$[esp+64]
  001a6	8b cb		 mov	 ecx, ebx
  001a8	89 4c 24 20	 mov	 DWORD PTR tv1228[esp+64], ecx
  001ac	8b ca		 mov	 ecx, edx
  001ae	8b d3		 mov	 edx, ebx
  001b0	d3 ea		 shr	 edx, cl
  001b2	8b c8		 mov	 ecx, eax
  001b4	d3 e3		 shl	 ebx, cl

; 105  : 		CD	= C;
; 106  : 		CD<<= 28;

  001b6	33 c0		 xor	 eax, eax
  001b8	89 7c 24 1c	 mov	 DWORD PTR _C$[esp+64], edi
  001bc	0f a4 f8 1c	 shld	 eax, edi, 28
  001c0	0b d3		 or	 edx, ebx
  001c2	81 e2 ff ff ff
	0f		 and	 edx, 268435455		; 0fffffffH
  001c8	8b ca		 mov	 ecx, edx
  001ca	c1 e7 1c	 shl	 edi, 28			; 0000001cH

; 107  : 		CD |= D;

  001cd	33 d2		 xor	 edx, edx
  001cf	8b df		 mov	 ebx, edi
  001d1	0b c2		 or	 eax, edx
  001d3	0b d9		 or	 ebx, ecx
  001d5	89 4c 24 20	 mov	 DWORD PTR _D$[esp+64], ecx
  001d9	89 44 24 3c	 mov	 DWORD PTR _CD$[esp+68], eax

; 108  : 
; 109  : 		//--------------
; 110  : 		//Permuted Chose 2
; 111  : 		j	= 0;

  001dd	33 ff		 xor	 edi, edi
  001df	90		 npad	 1
$LL2@KeyExpansi:

; 112  : 		while(j < 48){
; 113  : 		//	ptKS[i] <<= 1;
; 114  : 			ptKS[i] <<= ((j%6)?1:3);	//6bit‚ð8bit–ˆ‚É¶‹l‚ß‚·‚éB

  001e0	b8 ab aa aa aa	 mov	 eax, -1431655765	; aaaaaaabH
  001e5	f7 e7		 mul	 edi
  001e7	c1 ea 02	 shr	 edx, 2
  001ea	8d 04 52	 lea	 eax, DWORD PTR [edx+edx*2]
  001ed	8b 56 04	 mov	 edx, DWORD PTR [esi+4]
  001f0	03 c0		 add	 eax, eax
  001f2	8b cf		 mov	 ecx, edi
  001f4	2b c8		 sub	 ecx, eax
  001f6	8b 06		 mov	 eax, DWORD PTR [esi]
  001f8	f7 d9		 neg	 ecx
  001fa	1b c9		 sbb	 ecx, ecx
  001fc	83 e1 fe	 and	 ecx, -2			; fffffffeH
  001ff	83 c1 03	 add	 ecx, 3
  00202	e8 00 00 00 00	 call	 __allshl

; 115  : 			ptKS[i] |= (CD >> pc2[j]) & 0x01;

  00207	8b 4c 24 28	 mov	 ecx, DWORD PTR tv1438[esp+64]
  0020b	89 56 04	 mov	 DWORD PTR [esi+4], edx
  0020e	8b 54 24 18	 mov	 edx, DWORD PTR tv1292[esp+64]
  00212	89 06		 mov	 DWORD PTR [esi], eax
  00214	0f b6 0c 11	 movzx	 ecx, BYTE PTR [ecx+edx]
  00218	8b 54 24 3c	 mov	 edx, DWORD PTR _CD$[esp+68]
  0021c	8b c3		 mov	 eax, ebx
  0021e	e8 00 00 00 00	 call	 __aullshr
  00223	83 e0 01	 and	 eax, 1
  00226	09 06		 or	 DWORD PTR [esi], eax
  00228	33 d2		 xor	 edx, edx
  0022a	09 56 04	 or	 DWORD PTR [esi+4], edx
  0022d	b8 ab aa aa aa	 mov	 eax, -1431655765	; aaaaaaabH
  00232	f7 64 24 18	 mul	 DWORD PTR tv1292[esp+64]
  00236	c1 ea 02	 shr	 edx, 2
  00239	8d 04 52	 lea	 eax, DWORD PTR [edx+edx*2]
  0023c	8b 56 04	 mov	 edx, DWORD PTR [esi+4]
  0023f	03 c0		 add	 eax, eax
  00241	8b cf		 mov	 ecx, edi
  00243	2b c8		 sub	 ecx, eax
  00245	8b 06		 mov	 eax, DWORD PTR [esi]
  00247	41		 inc	 ecx
  00248	f7 d9		 neg	 ecx
  0024a	1b c9		 sbb	 ecx, ecx
  0024c	83 e1 fe	 and	 ecx, -2			; fffffffeH
  0024f	83 c1 03	 add	 ecx, 3
  00252	e8 00 00 00 00	 call	 __allshl
  00257	8b 4c 24 18	 mov	 ecx, DWORD PTR tv1292[esp+64]
  0025b	89 06		 mov	 DWORD PTR [esi], eax
  0025d	89 56 04	 mov	 DWORD PTR [esi+4], edx
  00260	0f b6 89 00 00
	00 00		 movzx	 ecx, BYTE PTR ?pc2@?1??KeyExpansion@DES@@QAEXPAXQA_K@Z@4QBEB[ecx]
  00267	8b 54 24 3c	 mov	 edx, DWORD PTR _CD$[esp+68]
  0026b	8b c3		 mov	 eax, ebx
  0026d	e8 00 00 00 00	 call	 __aullshr
  00272	33 d2		 xor	 edx, edx
  00274	09 56 04	 or	 DWORD PTR [esi+4], edx
  00277	8b 54 24 10	 mov	 edx, DWORD PTR tv1284[esp+64]
  0027b	83 e0 01	 and	 eax, 1
  0027e	09 06		 or	 DWORD PTR [esi], eax
  00280	4a		 dec	 edx
  00281	b8 ab aa aa aa	 mov	 eax, -1431655765	; aaaaaaabH
  00286	f7 e2		 mul	 edx
  00288	c1 ea 02	 shr	 edx, 2
  0028b	8d 04 52	 lea	 eax, DWORD PTR [edx+edx*2]
  0028e	8b 56 04	 mov	 edx, DWORD PTR [esi+4]
  00291	03 c0		 add	 eax, eax
  00293	8b cf		 mov	 ecx, edi
  00295	2b c8		 sub	 ecx, eax
  00297	8b 06		 mov	 eax, DWORD PTR [esi]
  00299	83 c1 02	 add	 ecx, 2
  0029c	f7 d9		 neg	 ecx
  0029e	1b c9		 sbb	 ecx, ecx
  002a0	83 e1 fe	 and	 ecx, -2			; fffffffeH
  002a3	83 c1 03	 add	 ecx, 3
  002a6	e8 00 00 00 00	 call	 __allshl
  002ab	8b 4c 24 2c	 mov	 ecx, DWORD PTR tv1450[esp+64]
  002af	89 56 04	 mov	 DWORD PTR [esi+4], edx
  002b2	8b 54 24 10	 mov	 edx, DWORD PTR tv1284[esp+64]
  002b6	89 06		 mov	 DWORD PTR [esi], eax
  002b8	0f b6 0c 11	 movzx	 ecx, BYTE PTR [ecx+edx]
  002bc	8b 54 24 3c	 mov	 edx, DWORD PTR _CD$[esp+68]
  002c0	8b c3		 mov	 eax, ebx
  002c2	e8 00 00 00 00	 call	 __aullshr
  002c7	83 e0 01	 and	 eax, 1
  002ca	09 06		 or	 DWORD PTR [esi], eax
  002cc	33 d2		 xor	 edx, edx
  002ce	09 56 04	 or	 DWORD PTR [esi+4], edx
  002d1	b8 ab aa aa aa	 mov	 eax, -1431655765	; aaaaaaabH
  002d6	f7 64 24 10	 mul	 DWORD PTR tv1284[esp+64]
  002da	c1 ea 02	 shr	 edx, 2
  002dd	8d 04 52	 lea	 eax, DWORD PTR [edx+edx*2]
  002e0	8b 56 04	 mov	 edx, DWORD PTR [esi+4]
  002e3	03 c0		 add	 eax, eax
  002e5	8b cf		 mov	 ecx, edi
  002e7	2b c8		 sub	 ecx, eax
  002e9	8b 06		 mov	 eax, DWORD PTR [esi]
  002eb	83 c1 03	 add	 ecx, 3
  002ee	f7 d9		 neg	 ecx
  002f0	1b c9		 sbb	 ecx, ecx
  002f2	83 e1 fe	 and	 ecx, -2			; fffffffeH
  002f5	83 c1 03	 add	 ecx, 3
  002f8	e8 00 00 00 00	 call	 __allshl
  002fd	8b 4c 24 10	 mov	 ecx, DWORD PTR tv1284[esp+64]
  00301	89 06		 mov	 DWORD PTR [esi], eax
  00303	89 56 04	 mov	 DWORD PTR [esi+4], edx
  00306	0f b6 89 00 00
	00 00		 movzx	 ecx, BYTE PTR ?pc2@?1??KeyExpansion@DES@@QAEXPAXQA_K@Z@4QBEB[ecx]
  0030d	8b 54 24 3c	 mov	 edx, DWORD PTR _CD$[esp+68]
  00311	8b c3		 mov	 eax, ebx
  00313	e8 00 00 00 00	 call	 __aullshr
  00318	33 d2		 xor	 edx, edx
  0031a	09 56 04	 or	 DWORD PTR [esi+4], edx
  0031d	8b 54 24 14	 mov	 edx, DWORD PTR tv1276[esp+64]
  00321	83 e0 01	 and	 eax, 1
  00324	09 06		 or	 DWORD PTR [esi], eax
  00326	4a		 dec	 edx
  00327	b8 ab aa aa aa	 mov	 eax, -1431655765	; aaaaaaabH
  0032c	f7 e2		 mul	 edx
  0032e	c1 ea 02	 shr	 edx, 2
  00331	8d 04 52	 lea	 eax, DWORD PTR [edx+edx*2]
  00334	8b 56 04	 mov	 edx, DWORD PTR [esi+4]
  00337	03 c0		 add	 eax, eax
  00339	8b cf		 mov	 ecx, edi
  0033b	2b c8		 sub	 ecx, eax
  0033d	8b 06		 mov	 eax, DWORD PTR [esi]
  0033f	83 c1 04	 add	 ecx, 4
  00342	f7 d9		 neg	 ecx
  00344	1b c9		 sbb	 ecx, ecx
  00346	83 e1 fe	 and	 ecx, -2			; fffffffeH
  00349	83 c1 03	 add	 ecx, 3
  0034c	e8 00 00 00 00	 call	 __allshl
  00351	8b 4c 24 30	 mov	 ecx, DWORD PTR tv1462[esp+64]
  00355	89 56 04	 mov	 DWORD PTR [esi+4], edx
  00358	8b 54 24 14	 mov	 edx, DWORD PTR tv1276[esp+64]
  0035c	89 06		 mov	 DWORD PTR [esi], eax
  0035e	0f b6 0c 11	 movzx	 ecx, BYTE PTR [ecx+edx]
  00362	8b 54 24 3c	 mov	 edx, DWORD PTR _CD$[esp+68]
  00366	8b c3		 mov	 eax, ebx
  00368	e8 00 00 00 00	 call	 __aullshr
  0036d	83 e0 01	 and	 eax, 1
  00370	09 06		 or	 DWORD PTR [esi], eax
  00372	33 d2		 xor	 edx, edx
  00374	09 56 04	 or	 DWORD PTR [esi+4], edx
  00377	b8 ab aa aa aa	 mov	 eax, -1431655765	; aaaaaaabH
  0037c	f7 64 24 14	 mul	 DWORD PTR tv1276[esp+64]
  00380	c1 ea 02	 shr	 edx, 2
  00383	8d 04 52	 lea	 eax, DWORD PTR [edx+edx*2]
  00386	8b 56 04	 mov	 edx, DWORD PTR [esi+4]
  00389	03 c0		 add	 eax, eax
  0038b	8b cf		 mov	 ecx, edi
  0038d	2b c8		 sub	 ecx, eax
  0038f	8b 06		 mov	 eax, DWORD PTR [esi]
  00391	83 c1 05	 add	 ecx, 5
  00394	f7 d9		 neg	 ecx
  00396	1b c9		 sbb	 ecx, ecx
  00398	83 e1 fe	 and	 ecx, -2			; fffffffeH
  0039b	83 c1 03	 add	 ecx, 3
  0039e	e8 00 00 00 00	 call	 __allshl
  003a3	8b 4c 24 14	 mov	 ecx, DWORD PTR tv1276[esp+64]
  003a7	89 06		 mov	 DWORD PTR [esi], eax
  003a9	89 56 04	 mov	 DWORD PTR [esi+4], edx
  003ac	0f b6 89 00 00
	00 00		 movzx	 ecx, BYTE PTR ?pc2@?1??KeyExpansion@DES@@QAEXPAXQA_K@Z@4QBEB[ecx]
  003b3	8b 54 24 3c	 mov	 edx, DWORD PTR _CD$[esp+68]
  003b7	8b c3		 mov	 eax, ebx
  003b9	e8 00 00 00 00	 call	 __aullshr
  003be	83 e0 01	 and	 eax, 1
  003c1	09 06		 or	 DWORD PTR [esi], eax
  003c3	33 d2		 xor	 edx, edx
  003c5	09 56 04	 or	 DWORD PTR [esi+4], edx
  003c8	8b 44 24 18	 mov	 eax, DWORD PTR tv1292[esp+64]
  003cc	b9 06 00 00 00	 mov	 ecx, 6
  003d1	01 4c 24 10	 add	 DWORD PTR tv1284[esp+64], ecx
  003d5	01 4c 24 14	 add	 DWORD PTR tv1276[esp+64], ecx
  003d9	03 c1		 add	 eax, ecx
  003db	03 f9		 add	 edi, ecx
  003dd	83 f8 31	 cmp	 eax, 49			; 00000031H
  003e0	89 44 24 18	 mov	 DWORD PTR tv1292[esp+64], eax
  003e4	0f 8c f6 fd ff
	ff		 jl	 $LL2@KeyExpansi

; 116  : 			j++;
; 117  : 		}
; 118  : 		i++;

  003ea	8b 44 24 24	 mov	 eax, DWORD PTR _i$[esp+64]
  003ee	40		 inc	 eax
  003ef	83 c6 08	 add	 esi, 8
  003f2	83 f8 10	 cmp	 eax, 16			; 00000010H
  003f5	89 44 24 24	 mov	 DWORD PTR _i$[esp+64], eax
  003f9	0f 8c 61 fd ff
	ff		 jl	 $LN4@KeyExpansi

; 119  : 	}
; 120  : }

  003ff	5f		 pop	 edi
  00400	5e		 pop	 esi
  00401	5b		 pop	 ebx
  00402	8b e5		 mov	 esp, ebp
  00404	5d		 pop	 ebp
  00405	c2 04 00	 ret	 4
?KeyExpansion@DES@@QAEXPAXQA_K@Z ENDP			; DES::KeyExpansion
; Function compile flags: /Ogtpy
_TEXT	ENDS
;	COMDAT ?Clear_Key@DES@@UAEXXZ
_TEXT	SEGMENT
?Clear_Key@DES@@UAEXXZ PROC				; DES::Clear_Key, COMDAT
; _this$ = ecx

; 38   : {

  00000	56		 push	 esi

; 39   : 	int	i=0;

  00001	8d b1 b0 00 00
	00		 lea	 esi, DWORD PTR [ecx+176]
  00007	57		 push	 edi

; 40   : 
; 41   : 	while (i < DES_Round){
; 42   : 		k[i] = 0;

  00008	8d 7e 08	 lea	 edi, DWORD PTR [esi+8]
  0000b	c7 06 00 00 00
	00		 mov	 DWORD PTR [esi], 0
  00011	c7 46 04 00 00
	00 00		 mov	 DWORD PTR [esi+4], 0
  00018	b9 1e 00 00 00	 mov	 ecx, 30			; 0000001eH
  0001d	f3 a5		 rep movsd
  0001f	5f		 pop	 edi
  00020	5e		 pop	 esi

; 43   : 		i++;
; 44   : 	};
; 45   : }

  00021	c3		 ret	 0
?Clear_Key@DES@@UAEXXZ ENDP				; DES::Clear_Key
; Function compile flags: /Ogtpy
; File i:\“n•”“ÄŽj\my project\cms\cms\asn1\algorithm\des.h
;	COMDAT ?Set_Key@DES@@UAEXPAX@Z
_TEXT	SEGMENT
_key$ = 8						; size = 4
?Set_Key@DES@@UAEXPAX@Z PROC				; DES::Set_Key, COMDAT
; _this$ = ecx

; 63   : 			void	Set_Key(void *key){KeyExpansion((unsigned char *)key, k);};		//ˆÃ†Œ® Ý’è

  00000	8b 44 24 04	 mov	 eax, DWORD PTR _key$[esp-4]
  00004	81 c1 b0 00 00
	00		 add	 ecx, 176		; 000000b0H
  0000a	51		 push	 ecx
  0000b	e8 00 00 00 00	 call	 ?KeyExpansion@DES@@QAEXPAXQA_K@Z ; DES::KeyExpansion
  00010	c2 04 00	 ret	 4
?Set_Key@DES@@UAEXPAX@Z ENDP				; DES::Set_Key
_TEXT	ENDS
PUBLIC	__$ArrayPad$
PUBLIC	?f@DES@@QAEII_K@Z				; DES::f
; Function compile flags: /Ogtpy
; File i:\“n•”“ÄŽj\my project\cms\cms\asn1\algorithm\des.cpp
;	COMDAT ?f@DES@@QAEII_K@Z
_TEXT	SEGMENT
_exData$ = -16						; size = 8
__$ArrayPad$ = -4					; size = 4
_iKey$ = 8						; size = 8
?f@DES@@QAEII_K@Z PROC					; DES::f, COMDAT
; _iData$ = ecx

; 341  : {

  00000	83 ec 10	 sub	 esp, 16			; 00000010H
  00003	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  00008	33 c4		 xor	 eax, esp
  0000a	89 44 24 0c	 mov	 DWORD PTR __$ArrayPad$[esp+16], eax
  0000e	56		 push	 esi

; 342  : 	static	const	unsigned	char	s[8][64]={
; 343  : 		14, 0, 4,15,13, 7, 1, 4, 2,14,15, 2,11,13, 8, 1,	//S[0]
; 344  : 		 3,10,10, 6, 6,12,12,11, 5, 9, 9, 5, 0, 3, 7, 8,
; 345  : 		 4,15, 1,12,14, 8, 8, 2,13, 4, 6, 9, 2, 1,11, 7,
; 346  : 		15, 5,12,11, 9, 3, 7,14, 3,10,10, 0, 5, 6, 0,13,
; 347  : 		15, 3, 1,13, 8, 4,14, 7, 6,15,11, 2, 3, 8, 4,14,	//S[1]
; 348  : 		 9,12, 7, 0, 2, 1,13,10,12, 6, 0, 9, 5,11,10, 5,
; 349  : 		 0,13,14, 8, 7,10,11, 1,10, 3, 4,15,13, 4, 1, 2,
; 350  : 		 5,11, 8, 6,12, 7, 6,12, 9, 0, 3, 5, 2,14,15, 9,
; 351  : 		10,13, 0, 7, 9, 0,14, 9, 6, 3, 3, 4,15, 6, 5,10,	//S[2]
; 352  : 		 1, 2,13, 8,12, 5, 7,14,11,12, 4,11, 2,15, 8, 1,
; 353  : 		13, 1, 6,10, 4,13, 9, 0, 8, 6,15, 9, 3, 8, 0, 7,
; 354  : 		11, 4, 1,15, 2,14,12, 3, 5,11,10, 5,14, 2, 7,12,
; 355  : 		 7,13,13, 8,14,11, 3, 5, 0, 6, 6,15, 9, 0,10, 3,	//S[3]
; 356  : 		 1, 4, 2, 7, 8, 2, 5,12,11, 1,12,10, 4,14,15, 9,
; 357  : 		10, 3, 6,15, 9, 0, 0, 6,12,10,11, 1, 7,13,13, 8,
; 358  : 		15, 9, 1, 4, 3, 5,14,11, 5,12, 2, 7, 8, 2, 4,14,
; 359  : 		 2,14,12,11, 4, 2, 1,12, 7, 4,10, 7,11,13, 6, 1,	//S[4]
; 360  : 		 8, 5, 5, 0, 3,15,15,10,13, 3, 0, 9,14, 8, 9, 6,
; 361  : 		 4,11, 2, 8, 1,12,11, 7,10, 1,13,14, 7, 2, 8,13,
; 362  : 		15, 6, 9,15,12, 0, 5, 9, 6,10, 3, 4, 0, 5,14, 3,
; 363  : 		12,10, 1,15,10, 4,15, 2, 9, 7, 2,12, 6, 9, 8, 5,	//S[5]
; 364  : 		 0, 6,13, 1, 3,13, 4,14,14, 0, 7,11, 5, 3,11, 8,
; 365  : 		 9, 4,14, 3,15, 2, 5,12, 2, 9, 8, 5,12,15, 3,10,
; 366  : 		 7,11, 0,14, 4, 1,10, 7, 1, 6,13, 0,11, 8, 6,13,
; 367  : 		 4,13,11, 0, 2,11,14, 7,15, 4, 0, 9, 8, 1,13,10,	//S[6]
; 368  : 		 3,14,12, 3, 9, 5, 7,12, 5, 2,10,15, 6, 8, 1, 6,
; 369  : 		 1, 6, 4,11,11,13,13, 8,12, 1, 3, 4, 7,10,14, 7,
; 370  : 		10, 9,15, 5, 6, 0, 8,15, 0,14, 5, 2, 9, 3, 2,12,
; 371  : 		13, 1, 2,15, 8,13, 4, 8, 6,10,15, 3,11, 7, 1, 4,	//S[7]
; 372  : 		10,12, 9, 5, 3, 6,14,11, 5, 0, 0,14,12, 9, 7, 2,
; 373  : 		 7, 2,11, 1, 4,14, 1, 7, 9, 4,12,10,14, 8, 2,13,
; 374  : 		 0,15, 6,12,10, 9,13, 0,15, 3, 3, 5, 5, 6, 8,11};
; 375  : 
; 376  : 	unsigned	int			temp = 0;
; 377  : 	unsigned	int			i = 0;
; 378  : 	union{
; 379  : 		unsigned	char	c[8];
; 380  : 		unsigned	__int64	l;
; 381  : 	}	exData;
; 382  : 
; 383  : 	//--------------
; 384  : 	//Expand bit & Xor Key Schedule
; 385  : 	exData.l = E(iData) ^ iKey;		//k[iKey];

  0000f	e8 00 00 00 00	 call	 ?E@DES@@QAE_KI@Z	; DES::E
  00014	33 54 24 1c	 xor	 edx, DWORD PTR _iKey$[esp+20]
  00018	33 44 24 18	 xor	 eax, DWORD PTR _iKey$[esp+16]
  0001c	89 54 24 08	 mov	 DWORD PTR _exData$[esp+24], edx

; 386  : 
; 387  : 	//--------------
; 388  : 	//S-Box (Lockup table)
; 389  : 	i = 0;
; 390  : 	while(i<8){
; 391  : 		temp <<=	4;
; 392  : 		temp  |=	s[i][exData.c[7-i]];

  00020	0f b6 4c 24 0b	 movzx	 ecx, BYTE PTR _exData$[esp+27]
  00025	0f b6 b1 00 00
	00 00		 movzx	 esi, BYTE PTR ?s@?1??f@DES@@QAEII_K@Z@4QAY0EA@$$CBEA[ecx]
  0002c	0f b6 4c 24 0a	 movzx	 ecx, BYTE PTR _exData$[esp+26]
  00031	0f b6 89 40 00
	00 00		 movzx	 ecx, BYTE PTR ?s@?1??f@DES@@QAEII_K@Z@4QAY0EA@$$CBEA[ecx+64]
  00038	c1 e6 04	 shl	 esi, 4
  0003b	0b f1		 or	 esi, ecx
  0003d	0f b6 ce	 movzx	 ecx, dh
  00040	0f b6 89 80 00
	00 00		 movzx	 ecx, BYTE PTR ?s@?1??f@DES@@QAEII_K@Z@4QAY0EA@$$CBEA[ecx+128]
  00047	c1 e6 04	 shl	 esi, 4
  0004a	0b f1		 or	 esi, ecx
  0004c	0f b6 d2	 movzx	 edx, dl
  0004f	0f b6 8a c0 00
	00 00		 movzx	 ecx, BYTE PTR ?s@?1??f@DES@@QAEII_K@Z@4QAY0EA@$$CBEA[edx+192]
  00056	c1 e6 04	 shl	 esi, 4
  00059	0b f1		 or	 esi, ecx
  0005b	89 44 24 04	 mov	 DWORD PTR _exData$[esp+20], eax
  0005f	0f b6 54 24 07	 movzx	 edx, BYTE PTR _exData$[esp+23]
  00064	0f b6 8a 00 01
	00 00		 movzx	 ecx, BYTE PTR ?s@?1??f@DES@@QAEII_K@Z@4QAY0EA@$$CBEA[edx+256]
  0006b	0f b6 54 24 06	 movzx	 edx, BYTE PTR _exData$[esp+22]
  00070	c1 e6 04	 shl	 esi, 4
  00073	0b f1		 or	 esi, ecx
  00075	0f b6 8a 40 01
	00 00		 movzx	 ecx, BYTE PTR ?s@?1??f@DES@@QAEII_K@Z@4QAY0EA@$$CBEA[edx+320]
  0007c	c1 e6 04	 shl	 esi, 4
  0007f	0f b6 d4	 movzx	 edx, ah
  00082	0b f1		 or	 esi, ecx
  00084	0f b6 8a 80 01
	00 00		 movzx	 ecx, BYTE PTR ?s@?1??f@DES@@QAEII_K@Z@4QAY0EA@$$CBEA[edx+384]
  0008b	0f b6 d0	 movzx	 edx, al
  0008e	0f b6 82 c0 01
	00 00		 movzx	 eax, BYTE PTR ?s@?1??f@DES@@QAEII_K@Z@4QAY0EA@$$CBEA[edx+448]
  00095	c1 e6 04	 shl	 esi, 4
  00098	0b f1		 or	 esi, ecx
  0009a	c1 e6 04	 shl	 esi, 4
  0009d	0b f0		 or	 esi, eax

; 393  : 		i++;
; 394  : 	}
; 395  : 
; 396  : 	//--------------
; 397  : 	//Permutation function
; 398  : 	return(P(temp));

  0009f	e8 00 00 00 00	 call	 ?P@DES@@QAEII@Z		; DES::P

; 399  : 
; 400  : }

  000a4	8b 4c 24 10	 mov	 ecx, DWORD PTR __$ArrayPad$[esp+20]
  000a8	5e		 pop	 esi
  000a9	33 cc		 xor	 ecx, esp
  000ab	e8 00 00 00 00	 call	 @__security_check_cookie@4
  000b0	83 c4 10	 add	 esp, 16			; 00000010H
  000b3	c2 08 00	 ret	 8
?f@DES@@QAEII_K@Z ENDP					; DES::f
PUBLIC	?InvCipher@DES@@QAE_K_K@Z			; DES::InvCipher
; Function compile flags: /Ogtpy
;	COMDAT ?InvCipher@DES@@QAE_K_K@Z
_TEXT	SEGMENT
_this$ = 8						; size = 4
_iData$ = 12						; size = 8
?InvCipher@DES@@QAE_K_K@Z PROC				; DES::InvCipher, COMDAT

; 449  : 
; 450  : 	union{
; 451  : 		struct{
; 452  : 			unsigned	int	R;
; 453  : 			unsigned	int	L;
; 454  : 		}	i;
; 455  : 		unsigned	__int64	l;
; 456  : 	}	Data;
; 457  : 
; 458  : 	unsigned	int	i = DES_Round;
; 459  : 
; 460  : 	//--------------
; 461  : 	//IP
; 462  : 	Data.l	= IP(iData);

  00000	8b 44 24 0c	 mov	 eax, DWORD PTR _iData$[esp]
  00004	8b 4c 24 08	 mov	 ecx, DWORD PTR _iData$[esp-4]
  00008	53		 push	 ebx
  00009	55		 push	 ebp
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	50		 push	 eax
  0000d	51		 push	 ecx
  0000e	bf 10 00 00 00	 mov	 edi, 16			; 00000010H
  00013	e8 00 00 00 00	 call	 ?IP@DES@@QAE_K_K@Z	; DES::IP
  00018	8b 74 24 14	 mov	 esi, DWORD PTR _this$[esp+12]
  0001c	8b e8		 mov	 ebp, eax
  0001e	8b da		 mov	 ebx, edx
  00020	81 c6 30 01 00
	00		 add	 esi, 304		; 00000130H
$LL2@InvCipher@2:

; 463  : 
; 464  : 	//--------------
; 465  : 	//Round
; 466  : 	while(i>0){
; 467  : 		i--;
; 468  : 		Data.i.L =	Data.i.L ^ f(Data.i.R, k[i]);

  00026	8b 56 fc	 mov	 edx, DWORD PTR [esi-4]
  00029	8b 46 f8	 mov	 eax, DWORD PTR [esi-8]
  0002c	83 ee 08	 sub	 esi, 8
  0002f	52		 push	 edx
  00030	50		 push	 eax
  00031	8b cd		 mov	 ecx, ebp
  00033	4f		 dec	 edi
  00034	e8 00 00 00 00	 call	 ?f@DES@@QAEII_K@Z	; DES::f

; 469  : 		i--;
; 470  : 		Data.i.R =	Data.i.R ^ f(Data.i.L, k[i]);

  00039	8b 4e fc	 mov	 ecx, DWORD PTR [esi-4]
  0003c	8b 56 f8	 mov	 edx, DWORD PTR [esi-8]
  0003f	83 ee 08	 sub	 esi, 8
  00042	51		 push	 ecx
  00043	33 d8		 xor	 ebx, eax
  00045	52		 push	 edx
  00046	8b cb		 mov	 ecx, ebx
  00048	4f		 dec	 edi
  00049	e8 00 00 00 00	 call	 ?f@DES@@QAEII_K@Z	; DES::f
  0004e	33 e8		 xor	 ebp, eax
  00050	85 ff		 test	 edi, edi
  00052	77 d2		 ja	 SHORT $LL2@InvCipher@2

; 471  : 	}
; 472  : 
; 473  : 	//--------------
; 474  : 	//IP-1
; 475  : 	return(invIP(Data.l));	

  00054	53		 push	 ebx
  00055	55		 push	 ebp
  00056	e8 00 00 00 00	 call	 ?invIP@DES@@QAE_K_K@Z	; DES::invIP

; 476  : }

  0005b	5f		 pop	 edi
  0005c	5e		 pop	 esi
  0005d	5d		 pop	 ebp
  0005e	5b		 pop	 ebx
  0005f	c2 0c 00	 ret	 12			; 0000000cH
?InvCipher@DES@@QAE_K_K@Z ENDP				; DES::InvCipher
_TEXT	ENDS
PUBLIC	?Cipher@DES@@QAE_K_K@Z				; DES::Cipher
; Function compile flags: /Ogtpy
;	COMDAT ?Cipher@DES@@QAE_K_K@Z
_TEXT	SEGMENT
_this$ = 8						; size = 4
_iData$ = 12						; size = 8
?Cipher@DES@@QAE_K_K@Z PROC				; DES::Cipher, COMDAT

; 411  : 	union{
; 412  : 		struct{
; 413  : 			unsigned	int	R;	//‰ºˆÊ
; 414  : 			unsigned	int	L;	//ãˆÊ
; 415  : 		}	i;
; 416  : 		unsigned	__int64	l;
; 417  : 	}	Data;
; 418  : 
; 419  : 	unsigned	int	i = 0;
; 420  : 
; 421  : 	//--------------
; 422  : 	//IP
; 423  : 	Data.l	= IP(iData);

  00000	8b 44 24 0c	 mov	 eax, DWORD PTR _iData$[esp]
  00004	8b 4c 24 08	 mov	 ecx, DWORD PTR _iData$[esp-4]
  00008	53		 push	 ebx
  00009	55		 push	 ebp
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	50		 push	 eax
  0000d	51		 push	 ecx
  0000e	33 ff		 xor	 edi, edi
  00010	e8 00 00 00 00	 call	 ?IP@DES@@QAE_K_K@Z	; DES::IP
  00015	8b 74 24 14	 mov	 esi, DWORD PTR _this$[esp+12]
  00019	8b e8		 mov	 ebp, eax
  0001b	8b da		 mov	 ebx, edx
  0001d	81 c6 b0 00 00
	00		 add	 esi, 176		; 000000b0H
$LL2@Cipher@2:

; 424  : 
; 425  : 	//--------------
; 426  : 	//Round
; 427  : 	while(i < DES_Round){
; 428  : 		Data.i.L =	Data.i.L ^ f(Data.i.R, k[i]);

  00023	8b 56 04	 mov	 edx, DWORD PTR [esi+4]
  00026	8b 06		 mov	 eax, DWORD PTR [esi]
  00028	52		 push	 edx
  00029	50		 push	 eax
  0002a	8b cd		 mov	 ecx, ebp
  0002c	e8 00 00 00 00	 call	 ?f@DES@@QAEII_K@Z	; DES::f

; 429  : 		i++;
; 430  : 		Data.i.R =	Data.i.R ^ f(Data.i.L, k[i]);

  00031	8b 4e 0c	 mov	 ecx, DWORD PTR [esi+12]
  00034	8b 56 08	 mov	 edx, DWORD PTR [esi+8]
  00037	83 c6 08	 add	 esi, 8
  0003a	51		 push	 ecx
  0003b	33 d8		 xor	 ebx, eax
  0003d	52		 push	 edx
  0003e	8b cb		 mov	 ecx, ebx
  00040	47		 inc	 edi
  00041	e8 00 00 00 00	 call	 ?f@DES@@QAEII_K@Z	; DES::f

; 431  : 		i++;

  00046	47		 inc	 edi
  00047	33 e8		 xor	 ebp, eax
  00049	83 c6 08	 add	 esi, 8
  0004c	83 ff 10	 cmp	 edi, 16			; 00000010H
  0004f	72 d2		 jb	 SHORT $LL2@Cipher@2

; 432  : 	}
; 433  : 
; 434  : 	//--------------
; 435  : 	//IP-1
; 436  : 	return(invIP(Data.l));

  00051	53		 push	 ebx
  00052	55		 push	 ebp
  00053	e8 00 00 00 00	 call	 ?invIP@DES@@QAE_K_K@Z	; DES::invIP

; 437  : 	
; 438  : }

  00058	5f		 pop	 edi
  00059	5e		 pop	 esi
  0005a	5d		 pop	 ebp
  0005b	5b		 pop	 ebx
  0005c	c2 0c 00	 ret	 12			; 0000000cH
?Cipher@DES@@QAE_K_K@Z ENDP				; DES::Cipher
; Function compile flags: /Ogtpy
;	COMDAT ?decrypt_ecb@DES@@UAEXPAX@Z
_TEXT	SEGMENT
_data$ = 8						; size = 4
?decrypt_ecb@DES@@UAEXPAX@Z PROC			; DES::decrypt_ecb, COMDAT
; _this$ = ecx

; 500  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 e4 f8	 and	 esp, -8			; fffffff8H
  00006	51		 push	 ecx
  00007	56		 push	 esi

; 501  : 	unsigned __int64*	iData = (unsigned __int64*)data;
; 502  : 
; 503  : 	*iData = InvCipher(*iData);

  00008	8b 75 08	 mov	 esi, DWORD PTR _data$[ebp]
  0000b	8b 46 04	 mov	 eax, DWORD PTR [esi+4]
  0000e	8b 16		 mov	 edx, DWORD PTR [esi]
  00010	50		 push	 eax
  00011	52		 push	 edx
  00012	51		 push	 ecx
  00013	e8 00 00 00 00	 call	 ?InvCipher@DES@@QAE_K_K@Z ; DES::InvCipher
  00018	89 06		 mov	 DWORD PTR [esi], eax
  0001a	89 56 04	 mov	 DWORD PTR [esi+4], edx

; 504  : }

  0001d	5e		 pop	 esi
  0001e	8b e5		 mov	 esp, ebp
  00020	5d		 pop	 ebp
  00021	c2 04 00	 ret	 4
?decrypt_ecb@DES@@UAEXPAX@Z ENDP			; DES::decrypt_ecb
; Function compile flags: /Ogtpy
_TEXT	ENDS
;	COMDAT ?encrypt_ecb@DES@@UAEXPAX@Z
_TEXT	SEGMENT
_data$ = 8						; size = 4
?encrypt_ecb@DES@@UAEXPAX@Z PROC			; DES::encrypt_ecb, COMDAT
; _this$ = ecx

; 486  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 e4 f8	 and	 esp, -8			; fffffff8H
  00006	51		 push	 ecx
  00007	56		 push	 esi

; 487  : 	unsigned __int64*	iData = (unsigned __int64*)data;
; 488  : 
; 489  : 	*iData = Cipher(*iData);

  00008	8b 75 08	 mov	 esi, DWORD PTR _data$[ebp]
  0000b	8b 46 04	 mov	 eax, DWORD PTR [esi+4]
  0000e	8b 16		 mov	 edx, DWORD PTR [esi]
  00010	50		 push	 eax
  00011	52		 push	 edx
  00012	51		 push	 ecx
  00013	e8 00 00 00 00	 call	 ?Cipher@DES@@QAE_K_K@Z	; DES::Cipher
  00018	89 06		 mov	 DWORD PTR [esi], eax
  0001a	89 56 04	 mov	 DWORD PTR [esi+4], edx

; 490  : }

  0001d	5e		 pop	 esi
  0001e	8b e5		 mov	 esp, ebp
  00020	5d		 pop	 ebp
  00021	c2 04 00	 ret	 4
?encrypt_ecb@DES@@UAEXPAX@Z ENDP			; DES::encrypt_ecb
PUBLIC	??1DES@@QAE@XZ					; DES::~DES
; Function compile flags: /Ogtpy
;	COMDAT ??1DES@@QAE@XZ
_TEXT	SEGMENT
??1DES@@QAE@XZ PROC					; DES::~DES, COMDAT
; _this$ = esi

; 27   : {

  00000	57		 push	 edi

; 28   : }

  00001	8d 7e 44	 lea	 edi, DWORD PTR [esi+68]
  00004	c7 06 00 00 00
	00		 mov	 DWORD PTR [esi], OFFSET ??_7AlgorithmIdentifier@@6B@
  0000a	c7 07 00 00 00
	00		 mov	 DWORD PTR [edi], OFFSET ??_7ObjectIdentifier@@6B@
  00010	8b 47 50	 mov	 eax, DWORD PTR [edi+80]
  00013	85 c0		 test	 eax, eax
  00015	74 09		 je	 SHORT $LN16@DES
  00017	50		 push	 eax
  00018	e8 00 00 00 00	 call	 ??3@YAXPAX@Z		; operator delete
  0001d	83 c4 04	 add	 esp, 4
$LN16@DES:
  00020	8b 47 44	 mov	 eax, DWORD PTR [edi+68]
  00023	50		 push	 eax
  00024	c7 47 50 00 00
	00 00		 mov	 DWORD PTR [edi+80], 0
  0002b	c7 47 54 00 00
	00 00		 mov	 DWORD PTR [edi+84], 0
  00032	c7 47 58 00 00
	00 00		 mov	 DWORD PTR [edi+88], 0
  00039	e8 00 00 00 00	 call	 ??3@YAXPAX@Z		; operator delete
  0003e	83 c4 04	 add	 esp, 4
  00041	e8 00 00 00 00	 call	 ??1ASN1@@QAE@XZ		; ASN1::~ASN1
  00046	8b fe		 mov	 edi, esi
  00048	c7 06 00 00 00
	00		 mov	 DWORD PTR [esi], OFFSET ??_7Sequence@@6B@
  0004e	e8 00 00 00 00	 call	 ??1ASN1@@QAE@XZ		; ASN1::~ASN1
  00053	5f		 pop	 edi
  00054	c3		 ret	 0
??1DES@@QAE@XZ ENDP					; DES::~DES
PUBLIC	??0DES@@QAE@QBD@Z				; DES::DES
; Function compile flags: /Ogtpy
;	COMDAT ??0DES@@QAE@QBD@Z
_TEXT	SEGMENT
??0DES@@QAE@QBD@Z PROC					; DES::DES, COMDAT
; _this$ = esi
; __strName$ = eax

; 14   : {

  00000	50		 push	 eax
  00001	56		 push	 esi
  00002	e8 00 00 00 00	 call	 ??0AlgorithmIdentifier@@QAE@QBD@Z ; AlgorithmIdentifier::AlgorithmIdentifier

; 15   : 	szBlock	= DES_BlockSize;

  00007	b8 08 00 00 00	 mov	 eax, 8
  0000c	89 86 a0 00 00
	00		 mov	 DWORD PTR [esi+160], eax

; 16   : 	szKey	= DES_KeySize;

  00012	89 86 a4 00 00
	00		 mov	 DWORD PTR [esi+164], eax
  00018	c7 06 00 00 00
	00		 mov	 DWORD PTR [esi], OFFSET ??_7DES@@6B@

; 17   : }

  0001e	8b c6		 mov	 eax, esi
  00020	c3		 ret	 0
??0DES@@QAE@QBD@Z ENDP					; DES::DES
END
