; Listing generated by Microsoft (R) Optimizing Compiler Version 15.00.30729.01 

	TITLE	i:\?n????j\My Project\CMS\CMS\ASN1\PKCS7\EnvelopedData.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB OLDNAMES

PUBLIC	??_R4EnvelopedData@@6B@				; EnvelopedData::`RTTI Complete Object Locator'
PUBLIC	??_R3EnvelopedData@@8				; EnvelopedData::`RTTI Class Hierarchy Descriptor'
PUBLIC	??_R2EnvelopedData@@8				; EnvelopedData::`RTTI Base Class Array'
PUBLIC	??_R1A@?0A@EA@EnvelopedData@@8			; EnvelopedData::`RTTI Base Class Descriptor at (0,-1,0,64)'
PUBLIC	??_R0?AVEnvelopedData@@@8			; EnvelopedData `RTTI Type Descriptor'
PUBLIC	??_C@_0P@EPGMMLJK@RecipientInfos?$AA@		; `string'
PUBLIC	??_7EnvelopedData@@6B@				; EnvelopedData::`vftable'
;	COMDAT ??_7EnvelopedData@@6B@
CONST	SEGMENT
??_7EnvelopedData@@6B@ DD FLAT:??_R4EnvelopedData@@6B@	; EnvelopedData::`vftable'
	DD	FLAT:?encodeBER@Sequence@@UAEXXZ
	DD	FLAT:?Get_BERcode@ASN1@@UAEPBDXZ
	DD	FLAT:?Get_BERsize@ASN1@@UAEIXZ
CONST	ENDS
;	COMDAT ??_R4EnvelopedData@@6B@
rdata$r	SEGMENT
??_R4EnvelopedData@@6B@ DD 00H				; EnvelopedData::`RTTI Complete Object Locator'
	DD	00H
	DD	00H
	DD	FLAT:??_R0?AVEnvelopedData@@@8
	DD	FLAT:??_R3EnvelopedData@@8
rdata$r	ENDS
;	COMDAT ??_R3EnvelopedData@@8
rdata$r	SEGMENT
??_R3EnvelopedData@@8 DD 00H				; EnvelopedData::`RTTI Class Hierarchy Descriptor'
	DD	00H
	DD	03H
	DD	FLAT:??_R2EnvelopedData@@8
rdata$r	ENDS
;	COMDAT ??_R2EnvelopedData@@8
rdata$r	SEGMENT
??_R2EnvelopedData@@8 DD FLAT:??_R1A@?0A@EA@EnvelopedData@@8 ; EnvelopedData::`RTTI Base Class Array'
	DD	FLAT:??_R1A@?0A@EA@Sequence@@8
	DD	FLAT:??_R1A@?0A@EA@ASN1@@8
rdata$r	ENDS
;	COMDAT ??_R1A@?0A@EA@EnvelopedData@@8
rdata$r	SEGMENT
??_R1A@?0A@EA@EnvelopedData@@8 DD FLAT:??_R0?AVEnvelopedData@@@8 ; EnvelopedData::`RTTI Base Class Descriptor at (0,-1,0,64)'
	DD	02H
	DD	00H
	DD	0ffffffffH
	DD	00H
	DD	040H
	DD	FLAT:??_R3EnvelopedData@@8
rdata$r	ENDS
;	COMDAT ??_R0?AVEnvelopedData@@@8
_DATA	SEGMENT
??_R0?AVEnvelopedData@@@8 DD FLAT:??_7type_info@@6B@	; EnvelopedData `RTTI Type Descriptor'
	DD	00H
	DB	'.?AVEnvelopedData@@', 00H
_DATA	ENDS
;	COMDAT ??_C@_0P@EPGMMLJK@RecipientInfos?$AA@
CONST	SEGMENT
??_C@_0P@EPGMMLJK@RecipientInfos?$AA@ DB 'RecipientInfos', 00H ; `string'
PUBLIC	??1EnvelopedData@@QAE@XZ			; EnvelopedData::~EnvelopedData
; Function compile flags: /Ogtpy
; File i:\ìnïîìƒéj\my project\cms\cms\asn1\pkcs7\envelopeddata.cpp
;	COMDAT ??1EnvelopedData@@QAE@XZ
_TEXT	SEGMENT
_this$ = 8						; size = 4
??1EnvelopedData@@QAE@XZ PROC				; EnvelopedData::~EnvelopedData, COMDAT

; 27   : {

  00000	51		 push	 ecx
  00001	53		 push	 ebx
  00002	8b 5c 24 0c	 mov	 ebx, DWORD PTR _this$[esp+4]
  00006	56		 push	 esi
  00007	57		 push	 edi

; 28   : }

  00008	8d b3 58 03 00
	00		 lea	 esi, DWORD PTR [ebx+856]
  0000e	c7 03 00 00 00
	00		 mov	 DWORD PTR [ebx], OFFSET ??_7EnvelopedData@@6B@
  00014	e8 00 00 00 00	 call	 ??1Context@@QAE@XZ	; Context::~Context
  00019	8d bb a8 02 00
	00		 lea	 edi, DWORD PTR [ebx+680]
  0001f	8d 77 4c	 lea	 esi, DWORD PTR [edi+76]
  00022	c7 07 00 00 00
	00		 mov	 DWORD PTR [edi], OFFSET ??_7EncryptedContentInfo@@6B@
  00028	e8 00 00 00 00	 call	 ??1Context@@QAE@XZ	; Context::~Context
  0002d	c7 07 00 00 00
	00		 mov	 DWORD PTR [edi], OFFSET ??_7Sequence@@6B@
  00033	e8 00 00 00 00	 call	 ??1ASN1@@QAE@XZ		; ASN1::~ASN1
  00038	8d 83 ec 00 00
	00		 lea	 eax, DWORD PTR [ebx+236]
  0003e	50		 push	 eax
  0003f	e8 00 00 00 00	 call	 ??1RecipientInfos@@QAE@XZ ; RecipientInfos::~RecipientInfos
  00044	8d b3 8c 00 00
	00		 lea	 esi, DWORD PTR [ebx+140]
  0004a	e8 00 00 00 00	 call	 ??1Context@@QAE@XZ	; Context::~Context
  0004f	8d 7b 44	 lea	 edi, DWORD PTR [ebx+68]
  00052	c7 07 00 00 00
	00		 mov	 DWORD PTR [edi], OFFSET ??_7Integer@@6B@
  00058	e8 00 00 00 00	 call	 ??1ASN1@@QAE@XZ		; ASN1::~ASN1
  0005d	8b fb		 mov	 edi, ebx
  0005f	c7 03 00 00 00
	00		 mov	 DWORD PTR [ebx], OFFSET ??_7Sequence@@6B@
  00065	e8 00 00 00 00	 call	 ??1ASN1@@QAE@XZ		; ASN1::~ASN1
  0006a	5f		 pop	 edi
  0006b	5e		 pop	 esi
  0006c	5b		 pop	 ebx
  0006d	59		 pop	 ecx
  0006e	c2 04 00	 ret	 4
??1EnvelopedData@@QAE@XZ ENDP				; EnvelopedData::~EnvelopedData
PUBLIC	?Set@EnvelopedData@@QAEXPAVObjectIdentifier@@PAVEncryption@@I@Z ; EnvelopedData::Set
; Function compile flags: /Ogtpy
;	COMDAT ?Set@EnvelopedData@@QAEXPAVObjectIdentifier@@PAVEncryption@@I@Z
_TEXT	SEGMENT
$T93084 = 8						; size = 4
$T93076 = 8						; size = 4
$T93072 = 8						; size = 4
$T93068 = 8						; size = 4
$T93060 = 8						; size = 4
_this$ = 8						; size = 4
__algorithm$ = 12					; size = 4
__szContent$ = 16					; size = 4
?Set@EnvelopedData@@QAEXPAVObjectIdentifier@@PAVEncryption@@I@Z PROC ; EnvelopedData::Set, COMDAT

; 45   : {

  00000	51		 push	 ecx
  00001	53		 push	 ebx
  00002	8b 5c 24 0c	 mov	 ebx, DWORD PTR _this$[esp+4]
  00006	56		 push	 esi
  00007	57		 push	 edi

; 46   : 	unsigned	int	iVersion;
; 47   : 
; 48   : 	//------
; 49   : 	//version CMSVersion
; 50   : //	if(originatorInfo.Constructed.size()>0){
; 51   : 		// or "pwri" or "ori" or ATTRv3 
; 52   : 		iVersion = 3;
; 53   : //	} else {
; 54   : //		if((originatorInfo.Constructed.size()==0) && (unprotectedAttrs.Constructed.size()==0)){
; 55   : //			//recipientInfos.version == 0
; 56   : //			iVersion = 0;
; 57   : //		} else {
; 58   : //			iVersion = 2;
; 59   : //		}
; 60   : //	}
; 61   : 	version.Set(iVersion);
; 62   : 	Set_Construct(&version);

  00008	8d 4c 24 14	 lea	 ecx, DWORD PTR $T93060[esp+12]
  0000c	8d 43 44	 lea	 eax, DWORD PTR [ebx+68]
  0000f	8d 7b 28	 lea	 edi, DWORD PTR [ebx+40]
  00012	51		 push	 ecx
  00013	c7 83 88 00 00
	00 03 00 00 00	 mov	 DWORD PTR [ebx+136], 3
  0001d	89 44 24 18	 mov	 DWORD PTR $T93060[esp+16], eax
  00021	e8 00 00 00 00	 call	 ?push_back@?$vector@PAVASN1@@V?$allocator@PAVASN1@@@std@@@std@@QAEXABQAVASN1@@@Z ; std::vector<ASN1 *,std::allocator<ASN1 *> >::push_back

; 63   : 
; 64   : 	//------
; 65   : 	//originatorInfo [0] IMPLICIT OriginatorInfo OPTIONAL,
; 66   : 	if(originatorInfo.Constructed.size() > 0){

  00026	8b 93 c4 00 00
	00		 mov	 edx, DWORD PTR [ebx+196]
  0002c	2b 93 c0 00 00
	00		 sub	 edx, DWORD PTR [ebx+192]
  00032	c1 fa 02	 sar	 edx, 2
  00035	85 d2		 test	 edx, edx
  00037	76 14		 jbe	 SHORT $LN11@Set@2

; 67   : 		Set_Construct(&originatorInfo);

  00039	8d 4c 24 14	 lea	 ecx, DWORD PTR $T93068[esp+12]
  0003d	8d 83 8c 00 00
	00		 lea	 eax, DWORD PTR [ebx+140]
  00043	51		 push	 ecx
  00044	89 44 24 18	 mov	 DWORD PTR $T93068[esp+16], eax
  00048	e8 00 00 00 00	 call	 ?push_back@?$vector@PAVASN1@@V?$allocator@PAVASN1@@@std@@@std@@QAEXABQAVASN1@@@Z ; std::vector<ASN1 *,std::allocator<ASN1 *> >::push_back
$LN11@Set@2:

; 68   : 	}
; 69   : 
; 70   : 	//------
; 71   : 	//recipientInfos RecipientInfos,
; 72   : 	Set_Construct(&recipientInfos);

  0004d	8d 44 24 14	 lea	 eax, DWORD PTR $T93072[esp+12]
  00051	8d 93 ec 00 00
	00		 lea	 edx, DWORD PTR [ebx+236]
  00057	50		 push	 eax
  00058	89 54 24 18	 mov	 DWORD PTR $T93072[esp+16], edx
  0005c	e8 00 00 00 00	 call	 ?push_back@?$vector@PAVASN1@@V?$allocator@PAVASN1@@@std@@@std@@QAEXABQAVASN1@@@Z ; std::vector<ASN1 *,std::allocator<ASN1 *> >::push_back

; 73   : 
; 74   : 	//------
; 75   : 	//encryptedContentInfo EncryptedContentInfo
; 76   : 	encryptedContentInfo.Set(_type, _algorithm, _szContent);

  00061	8b 4c 24 1c	 mov	 ecx, DWORD PTR __szContent$[esp+12]
  00065	8b 54 24 18	 mov	 edx, DWORD PTR __algorithm$[esp+12]
  00069	51		 push	 ecx
  0006a	8d b3 a8 02 00
	00		 lea	 esi, DWORD PTR [ebx+680]
  00070	52		 push	 edx
  00071	b8 00 00 00 00	 mov	 eax, OFFSET ?contentType@?1??encrypt@@YAXXZ@4VObjectIdentifier@@A
  00076	e8 00 00 00 00	 call	 ?Set@EncryptedContentInfo@@QAEXPAVObjectIdentifier@@PAVEncryption@@I@Z ; EncryptedContentInfo::Set

; 77   : 	Set_Construct(&encryptedContentInfo);

  0007b	8d 44 24 14	 lea	 eax, DWORD PTR $T93076[esp+12]
  0007f	50		 push	 eax
  00080	89 74 24 18	 mov	 DWORD PTR $T93076[esp+16], esi
  00084	e8 00 00 00 00	 call	 ?push_back@?$vector@PAVASN1@@V?$allocator@PAVASN1@@@std@@@std@@QAEXABQAVASN1@@@Z ; std::vector<ASN1 *,std::allocator<ASN1 *> >::push_back

; 78   : 
; 79   : 	//------
; 80   : 	//unprotectedAttrs [1] IMPLICIT UnprotectedAttributes OPTIONAL
; 81   : 	if(unprotectedAttrs.Constructed.size() > 0){

  00089	8b 8b 90 03 00
	00		 mov	 ecx, DWORD PTR [ebx+912]
  0008f	2b 8b 8c 03 00
	00		 sub	 ecx, DWORD PTR [ebx+908]
  00095	c1 f9 02	 sar	 ecx, 2
  00098	85 c9		 test	 ecx, ecx
  0009a	76 14		 jbe	 SHORT $LN19@Set@2

; 82   : 		//	to do	ëÆê´èÓïÒÇì¸ÇÍÇÈèÍçáÇÃèàóùÅB
; 83   : 		Set_Construct(&unprotectedAttrs);

  0009c	8d 54 24 14	 lea	 edx, DWORD PTR $T93084[esp+12]
  000a0	81 c3 58 03 00
	00		 add	 ebx, 856		; 00000358H
  000a6	52		 push	 edx
  000a7	89 5c 24 18	 mov	 DWORD PTR $T93084[esp+16], ebx
  000ab	e8 00 00 00 00	 call	 ?push_back@?$vector@PAVASN1@@V?$allocator@PAVASN1@@@std@@@std@@QAEXABQAVASN1@@@Z ; std::vector<ASN1 *,std::allocator<ASN1 *> >::push_back
$LN19@Set@2:

; 84   : 	}
; 85   : }

  000b0	5f		 pop	 edi
  000b1	5e		 pop	 esi
  000b2	5b		 pop	 ebx
  000b3	59		 pop	 ecx
  000b4	c2 0c 00	 ret	 12			; 0000000cH
?Set@EnvelopedData@@QAEXPAVObjectIdentifier@@PAVEncryption@@I@Z ENDP ; EnvelopedData::Set
PUBLIC	??0EnvelopedData@@QAE@QBD@Z			; EnvelopedData::EnvelopedData
;	COMDAT xdata$x
; File i:\ìnïîìƒéj\my project\cms\cms\asn1\integer.cpp
xdata$x	SEGMENT
__unwindtable$??0EnvelopedData@@QAE@QBD@Z DD 0ffffffffH
	DD	FLAT:__unwindfunclet$??0EnvelopedData@@QAE@QBD@Z$0
	DD	00H
	DD	FLAT:__unwindfunclet$??0EnvelopedData@@QAE@QBD@Z$1
	DD	01H
	DD	FLAT:__unwindfunclet$??0EnvelopedData@@QAE@QBD@Z$2
	DD	02H
	DD	FLAT:__unwindfunclet$??0EnvelopedData@@QAE@QBD@Z$3
	DD	03H
	DD	FLAT:__unwindfunclet$??0EnvelopedData@@QAE@QBD@Z$4
__ehfuncinfo$??0EnvelopedData@@QAE@QBD@Z DD 019930522H
	DD	05H
	DD	FLAT:__unwindtable$??0EnvelopedData@@QAE@QBD@Z
	DD	2 DUP(00H)
	DD	2 DUP(00H)
	DD	00H
	DD	01H
; Function compile flags: /Ogtpy
; File i:\ìnïîìƒéj\my project\cms\cms\asn1\pkcs7\envelopeddata.cpp
xdata$x	ENDS
;	COMDAT ??0EnvelopedData@@QAE@QBD@Z
_TEXT	SEGMENT
__$EHRec$ = -12						; size = 12
_this$ = 8						; size = 4
??0EnvelopedData@@QAE@QBD@Z PROC			; EnvelopedData::EnvelopedData, COMDAT

; 16   : {

  00000	6a ff		 push	 -1
  00002	68 00 00 00 00	 push	 __ehhandler$??0EnvelopedData@@QAE@QBD@Z
  00007	64 a1 00 00 00
	00		 mov	 eax, DWORD PTR fs:0
  0000d	50		 push	 eax
  0000e	56		 push	 esi
  0000f	57		 push	 edi
  00010	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  00015	33 c4		 xor	 eax, esp
  00017	50		 push	 eax
  00018	8d 44 24 0c	 lea	 eax, DWORD PTR __$EHRec$[esp+24]
  0001c	64 a3 00 00 00
	00		 mov	 DWORD PTR fs:0, eax
  00022	8b 74 24 1c	 mov	 esi, DWORD PTR _this$[esp+20]
  00026	68 00 00 00 00	 push	 OFFSET ??_C@_0O@FKPCDGLE@EnvelopedData?$AA@
  0002b	56		 push	 esi
  0002c	e8 00 00 00 00	 call	 ??0ASN1@@QAE@QBD@Z	; ASN1::ASN1
  00031	68 00 00 00 00	 push	 OFFSET ??_C@_07EDADKEAH@Integer?$AA@
  00036	8d 7e 44	 lea	 edi, DWORD PTR [esi+68]
  00039	c7 44 24 18 00
	00 00 00	 mov	 DWORD PTR __$EHRec$[esp+36], 0
  00041	57		 push	 edi
  00042	c7 06 00 00 00
	00		 mov	 DWORD PTR [esi], OFFSET ??_7EnvelopedData@@6B@
  00048	e8 00 00 00 00	 call	 ??0ASN1@@QAE@QBD@Z	; ASN1::ASN1
  0004d	c7 07 00 00 00
	00		 mov	 DWORD PTR [edi], OFFSET ??_7Integer@@6B@
  00053	6a 00		 push	 0
  00055	8d 86 8c 00 00
	00		 lea	 eax, DWORD PTR [esi+140]
  0005b	50		 push	 eax
  0005c	c6 44 24 1c 01	 mov	 BYTE PTR __$EHRec$[esp+40], 1
  00061	e8 00 00 00 00	 call	 ??0Context@@QAE@IQBD@Z	; Context::Context
  00066	8d 8e ec 00 00
	00		 lea	 ecx, DWORD PTR [esi+236]
  0006c	51		 push	 ecx
  0006d	c6 44 24 18 02	 mov	 BYTE PTR __$EHRec$[esp+36], 2
  00072	e8 00 00 00 00	 call	 ??0RecipientInfos@@QAE@QBD@Z ; RecipientInfos::RecipientInfos
  00077	8d 96 a8 02 00
	00		 lea	 edx, DWORD PTR [esi+680]
  0007d	52		 push	 edx
  0007e	c6 44 24 18 03	 mov	 BYTE PTR __$EHRec$[esp+36], 3
  00083	e8 00 00 00 00	 call	 ??0EncryptedContentInfo@@QAE@QBD@Z ; EncryptedContentInfo::EncryptedContentInfo
  00088	6a 01		 push	 1
  0008a	8d 86 58 03 00
	00		 lea	 eax, DWORD PTR [esi+856]
  00090	50		 push	 eax
  00091	c6 44 24 1c 04	 mov	 BYTE PTR __$EHRec$[esp+40], 4
  00096	e8 00 00 00 00	 call	 ??0Context@@QAE@IQBD@Z	; Context::Context

; 17   : }

  0009b	8b c6		 mov	 eax, esi
  0009d	8b 4c 24 0c	 mov	 ecx, DWORD PTR __$EHRec$[esp+24]
  000a1	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  000a8	59		 pop	 ecx
  000a9	5f		 pop	 edi
  000aa	5e		 pop	 esi
  000ab	83 c4 0c	 add	 esp, 12			; 0000000cH
  000ae	c2 04 00	 ret	 4
_TEXT	ENDS
;	COMDAT text$x
text$x	SEGMENT
__unwindfunclet$??0EnvelopedData@@QAE@QBD@Z$0:
  00000	8b 45 04	 mov	 eax, DWORD PTR _this$[ebp-4]
  00003	e9 00 00 00 00	 jmp	 ??1Sequence@@QAE@XZ	; Sequence::~Sequence
__unwindfunclet$??0EnvelopedData@@QAE@QBD@Z$1:
  00008	8b 45 04	 mov	 eax, DWORD PTR _this$[ebp-4]
  0000b	83 c0 44	 add	 eax, 68			; 00000044H
  0000e	e9 00 00 00 00	 jmp	 ??1Integer@@QAE@XZ	; Integer::~Integer
__unwindfunclet$??0EnvelopedData@@QAE@QBD@Z$2:
  00013	8b 75 04	 mov	 esi, DWORD PTR _this$[ebp-4]
  00016	81 c6 8c 00 00
	00		 add	 esi, 140		; 0000008cH
  0001c	e9 00 00 00 00	 jmp	 ??1Context@@QAE@XZ	; Context::~Context
__unwindfunclet$??0EnvelopedData@@QAE@QBD@Z$3:
  00021	8b 45 04	 mov	 eax, DWORD PTR _this$[ebp-4]
  00024	05 ec 00 00 00	 add	 eax, 236		; 000000ecH
  00029	50		 push	 eax
  0002a	e8 00 00 00 00	 call	 ??1RecipientInfos@@QAE@XZ ; RecipientInfos::~RecipientInfos
  0002f	c3		 ret	 0
__unwindfunclet$??0EnvelopedData@@QAE@QBD@Z$4:
  00030	8b 45 04	 mov	 eax, DWORD PTR _this$[ebp-4]
  00033	05 a8 02 00 00	 add	 eax, 680		; 000002a8H
  00038	e9 00 00 00 00	 jmp	 ??1EncryptedContentInfo@@QAE@XZ ; EncryptedContentInfo::~EncryptedContentInfo
__ehhandler$??0EnvelopedData@@QAE@QBD@Z:
  0003d	8b 54 24 08	 mov	 edx, DWORD PTR [esp+8]
  00041	8d 42 f8	 lea	 eax, DWORD PTR [edx-8]
  00044	8b 4a f4	 mov	 ecx, DWORD PTR [edx-12]
  00047	33 c8		 xor	 ecx, eax
  00049	e8 00 00 00 00	 call	 @__security_check_cookie@4
  0004e	b8 00 00 00 00	 mov	 eax, OFFSET __ehfuncinfo$??0EnvelopedData@@QAE@QBD@Z
  00053	e9 00 00 00 00	 jmp	 ___CxxFrameHandler3
text$x	ENDS
??0EnvelopedData@@QAE@QBD@Z ENDP			; EnvelopedData::EnvelopedData
END
