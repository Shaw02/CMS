; Listing generated by Microsoft (R) Optimizing Compiler Version 15.00.30729.01 

	TITLE	i:\?n????j\My Project\CMS\CMS\ASN1\PKCS7\PKCS7_3_Output.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB OLDNAMES

PUBLIC	??_R4PKCS7_3_Output@@6BBER_Output@@@		; PKCS7_3_Output::`RTTI Complete Object Locator'
PUBLIC	??_R4PKCS7_3_Output@@6BPKCS7@@@			; PKCS7_3_Output::`RTTI Complete Object Locator'
PUBLIC	??_R3PKCS7_3_Output@@8				; PKCS7_3_Output::`RTTI Class Hierarchy Descriptor'
PUBLIC	??_R2PKCS7_3_Output@@8				; PKCS7_3_Output::`RTTI Base Class Array'
PUBLIC	??_R1A@?0A@EA@PKCS7_Output@@8			; PKCS7_Output::`RTTI Base Class Descriptor at (0,-1,0,64)'
PUBLIC	??_R3PKCS7_Output@@8				; PKCS7_Output::`RTTI Class Hierarchy Descriptor'
PUBLIC	??_R2PKCS7_Output@@8				; PKCS7_Output::`RTTI Base Class Array'
PUBLIC	??_R1DNA@?0A@EA@?$basic_ostream@DU?$char_traits@D@std@@@std@@8 ; std::basic_ostream<char,std::char_traits<char> >::`RTTI Base Class Descriptor at (976,-1,0,64)'
PUBLIC	??_R1DNA@?0A@EA@?$basic_ofstream@DU?$char_traits@D@std@@@std@@8 ; std::basic_ofstream<char,std::char_traits<char> >::`RTTI Base Class Descriptor at (976,-1,0,64)'
PUBLIC	??_R1DNA@?0A@EA@FileOutput@@8			; FileOutput::`RTTI Base Class Descriptor at (976,-1,0,64)'
PUBLIC	??_R1DNA@?0A@EA@BER_Output@@8			; BER_Output::`RTTI Base Class Descriptor at (976,-1,0,64)'
PUBLIC	??_R0?AVPKCS7_Output@@@8			; PKCS7_Output `RTTI Type Descriptor'
PUBLIC	??_R1A@?0A@EA@PKCS7_3_Output@@8			; PKCS7_3_Output::`RTTI Base Class Descriptor at (0,-1,0,64)'
PUBLIC	??_R0?AVPKCS7_3_Output@@@8			; PKCS7_3_Output `RTTI Type Descriptor'
PUBLIC	??_DPKCS7_3_Output@@QAEXXZ			; PKCS7_3_Output::`vbase destructor'
PUBLIC	??_GPKCS7_3_Output@@UAEPAXI@Z			; PKCS7_3_Output::`scalar deleting destructor'
PUBLIC	??_7PKCS7_3_Output@@6BPKCS7@@@			; PKCS7_3_Output::`vftable'
PUBLIC	??_7PKCS7_3_Output@@6BBER_Output@@@		; PKCS7_3_Output::`vftable'
PUBLIC	??_8PKCS7_3_Output@@7B@				; PKCS7_3_Output::`vbtable'
EXTRN	??_EPKCS7_3_Output@@UAEPAXI@Z:PROC		; PKCS7_3_Output::`vector deleting destructor'
;	COMDAT ??_8PKCS7_3_Output@@7B@
CONST	SEGMENT
??_8PKCS7_3_Output@@7B@ DD 00H				; PKCS7_3_Output::`vbtable'
	DD	0470H
CONST	ENDS
;	COMDAT ??_7PKCS7_3_Output@@6BBER_Output@@@
CONST	SEGMENT
??_7PKCS7_3_Output@@6BBER_Output@@@ DD FLAT:??_R4PKCS7_3_Output@@6BBER_Output@@@ ; PKCS7_3_Output::`vftable'
	DD	FLAT:??_EPKCS7_3_Output@@UAEPAXI@Z
CONST	ENDS
;	COMDAT ??_R4PKCS7_3_Output@@6BBER_Output@@@
rdata$r	SEGMENT
??_R4PKCS7_3_Output@@6BBER_Output@@@ DD 00H		; PKCS7_3_Output::`RTTI Complete Object Locator'
	DD	0840H
	DD	00H
	DD	FLAT:??_R0?AVPKCS7_3_Output@@@8
	DD	FLAT:??_R3PKCS7_3_Output@@8
rdata$r	ENDS
;	COMDAT ??_7PKCS7_3_Output@@6BPKCS7@@@
CONST	SEGMENT
??_7PKCS7_3_Output@@6BPKCS7@@@ DD FLAT:??_R4PKCS7_3_Output@@6BPKCS7@@@ ; PKCS7_3_Output::`vftable'
	DD	FLAT:?encodeBER@Sequence@@UAEXXZ
	DD	FLAT:?Get_BERcode@ASN1@@UAEPBDXZ
	DD	FLAT:?Get_BERsize@ASN1@@UAEIXZ
CONST	ENDS
;	COMDAT ??_R4PKCS7_3_Output@@6BPKCS7@@@
rdata$r	SEGMENT
??_R4PKCS7_3_Output@@6BPKCS7@@@ DD 00H			; PKCS7_3_Output::`RTTI Complete Object Locator'
	DD	00H
	DD	00H
	DD	FLAT:??_R0?AVPKCS7_3_Output@@@8
	DD	FLAT:??_R3PKCS7_3_Output@@8
rdata$r	ENDS
;	COMDAT ??_R3PKCS7_3_Output@@8
rdata$r	SEGMENT
??_R3PKCS7_3_Output@@8 DD 00H				; PKCS7_3_Output::`RTTI Class Hierarchy Descriptor'
	DD	03H
	DD	0dH
	DD	FLAT:??_R2PKCS7_3_Output@@8
rdata$r	ENDS
;	COMDAT ??_R2PKCS7_3_Output@@8
rdata$r	SEGMENT
??_R2PKCS7_3_Output@@8 DD FLAT:??_R1A@?0A@EA@PKCS7_3_Output@@8 ; PKCS7_3_Output::`RTTI Base Class Array'
	DD	FLAT:??_R1A@?0A@EA@PKCS7_Output@@8
	DD	FLAT:??_R1DNA@?0A@EA@BER_Output@@8
	DD	FLAT:??_R1DNA@?0A@EA@FileOutput@@8
	DD	FLAT:??_R1DNA@?0A@EA@?$basic_ofstream@DU?$char_traits@D@std@@@std@@8
	DD	FLAT:??_R1DNA@?0A@EA@?$basic_ostream@DU?$char_traits@D@std@@@std@@8
	DD	FLAT:??_R1A@DNA@3FA@?$basic_ios@DU?$char_traits@D@std@@@std@@8
	DD	FLAT:??_R1A@DNA@3EA@ios_base@std@@8
	DD	FLAT:??_R13DNA@3EA@?$_Iosb@H@std@@8
	DD	FLAT:??_R1A@?0A@EA@PKCS7@@8
	DD	FLAT:??_R1A@?0A@EA@ContentInfo@@8
	DD	FLAT:??_R1A@?0A@EA@Sequence@@8
	DD	FLAT:??_R1A@?0A@EA@ASN1@@8
rdata$r	ENDS
;	COMDAT ??_R1A@?0A@EA@PKCS7_Output@@8
rdata$r	SEGMENT
??_R1A@?0A@EA@PKCS7_Output@@8 DD FLAT:??_R0?AVPKCS7_Output@@@8 ; PKCS7_Output::`RTTI Base Class Descriptor at (0,-1,0,64)'
	DD	0bH
	DD	00H
	DD	0ffffffffH
	DD	00H
	DD	040H
	DD	FLAT:??_R3PKCS7_Output@@8
rdata$r	ENDS
;	COMDAT ??_R3PKCS7_Output@@8
rdata$r	SEGMENT
??_R3PKCS7_Output@@8 DD 00H				; PKCS7_Output::`RTTI Class Hierarchy Descriptor'
	DD	03H
	DD	0cH
	DD	FLAT:??_R2PKCS7_Output@@8
rdata$r	ENDS
;	COMDAT ??_R2PKCS7_Output@@8
rdata$r	SEGMENT
??_R2PKCS7_Output@@8 DD FLAT:??_R1A@?0A@EA@PKCS7_Output@@8 ; PKCS7_Output::`RTTI Base Class Array'
	DD	FLAT:??_R1DNA@?0A@EA@BER_Output@@8
	DD	FLAT:??_R1DNA@?0A@EA@FileOutput@@8
	DD	FLAT:??_R1DNA@?0A@EA@?$basic_ofstream@DU?$char_traits@D@std@@@std@@8
	DD	FLAT:??_R1DNA@?0A@EA@?$basic_ostream@DU?$char_traits@D@std@@@std@@8
	DD	FLAT:??_R1A@DNA@3FA@?$basic_ios@DU?$char_traits@D@std@@@std@@8
	DD	FLAT:??_R1A@DNA@3EA@ios_base@std@@8
	DD	FLAT:??_R13DNA@3EA@?$_Iosb@H@std@@8
	DD	FLAT:??_R1A@?0A@EA@PKCS7@@8
	DD	FLAT:??_R1A@?0A@EA@ContentInfo@@8
	DD	FLAT:??_R1A@?0A@EA@Sequence@@8
	DD	FLAT:??_R1A@?0A@EA@ASN1@@8
rdata$r	ENDS
;	COMDAT ??_R1DNA@?0A@EA@?$basic_ostream@DU?$char_traits@D@std@@@std@@8
rdata$r	SEGMENT
??_R1DNA@?0A@EA@?$basic_ostream@DU?$char_traits@D@std@@@std@@8 DD FLAT:??_R0?AV?$basic_ostream@DU?$char_traits@D@std@@@std@@@8 ; std::basic_ostream<char,std::char_traits<char> >::`RTTI Base Class Descriptor at (976,-1,0,64)'
	DD	03H
	DD	03d0H
	DD	0ffffffffH
	DD	00H
	DD	040H
	DD	FLAT:??_R3?$basic_ostream@DU?$char_traits@D@std@@@std@@8
rdata$r	ENDS
;	COMDAT ??_R1DNA@?0A@EA@?$basic_ofstream@DU?$char_traits@D@std@@@std@@8
rdata$r	SEGMENT
??_R1DNA@?0A@EA@?$basic_ofstream@DU?$char_traits@D@std@@@std@@8 DD FLAT:??_R0?AV?$basic_ofstream@DU?$char_traits@D@std@@@std@@@8 ; std::basic_ofstream<char,std::char_traits<char> >::`RTTI Base Class Descriptor at (976,-1,0,64)'
	DD	04H
	DD	03d0H
	DD	0ffffffffH
	DD	00H
	DD	040H
	DD	FLAT:??_R3?$basic_ofstream@DU?$char_traits@D@std@@@std@@8
rdata$r	ENDS
;	COMDAT ??_R1DNA@?0A@EA@FileOutput@@8
rdata$r	SEGMENT
??_R1DNA@?0A@EA@FileOutput@@8 DD FLAT:??_R0?AVFileOutput@@@8 ; FileOutput::`RTTI Base Class Descriptor at (976,-1,0,64)'
	DD	05H
	DD	03d0H
	DD	0ffffffffH
	DD	00H
	DD	040H
	DD	FLAT:??_R3FileOutput@@8
rdata$r	ENDS
;	COMDAT ??_R1DNA@?0A@EA@BER_Output@@8
rdata$r	SEGMENT
??_R1DNA@?0A@EA@BER_Output@@8 DD FLAT:??_R0?AVBER_Output@@@8 ; BER_Output::`RTTI Base Class Descriptor at (976,-1,0,64)'
	DD	06H
	DD	03d0H
	DD	0ffffffffH
	DD	00H
	DD	040H
	DD	FLAT:??_R3BER_Output@@8
rdata$r	ENDS
;	COMDAT ??_R0?AVPKCS7_Output@@@8
_DATA	SEGMENT
??_R0?AVPKCS7_Output@@@8 DD FLAT:??_7type_info@@6B@	; PKCS7_Output `RTTI Type Descriptor'
	DD	00H
	DB	'.?AVPKCS7_Output@@', 00H
_DATA	ENDS
;	COMDAT ??_R1A@?0A@EA@PKCS7_3_Output@@8
rdata$r	SEGMENT
??_R1A@?0A@EA@PKCS7_3_Output@@8 DD FLAT:??_R0?AVPKCS7_3_Output@@@8 ; PKCS7_3_Output::`RTTI Base Class Descriptor at (0,-1,0,64)'
	DD	0cH
	DD	00H
	DD	0ffffffffH
	DD	00H
	DD	040H
	DD	FLAT:??_R3PKCS7_3_Output@@8
rdata$r	ENDS
;	COMDAT ??_R0?AVPKCS7_3_Output@@@8
_DATA	SEGMENT
??_R0?AVPKCS7_3_Output@@@8 DD FLAT:??_7type_info@@6B@	; PKCS7_3_Output `RTTI Type Descriptor'
	DD	00H
	DB	'.?AVPKCS7_3_Output@@', 00H
PUBLIC	?MakeEncryption@PKCS7_3_Output@@QAEXI@Z		; PKCS7_3_Output::MakeEncryption
; Function compile flags: /Ogtpy
; File i:\渡部篤史\my project\cms\cms\asn1\pkcs7\pkcs7_3_output.cpp
;	COMDAT ?MakeEncryption@PKCS7_3_Output@@QAEXI@Z
_TEXT	SEGMENT
?MakeEncryption@PKCS7_3_Output@@QAEXI@Z PROC		; PKCS7_3_Output::MakeEncryption, COMDAT
; _this$ = edi
; _mode$ = eax

; 64   : {

  00000	51		 push	 ecx
  00001	53		 push	 ebx
  00002	56		 push	 esi

; 65   : 	unsigned	char*	_CEK;
; 66   : 
; 67   : 	//------------------
; 68   : 	//暗号モジュールの取得
; 69   : 	cCE = Get_Encryption(mode);

  00003	50		 push	 eax
  00004	e8 00 00 00 00	 call	 ?Get_Encryption@PKCS7@@QAEPAVEncryption@@I@Z ; PKCS7::Get_Encryption
  00009	89 87 dc 07 00
	00		 mov	 DWORD PTR [edi+2012], eax

; 70   : 
; 71   : 	//------------------
; 72   : 	//セッション鍵は乱数より自動生成
; 73   : 	_CEK	= new unsigned char [(cCE->szKey<32)?32:cCE->szKey];

  0000f	8b 80 a4 00 00
	00		 mov	 eax, DWORD PTR [eax+164]
  00015	83 f8 20	 cmp	 eax, 32			; 00000020H
  00018	73 05		 jae	 SHORT $LN3@MakeEncryp
  0001a	b8 20 00 00 00	 mov	 eax, 32			; 00000020H
$LN3@MakeEncryp:
  0001f	50		 push	 eax
  00020	e8 00 00 00 00	 call	 ??_U@YAPAXI@Z		; operator new[]
  00025	8b f0		 mov	 esi, eax

; 74   : 	cRandom->get256(_CEK);

  00027	a1 00 00 00 00	 mov	 eax, DWORD PTR ?cRandom@@3PAVMT_SHA@@A ; cRandom
  0002c	83 c4 04	 add	 esp, 4
  0002f	50		 push	 eax
  00030	8b d8		 mov	 ebx, eax
  00032	e8 00 00 00 00	 call	 ?generate@MT_SHA@@QAEXXZ ; MT_SHA::generate
  00037	8b 93 c4 09 00
	00		 mov	 edx, DWORD PTR [ebx+2500]
  0003d	8b 42 14	 mov	 eax, DWORD PTR [edx+20]
  00040	8d 8b c4 09 00
	00		 lea	 ecx, DWORD PTR [ebx+2500]
  00046	56		 push	 esi
  00047	ff d0		 call	 eax

; 75   : 	CEK.Set((char *)_CEK, cCE->szKey);

  00049	8b 8f dc 07 00
	00		 mov	 ecx, DWORD PTR [edi+2012]
  0004f	8b 91 a4 00 00
	00		 mov	 edx, DWORD PTR [ecx+164]
  00055	52		 push	 edx
  00056	56		 push	 esi
  00057	8d 8f 24 08 00
	00		 lea	 ecx, DWORD PTR [edi+2084]
  0005d	e8 00 00 00 00	 call	 ?assign@?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QAEAAV12@PBDI@Z ; std::basic_string<char,std::char_traits<char>,std::allocator<char> >::assign

; 76   : 	delete	_CEK;

  00062	56		 push	 esi
  00063	e8 00 00 00 00	 call	 ??3@YAXPAX@Z		; operator delete
  00068	83 c4 04	 add	 esp, 4

; 77   : }

  0006b	5e		 pop	 esi
  0006c	5b		 pop	 ebx
  0006d	59		 pop	 ecx
  0006e	c3		 ret	 0
?MakeEncryption@PKCS7_3_Output@@QAEXI@Z ENDP		; PKCS7_3_Output::MakeEncryption
PUBLIC	?AddRecipient@PKCS7_3_Output@@QAEXPAV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@II@Z ; PKCS7_3_Output::AddRecipient
; Function compile flags: /Ogtpy
;	COMDAT ?AddRecipient@PKCS7_3_Output@@QAEXPAV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@II@Z
_TEXT	SEGMENT
_strPassword$ = 8					; size = 4
_count$ = 12						; size = 4
?AddRecipient@PKCS7_3_Output@@QAEXPAV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@II@Z PROC ; PKCS7_3_Output::AddRecipient, COMDAT
; _this$ = eax
; _mode$ = ecx

; 96   : 	//------------------
; 97   : 	//鍵導出
; 98   : 	enveloped_data.recipientInfos.AddRecipient(strPassword, &CEK, &cHMAC_SHA256, count, mode);

  00000	8b 54 24 08	 mov	 edx, DWORD PTR _count$[esp-4]
  00004	57		 push	 edi
  00005	51		 push	 ecx
  00006	52		 push	 edx
  00007	8d 88 e0 02 00
	00		 lea	 ecx, DWORD PTR [eax+736]
  0000d	51		 push	 ecx
  0000e	8b 4c 24 14	 mov	 ecx, DWORD PTR _strPassword$[esp+12]
  00012	8d 90 e0 07 00
	00		 lea	 edx, DWORD PTR [eax+2016]
  00018	52		 push	 edx
  00019	51		 push	 ecx
  0001a	8d b8 10 05 00
	00		 lea	 edi, DWORD PTR [eax+1296]
  00020	e8 00 00 00 00	 call	 ?AddRecipient@RecipientInfos@@QAEXPAV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@PAVOctetString@@PAVHMAC@@II@Z ; RecipientInfos::AddRecipient

; 99   : }

  00025	5f		 pop	 edi
  00026	c2 08 00	 ret	 8
?AddRecipient@PKCS7_3_Output@@QAEXPAV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@II@Z ENDP ; PKCS7_3_Output::AddRecipient
_TEXT	ENDS
PUBLIC	?Set_EnvelopedData@PKCS7_3_Output@@QAEXPAVObjectIdentifier@@PAVEncryption@@I@Z ; PKCS7_3_Output::Set_EnvelopedData
; Function compile flags: /Ogtpy
;	COMDAT ?Set_EnvelopedData@PKCS7_3_Output@@QAEXPAVObjectIdentifier@@PAVEncryption@@I@Z
_TEXT	SEGMENT
$T96886 = -4						; size = 4
?Set_EnvelopedData@PKCS7_3_Output@@QAEXPAVObjectIdentifier@@PAVEncryption@@I@Z PROC ; PKCS7_3_Output::Set_EnvelopedData, COMDAT
; _this$ = esi
; __algorithm$ = ecx
; __szContent$ = eax

; 45   : {

  00000	83 ec 08	 sub	 esp, 8
  00003	57		 push	 edi

; 46   : 	//------
; 47   : 	//処理
; 48   : 	enveloped_data.Set(_type, _algorithm, _szContent);

  00004	50		 push	 eax
  00005	51		 push	 ecx
  00006	8d be 24 04 00
	00		 lea	 edi, DWORD PTR [esi+1060]
  0000c	57		 push	 edi
  0000d	e8 00 00 00 00	 call	 ?Set@EnvelopedData@@QAEXPAVObjectIdentifier@@PAVEncryption@@I@Z ; EnvelopedData::Set

; 49   : 	context.Set_Construct(&enveloped_data);		//ContentInfoクラスのmember

  00012	8d 54 24 08	 lea	 edx, DWORD PTR $T96886[esp+12]
  00016	89 7c 24 08	 mov	 DWORD PTR $T96886[esp+12], edi
  0001a	52		 push	 edx
  0001b	8d be c8 00 00
	00		 lea	 edi, DWORD PTR [esi+200]
  00021	e8 00 00 00 00	 call	 ?push_back@?$vector@PAVASN1@@V?$allocator@PAVASN1@@@std@@@std@@QAEXABQAVASN1@@@Z ; std::vector<ASN1 *,std::allocator<ASN1 *> >::push_back

; 50   : 	Set_Type(EnvelopedData_type);

  00026	6a 03		 push	 3
  00028	56		 push	 esi
  00029	e8 00 00 00 00	 call	 ?Set_Type@PKCS7@@QAEXI@Z ; PKCS7::Set_Type

; 51   : }

  0002e	5f		 pop	 edi
  0002f	83 c4 08	 add	 esp, 8
  00032	c3		 ret	 0
?Set_EnvelopedData@PKCS7_3_Output@@QAEXPAVObjectIdentifier@@PAVEncryption@@I@Z ENDP ; PKCS7_3_Output::Set_EnvelopedData
PUBLIC	??1PKCS7_3_Output@@UAE@XZ			; PKCS7_3_Output::~PKCS7_3_Output
; Function compile flags: /Ogtpy
;	COMDAT ??1PKCS7_3_Output@@UAE@XZ
_TEXT	SEGMENT
??1PKCS7_3_Output@@UAE@XZ PROC				; PKCS7_3_Output::~PKCS7_3_Output, COMDAT
; _this$ = eax

; 25   : {

  00000	56		 push	 esi
  00001	8b f0		 mov	 esi, eax
  00003	8b 86 90 fb ff
	ff		 mov	 eax, DWORD PTR [esi-1136]
  00009	c7 86 c0 f7 ff
	ff 00 00 00 00	 mov	 DWORD PTR [esi-2112], OFFSET ??_7PKCS7_3_Output@@6BPKCS7@@@
  00013	8b 48 04	 mov	 ecx, DWORD PTR [eax+4]
  00016	57		 push	 edi

; 26   : }

  00017	8d 7e a0	 lea	 edi, DWORD PTR [esi-96]
  0001a	c7 84 31 90 fb
	ff ff 00 00 00
	00		 mov	 DWORD PTR [ecx+esi-1136], OFFSET ??_7PKCS7_3_Output@@6BBER_Output@@@
  00025	c7 07 00 00 00
	00		 mov	 DWORD PTR [edi], OFFSET ??_7OctetString@@6B@
  0002b	83 7f 5c 10	 cmp	 DWORD PTR [edi+92], 16	; 00000010H
  0002f	72 0c		 jb	 SHORT $LN24@PKCS7_3_Ou
  00031	8b 57 48	 mov	 edx, DWORD PTR [edi+72]
  00034	52		 push	 edx
  00035	e8 00 00 00 00	 call	 ??3@YAXPAX@Z		; operator delete
  0003a	83 c4 04	 add	 esp, 4
$LN24@PKCS7_3_Ou:
  0003d	33 c0		 xor	 eax, eax
  0003f	c7 47 5c 0f 00
	00 00		 mov	 DWORD PTR [edi+92], 15	; 0000000fH
  00046	89 47 58	 mov	 DWORD PTR [edi+88], eax
  00049	88 47 48	 mov	 BYTE PTR [edi+72], al
  0004c	e8 00 00 00 00	 call	 ??1ASN1@@QAE@XZ		; ASN1::~ASN1
  00051	81 c6 e4 fb ff
	ff		 add	 esi, -1052		; fffffbe4H
  00057	56		 push	 esi
  00058	e8 00 00 00 00	 call	 ??1EnvelopedData@@QAE@XZ ; EnvelopedData::~EnvelopedData
  0005d	56		 push	 esi
  0005e	e8 00 00 00 00	 call	 ??1PKCS7_Output@@UAE@XZ	; PKCS7_Output::~PKCS7_Output
  00063	5f		 pop	 edi
  00064	5e		 pop	 esi
  00065	c3		 ret	 0
??1PKCS7_3_Output@@UAE@XZ ENDP				; PKCS7_3_Output::~PKCS7_3_Output
; Function compile flags: /Ogtpy
_TEXT	ENDS
;	COMDAT ??_DPKCS7_3_Output@@QAEXXZ
_TEXT	SEGMENT
??_DPKCS7_3_Output@@QAEXXZ PROC				; PKCS7_3_Output::`vbase destructor', COMDAT
; _this$ = eax
  00000	56		 push	 esi
  00001	8b f0		 mov	 esi, eax
  00003	81 c6 40 08 00
	00		 add	 esi, 2112		; 00000840H
  00009	8b c6		 mov	 eax, esi
  0000b	e8 00 00 00 00	 call	 ??1PKCS7_3_Output@@UAE@XZ ; PKCS7_3_Output::~PKCS7_3_Output
  00010	56		 push	 esi
  00011	c7 06 00 00 00
	00		 mov	 DWORD PTR [esi], OFFSET ??_7ios_base@std@@6B@
  00017	e8 00 00 00 00	 call	 ?_Ios_base_dtor@ios_base@std@@CAXPAV12@@Z ; std::ios_base::_Ios_base_dtor
  0001c	83 c4 04	 add	 esp, 4
  0001f	5e		 pop	 esi
  00020	c3		 ret	 0
??_DPKCS7_3_Output@@QAEXXZ ENDP				; PKCS7_3_Output::`vbase destructor'
; Function compile flags: /Ogtpy
_TEXT	ENDS
;	COMDAT ??_GPKCS7_3_Output@@UAEPAXI@Z
_TEXT	SEGMENT
___flags$ = 8						; size = 4
??_GPKCS7_3_Output@@UAEPAXI@Z PROC			; PKCS7_3_Output::`scalar deleting destructor', COMDAT
; _this$ = ecx
  00000	56		 push	 esi
  00001	57		 push	 edi
  00002	8d b9 c0 f7 ff
	ff		 lea	 edi, DWORD PTR [ecx-2112]
  00008	8d b7 40 08 00
	00		 lea	 esi, DWORD PTR [edi+2112]
  0000e	8b c6		 mov	 eax, esi
  00010	e8 00 00 00 00	 call	 ??1PKCS7_3_Output@@UAE@XZ ; PKCS7_3_Output::~PKCS7_3_Output
  00015	56		 push	 esi
  00016	c7 06 00 00 00
	00		 mov	 DWORD PTR [esi], OFFSET ??_7ios_base@std@@6B@
  0001c	e8 00 00 00 00	 call	 ?_Ios_base_dtor@ios_base@std@@CAXPAV12@@Z ; std::ios_base::_Ios_base_dtor
  00021	83 c4 04	 add	 esp, 4
  00024	f6 44 24 0c 01	 test	 BYTE PTR ___flags$[esp+4], 1
  00029	74 09		 je	 SHORT $LN11@scalar@33
  0002b	57		 push	 edi
  0002c	e8 00 00 00 00	 call	 ??3@YAXPAX@Z		; operator delete
  00031	83 c4 04	 add	 esp, 4
$LN11@scalar@33:
  00034	8b c7		 mov	 eax, edi
  00036	5f		 pop	 edi
  00037	5e		 pop	 esi
  00038	c2 04 00	 ret	 4
??_GPKCS7_3_Output@@UAEPAXI@Z ENDP			; PKCS7_3_Output::`scalar deleting destructor'
PUBLIC	??0PKCS7_3_Output@@QAE@PBD@Z			; PKCS7_3_Output::PKCS7_3_Output
;	COMDAT xdata$x
; File c:\program files\microsoft visual studio 9.0\vc\include\iosfwd
xdata$x	SEGMENT
__unwindtable$??0PKCS7_3_Output@@QAE@PBD@Z DD 0ffffffffH
	DD	FLAT:__unwindfunclet$??0PKCS7_3_Output@@QAE@PBD@Z$0
	DD	00H
	DD	FLAT:__unwindfunclet$??0PKCS7_3_Output@@QAE@PBD@Z$1
	DD	01H
	DD	FLAT:__unwindfunclet$??0PKCS7_3_Output@@QAE@PBD@Z$2
__ehfuncinfo$??0PKCS7_3_Output@@QAE@PBD@Z DD 019930522H
	DD	03H
	DD	FLAT:__unwindtable$??0PKCS7_3_Output@@QAE@PBD@Z
	DD	2 DUP(00H)
	DD	2 DUP(00H)
	DD	00H
	DD	01H
; Function compile flags: /Ogtpy
; File i:\渡部篤史\my project\cms\cms\asn1\pkcs7\pkcs7_3_output.cpp
xdata$x	ENDS
;	COMDAT ??0PKCS7_3_Output@@QAE@PBD@Z
_TEXT	SEGMENT
$T100869 = -16						; size = 4
__$EHRec$ = -12						; size = 12
_this$ = 8						; size = 4
_strFileName$ = 12					; size = 4
??0PKCS7_3_Output@@QAE@PBD@Z PROC			; PKCS7_3_Output::PKCS7_3_Output, COMDAT

; 14   : {

  00000	6a ff		 push	 -1
  00002	68 00 00 00 00	 push	 __ehhandler$??0PKCS7_3_Output@@QAE@PBD@Z
  00007	64 a1 00 00 00
	00		 mov	 eax, DWORD PTR fs:0
  0000d	50		 push	 eax
  0000e	83 ec 08	 sub	 esp, 8
  00011	53		 push	 ebx
  00012	56		 push	 esi
  00013	57		 push	 edi
  00014	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  00019	33 c4		 xor	 eax, esp
  0001b	50		 push	 eax
  0001c	8d 44 24 18	 lea	 eax, DWORD PTR __$EHRec$[esp+36]
  00020	64 a3 00 00 00
	00		 mov	 DWORD PTR fs:0, eax
  00026	8b 74 24 28	 mov	 esi, DWORD PTR _this$[esp+32]
  0002a	33 db		 xor	 ebx, ebx
  0002c	89 5c 24 14	 mov	 DWORD PTR $T100869[esp+36], ebx
  00030	c7 86 d0 03 00
	00 00 00 00 00	 mov	 DWORD PTR [esi+976], OFFSET ??_8PKCS7_3_Output@@7B@
  0003a	c7 86 40 08 00
	00 00 00 00 00	 mov	 DWORD PTR [esi+2112], OFFSET ??_7?$basic_ios@DU?$char_traits@D@std@@@std@@6B@
  00044	8b 44 24 2c	 mov	 eax, DWORD PTR _strFileName$[esp+32]
  00048	50		 push	 eax
  00049	89 5c 24 24	 mov	 DWORD PTR __$EHRec$[esp+48], ebx
  0004d	bf 01 00 00 00	 mov	 edi, 1
  00052	56		 push	 esi
  00053	89 7c 24 1c	 mov	 DWORD PTR $T100869[esp+44], edi
  00057	e8 00 00 00 00	 call	 ??0PKCS7_Output@@QAE@PBDQBD@Z ; PKCS7_Output::PKCS7_Output
  0005c	89 7c 24 20	 mov	 DWORD PTR __$EHRec$[esp+44], edi
  00060	8b 8e d0 03 00
	00		 mov	 ecx, DWORD PTR [esi+976]
  00066	c7 06 00 00 00
	00		 mov	 DWORD PTR [esi], OFFSET ??_7PKCS7_3_Output@@6BPKCS7@@@
  0006c	8b 51 04	 mov	 edx, DWORD PTR [ecx+4]
  0006f	8d 86 24 04 00
	00		 lea	 eax, DWORD PTR [esi+1060]
  00075	50		 push	 eax
  00076	c7 84 32 d0 03
	00 00 00 00 00
	00		 mov	 DWORD PTR [edx+esi+976], OFFSET ??_7PKCS7_3_Output@@6BBER_Output@@@
  00081	e8 00 00 00 00	 call	 ??0EnvelopedData@@QAE@QBD@Z ; EnvelopedData::EnvelopedData
  00086	68 00 00 00 00	 push	 OFFSET ??_C@_0N@DHPBPBEA@Octet?5String?$AA@
  0008b	8d be e0 07 00
	00		 lea	 edi, DWORD PTR [esi+2016]
  00091	57		 push	 edi
  00092	c6 44 24 28 02	 mov	 BYTE PTR __$EHRec$[esp+52], 2
  00097	e8 00 00 00 00	 call	 ??0ASN1@@QAE@QBD@Z	; ASN1::ASN1
  0009c	c7 07 00 00 00
	00		 mov	 DWORD PTR [edi], OFFSET ??_7OctetString@@6B@
  000a2	c7 47 5c 0f 00
	00 00		 mov	 DWORD PTR [edi+92], 15	; 0000000fH
  000a9	89 5f 58	 mov	 DWORD PTR [edi+88], ebx
  000ac	88 5f 48	 mov	 BYTE PTR [edi+72], bl

; 15   : }

  000af	8b c6		 mov	 eax, esi
  000b1	8b 4c 24 18	 mov	 ecx, DWORD PTR __$EHRec$[esp+36]
  000b5	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  000bc	59		 pop	 ecx
  000bd	5f		 pop	 edi
  000be	5e		 pop	 esi
  000bf	5b		 pop	 ebx
  000c0	83 c4 14	 add	 esp, 20			; 00000014H
  000c3	c2 08 00	 ret	 8
_TEXT	ENDS
;	COMDAT text$x
text$x	SEGMENT
__unwindfunclet$??0PKCS7_3_Output@@QAE@PBD@Z$0:
  00000	8b 45 f0	 mov	 eax, DWORD PTR $T100869[ebp]
  00003	83 e0 01	 and	 eax, 1
  00006	0f 84 12 00 00
	00		 je	 $LN5@PKCS7_3_Ou@2
  0000c	83 65 f0 fe	 and	 DWORD PTR $T100869[ebp], -2 ; fffffffeH
  00010	8b 4d 04	 mov	 ecx, DWORD PTR _this$[ebp-4]
  00013	81 c1 40 08 00
	00		 add	 ecx, 2112		; 00000840H
  00019	e9 00 00 00 00	 jmp	 ??1?$basic_ios@DU?$char_traits@D@std@@@std@@UAE@XZ ; std::basic_ios<char,std::char_traits<char> >::~basic_ios<char,std::char_traits<char> >
$LN5@PKCS7_3_Ou@2:
  0001e	c3		 ret	 0
__unwindfunclet$??0PKCS7_3_Output@@QAE@PBD@Z$1:
  0001f	8b 45 04	 mov	 eax, DWORD PTR _this$[ebp-4]
  00022	05 24 04 00 00	 add	 eax, 1060		; 00000424H
  00027	50		 push	 eax
  00028	e8 00 00 00 00	 call	 ??1PKCS7_Output@@UAE@XZ	; PKCS7_Output::~PKCS7_Output
  0002d	c3		 ret	 0
__unwindfunclet$??0PKCS7_3_Output@@QAE@PBD@Z$2:
  0002e	8b 45 04	 mov	 eax, DWORD PTR _this$[ebp-4]
  00031	05 24 04 00 00	 add	 eax, 1060		; 00000424H
  00036	50		 push	 eax
  00037	e8 00 00 00 00	 call	 ??1EnvelopedData@@QAE@XZ ; EnvelopedData::~EnvelopedData
  0003c	c3		 ret	 0
__ehhandler$??0PKCS7_3_Output@@QAE@PBD@Z:
  0003d	8b 54 24 08	 mov	 edx, DWORD PTR [esp+8]
  00041	8d 42 ec	 lea	 eax, DWORD PTR [edx-20]
  00044	8b 4a e8	 mov	 ecx, DWORD PTR [edx-24]
  00047	33 c8		 xor	 ecx, eax
  00049	e8 00 00 00 00	 call	 @__security_check_cookie@4
  0004e	b8 00 00 00 00	 mov	 eax, OFFSET __ehfuncinfo$??0PKCS7_3_Output@@QAE@PBD@Z
  00053	e9 00 00 00 00	 jmp	 ___CxxFrameHandler3
text$x	ENDS
??0PKCS7_3_Output@@QAE@PBD@Z ENDP			; PKCS7_3_Output::PKCS7_3_Output
PUBLIC	?encrypt@PKCS7_3_Output@@QAEXPAVFileInput@@PAVObjectIdentifier@@@Z ; PKCS7_3_Output::encrypt
; Function compile flags: /Ogtpy
;	COMDAT ?encrypt@PKCS7_3_Output@@QAEXPAVFileInput@@PAVObjectIdentifier@@@Z
_TEXT	SEGMENT
$T101407 = 8						; size = 4
_f_Plain$ = 8						; size = 4
?encrypt@PKCS7_3_Output@@QAEXPAVFileInput@@PAVObjectIdentifier@@@Z PROC ; PKCS7_3_Output::encrypt, COMDAT
; _this$ = eax

; 116  : {

  00000	53		 push	 ebx
  00001	55		 push	 ebp
  00002	8b 6c 24 0c	 mov	 ebp, DWORD PTR _f_Plain$[esp+4]
  00006	56		 push	 esi
  00007	8b f0		 mov	 esi, eax
  00009	57		 push	 edi

; 117  : 
; 118  : 	//------------------
; 119  : 	//PKCS#7-3 のオブジェクト作成
; 120  : 	Set_EnvelopedData(contentType, cCE, f_Plain->GetSize());

  0000a	8b c5		 mov	 eax, ebp
  0000c	e8 00 00 00 00	 call	 ?GetSize@FileInput@@QAEIXZ ; FileInput::GetSize
  00011	50		 push	 eax
  00012	8b 86 dc 07 00
	00		 mov	 eax, DWORD PTR [esi+2012]
  00018	50		 push	 eax
  00019	8d be 24 04 00
	00		 lea	 edi, DWORD PTR [esi+1060]
  0001f	57		 push	 edi
  00020	e8 00 00 00 00	 call	 ?Set@EnvelopedData@@QAEXPAVObjectIdentifier@@PAVEncryption@@I@Z ; EnvelopedData::Set
  00025	8d 4c 24 14	 lea	 ecx, DWORD PTR $T101407[esp+12]
  00029	89 7c 24 14	 mov	 DWORD PTR $T101407[esp+12], edi
  0002d	51		 push	 ecx
  0002e	8d be c8 00 00
	00		 lea	 edi, DWORD PTR [esi+200]
  00034	e8 00 00 00 00	 call	 ?push_back@?$vector@PAVASN1@@V?$allocator@PAVASN1@@@std@@@std@@QAEXABQAVASN1@@@Z ; std::vector<ASN1 *,std::allocator<ASN1 *> >::push_back
  00039	6a 03		 push	 3
  0003b	56		 push	 esi
  0003c	e8 00 00 00 00	 call	 ?Set_Type@PKCS7@@QAEXI@Z ; PKCS7::Set_Type

; 121  : 
; 122  : 	//------------------
; 123  : 	//暗号ファイルの出力
; 124  : 
; 125  : 	//暗号文本体まで
; 126  : 	write_header();

  00041	8b 16		 mov	 edx, DWORD PTR [esi]
  00043	8b 02		 mov	 eax, DWORD PTR [edx]
  00045	8b ce		 mov	 ecx, esi
  00047	ff d0		 call	 eax
  00049	8b 16		 mov	 edx, DWORD PTR [esi]
  0004b	8b 42 08	 mov	 eax, DWORD PTR [edx+8]
  0004e	8b ce		 mov	 ecx, esi
  00050	ff d0		 call	 eax
  00052	8b 16		 mov	 edx, DWORD PTR [esi]
  00054	8b d8		 mov	 ebx, eax
  00056	8b 42 04	 mov	 eax, DWORD PTR [edx+4]
  00059	8b ce		 mov	 ecx, esi
  0005b	ff d0		 call	 eax
  0005d	53		 push	 ebx
  0005e	50		 push	 eax
  0005f	8d be d0 03 00
	00		 lea	 edi, DWORD PTR [esi+976]
  00065	57		 push	 edi
  00066	e8 00 00 00 00	 call	 ?write@?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV12@PBDH@Z ; std::basic_ostream<char,std::char_traits<char> >::write

; 127  : 
; 128  : 	//暗号文本体
; 129  : 	enveloped_data.encryptedContentInfo.encrypt((unsigned char*)CEK.strValue.c_str(), f_Plain, this);

  0006b	83 be 3c 08 00
	00 10		 cmp	 DWORD PTR [esi+2108], 16 ; 00000010H
  00072	72 08		 jb	 SHORT $LN17@encrypt@4
  00074	8b 96 28 08 00
	00		 mov	 edx, DWORD PTR [esi+2088]
  0007a	eb 06		 jmp	 SHORT $LN18@encrypt@4
$LN17@encrypt@4:
  0007c	8d 96 28 08 00
	00		 lea	 edx, DWORD PTR [esi+2088]
$LN18@encrypt@4:
  00082	57		 push	 edi
  00083	81 c6 cc 06 00
	00		 add	 esi, 1740		; 000006ccH
  00089	8b fd		 mov	 edi, ebp
  0008b	e8 00 00 00 00	 call	 ?encrypt@EncryptedContentInfo@@QAEHPAEPAVFileInput@@PAVFileOutput@@@Z ; EncryptedContentInfo::encrypt

; 130  : }

  00090	5f		 pop	 edi
  00091	5e		 pop	 esi
  00092	5d		 pop	 ebp
  00093	5b		 pop	 ebx
  00094	c2 04 00	 ret	 4
?encrypt@PKCS7_3_Output@@QAEXPAVFileInput@@PAVObjectIdentifier@@@Z ENDP ; PKCS7_3_Output::encrypt
END
