; Listing generated by Microsoft (R) Optimizing Compiler Version 15.00.30729.01 

	TITLE	i:\?n????j\My Project\CMS\CMS\ASN1\PKCS7\EncryptedContentInfo.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB OLDNAMES

PUBLIC	??_R4EncryptedContentInfo@@6B@			; EncryptedContentInfo::`RTTI Complete Object Locator'
PUBLIC	??_R3EncryptedContentInfo@@8			; EncryptedContentInfo::`RTTI Class Hierarchy Descriptor'
PUBLIC	??_R2EncryptedContentInfo@@8			; EncryptedContentInfo::`RTTI Base Class Array'
PUBLIC	??_R1A@?0A@EA@EncryptedContentInfo@@8		; EncryptedContentInfo::`RTTI Base Class Descriptor at (0,-1,0,64)'
PUBLIC	??_R0?AVEncryptedContentInfo@@@8		; EncryptedContentInfo `RTTI Type Descriptor'
PUBLIC	??_7EncryptedContentInfo@@6B@			; EncryptedContentInfo::`vftable'
;	COMDAT ??_7EncryptedContentInfo@@6B@
CONST	SEGMENT
??_7EncryptedContentInfo@@6B@ DD FLAT:??_R4EncryptedContentInfo@@6B@ ; EncryptedContentInfo::`vftable'
	DD	FLAT:?encodeBER@Sequence@@UAEXXZ
	DD	FLAT:?Get_BERcode@ASN1@@UAEPBDXZ
	DD	FLAT:?Get_BERsize@ASN1@@UAEIXZ
CONST	ENDS
;	COMDAT ??_R4EncryptedContentInfo@@6B@
rdata$r	SEGMENT
??_R4EncryptedContentInfo@@6B@ DD 00H			; EncryptedContentInfo::`RTTI Complete Object Locator'
	DD	00H
	DD	00H
	DD	FLAT:??_R0?AVEncryptedContentInfo@@@8
	DD	FLAT:??_R3EncryptedContentInfo@@8
rdata$r	ENDS
;	COMDAT ??_R3EncryptedContentInfo@@8
rdata$r	SEGMENT
??_R3EncryptedContentInfo@@8 DD 00H			; EncryptedContentInfo::`RTTI Class Hierarchy Descriptor'
	DD	00H
	DD	03H
	DD	FLAT:??_R2EncryptedContentInfo@@8
rdata$r	ENDS
;	COMDAT ??_R2EncryptedContentInfo@@8
rdata$r	SEGMENT
??_R2EncryptedContentInfo@@8 DD FLAT:??_R1A@?0A@EA@EncryptedContentInfo@@8 ; EncryptedContentInfo::`RTTI Base Class Array'
	DD	FLAT:??_R1A@?0A@EA@Sequence@@8
	DD	FLAT:??_R1A@?0A@EA@ASN1@@8
rdata$r	ENDS
;	COMDAT ??_R1A@?0A@EA@EncryptedContentInfo@@8
rdata$r	SEGMENT
??_R1A@?0A@EA@EncryptedContentInfo@@8 DD FLAT:??_R0?AVEncryptedContentInfo@@@8 ; EncryptedContentInfo::`RTTI Base Class Descriptor at (0,-1,0,64)'
	DD	02H
	DD	00H
	DD	0ffffffffH
	DD	00H
	DD	040H
	DD	FLAT:??_R3EncryptedContentInfo@@8
rdata$r	ENDS
;	COMDAT ??_R0?AVEncryptedContentInfo@@@8
_DATA	SEGMENT
??_R0?AVEncryptedContentInfo@@@8 DD FLAT:??_7type_info@@6B@ ; EncryptedContentInfo `RTTI Type Descriptor'
	DD	00H
	DB	'.?AVEncryptedContentInfo@@', 00H
PUBLIC	??1EncryptedContentInfo@@QAE@XZ			; EncryptedContentInfo::~EncryptedContentInfo
; Function compile flags: /Ogtpy
; File i:\渡部篤史\my project\cms\cms\asn1\pkcs7\encryptedcontentinfo.cpp
;	COMDAT ??1EncryptedContentInfo@@QAE@XZ
_TEXT	SEGMENT
??1EncryptedContentInfo@@QAE@XZ PROC			; EncryptedContentInfo::~EncryptedContentInfo, COMDAT
; _this$ = eax

; 26   : {

  00000	51		 push	 ecx
  00001	56		 push	 esi
  00002	57		 push	 edi
  00003	8b f8		 mov	 edi, eax

; 27   : }

  00005	8d 77 4c	 lea	 esi, DWORD PTR [edi+76]
  00008	c7 07 00 00 00
	00		 mov	 DWORD PTR [edi], OFFSET ??_7EncryptedContentInfo@@6B@
  0000e	e8 00 00 00 00	 call	 ??1Context@@QAE@XZ	; Context::~Context
  00013	c7 07 00 00 00
	00		 mov	 DWORD PTR [edi], OFFSET ??_7Sequence@@6B@
  00019	e8 00 00 00 00	 call	 ??1ASN1@@QAE@XZ		; ASN1::~ASN1
  0001e	5f		 pop	 edi
  0001f	5e		 pop	 esi
  00020	59		 pop	 ecx
  00021	c3		 ret	 0
??1EncryptedContentInfo@@QAE@XZ ENDP			; EncryptedContentInfo::~EncryptedContentInfo
PUBLIC	?Set@EncryptedContentInfo@@QAEXPAVObjectIdentifier@@PAVEncryption@@I@Z ; EncryptedContentInfo::Set
; Function compile flags: /Ogtpy
;	COMDAT ?Set@EncryptedContentInfo@@QAEXPAVObjectIdentifier@@PAVEncryption@@I@Z
_TEXT	SEGMENT
__algorithm$ = 8					; size = 4
$T84281 = 12						; size = 4
$T84273 = 12						; size = 4
$T84269 = 12						; size = 4
__szContent$ = 12					; size = 4
?Set@EncryptedContentInfo@@QAEXPAVObjectIdentifier@@PAVEncryption@@I@Z PROC ; EncryptedContentInfo::Set, COMDAT
; _this$ = esi
; __type$ = eax

; 42   : {

  00000	53		 push	 ebx
  00001	8b 5c 24 0c	 mov	 ebx, DWORD PTR __szContent$[esp]
  00005	55		 push	 ebp
  00006	8b 6c 24 0c	 mov	 ebp, DWORD PTR __algorithm$[esp+4]
  0000a	57		 push	 edi

; 43   : 	//contentType ContentType
; 44   : 	contentType	= _type;

  0000b	89 46 44	 mov	 DWORD PTR [esi+68], eax

; 45   : 	Set_Construct(contentType);

  0000e	89 44 24 14	 mov	 DWORD PTR $T84269[esp+8], eax
  00012	8d 44 24 14	 lea	 eax, DWORD PTR $T84269[esp+8]
  00016	8d 7e 28	 lea	 edi, DWORD PTR [esi+40]
  00019	50		 push	 eax
  0001a	e8 00 00 00 00	 call	 ?push_back@?$vector@PAVASN1@@V?$allocator@PAVASN1@@@std@@@std@@QAEXABQAVASN1@@@Z ; std::vector<ASN1 *,std::allocator<ASN1 *> >::push_back

; 46   : 
; 47   : 	//contentEncryptionAlgorithm ContentEncryptionAlgorithmIdentifier
; 48   : 	contentEncryptionAlgorithm = _algorithm;
; 49   : 	Set_Construct(contentEncryptionAlgorithm);

  0001f	8d 4c 24 14	 lea	 ecx, DWORD PTR $T84273[esp+8]
  00023	51		 push	 ecx
  00024	89 6e 48	 mov	 DWORD PTR [esi+72], ebp
  00027	89 6c 24 18	 mov	 DWORD PTR $T84273[esp+12], ebp
  0002b	e8 00 00 00 00	 call	 ?push_back@?$vector@PAVASN1@@V?$allocator@PAVASN1@@@std@@@std@@QAEXABQAVASN1@@@Z ; std::vector<ASN1 *,std::allocator<ASN1 *> >::push_back

; 50   : 
; 51   : 	//encryptedContent [0] IMPLICIT EncryptedContent OPTIONAL
; 52   : 	encryptedContent.Set_ExternalDataSize(_szContent - (_szContent % _algorithm->szBlock) + _algorithm->szBlock);

  00030	8b 8d a0 00 00
	00		 mov	 ecx, DWORD PTR [ebp+160]
  00036	33 d2		 xor	 edx, edx
  00038	8b c3		 mov	 eax, ebx
  0003a	f7 f1		 div	 ecx

; 53   : 	Set_Construct(&encryptedContent);

  0003c	8d 44 24 14	 lea	 eax, DWORD PTR $T84281[esp+8]
  00040	50		 push	 eax
  00041	2b ca		 sub	 ecx, edx
  00043	03 cb		 add	 ecx, ebx
  00045	8d 56 4c	 lea	 edx, DWORD PTR [esi+76]
  00048	89 8e 8c 00 00
	00		 mov	 DWORD PTR [esi+140], ecx
  0004e	89 54 24 18	 mov	 DWORD PTR $T84281[esp+12], edx
  00052	e8 00 00 00 00	 call	 ?push_back@?$vector@PAVASN1@@V?$allocator@PAVASN1@@@std@@@std@@QAEXABQAVASN1@@@Z ; std::vector<ASN1 *,std::allocator<ASN1 *> >::push_back

; 54   : 
; 55   : 	szContent = _szContent;
; 56   : }

  00057	5f		 pop	 edi
  00058	5d		 pop	 ebp
  00059	89 9e ac 00 00
	00		 mov	 DWORD PTR [esi+172], ebx
  0005f	5b		 pop	 ebx
  00060	c2 08 00	 ret	 8
?Set@EncryptedContentInfo@@QAEXPAVObjectIdentifier@@PAVEncryption@@I@Z ENDP ; EncryptedContentInfo::Set
PUBLIC	??0EncryptedContentInfo@@QAE@QBD@Z		; EncryptedContentInfo::EncryptedContentInfo
;	COMDAT xdata$x
; File i:\渡部篤史\my project\cms\cms\asn1\sequence.cpp
xdata$x	SEGMENT
__unwindtable$??0EncryptedContentInfo@@QAE@QBD@Z DD 0ffffffffH
	DD	FLAT:__unwindfunclet$??0EncryptedContentInfo@@QAE@QBD@Z$0
__ehfuncinfo$??0EncryptedContentInfo@@QAE@QBD@Z DD 019930522H
	DD	01H
	DD	FLAT:__unwindtable$??0EncryptedContentInfo@@QAE@QBD@Z
	DD	2 DUP(00H)
	DD	2 DUP(00H)
	DD	00H
	DD	01H
; Function compile flags: /Ogtpy
; File i:\渡部篤史\my project\cms\cms\asn1\pkcs7\encryptedcontentinfo.cpp
xdata$x	ENDS
;	COMDAT ??0EncryptedContentInfo@@QAE@QBD@Z
_TEXT	SEGMENT
__$EHRec$ = -12						; size = 12
_this$ = 8						; size = 4
??0EncryptedContentInfo@@QAE@QBD@Z PROC			; EncryptedContentInfo::EncryptedContentInfo, COMDAT

; 15   : {

  00000	6a ff		 push	 -1
  00002	68 00 00 00 00	 push	 __ehhandler$??0EncryptedContentInfo@@QAE@QBD@Z
  00007	64 a1 00 00 00
	00		 mov	 eax, DWORD PTR fs:0
  0000d	50		 push	 eax
  0000e	51		 push	 ecx
  0000f	56		 push	 esi
  00010	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  00015	33 c4		 xor	 eax, esp
  00017	50		 push	 eax
  00018	8d 44 24 0c	 lea	 eax, DWORD PTR __$EHRec$[esp+24]
  0001c	64 a3 00 00 00
	00		 mov	 DWORD PTR fs:0, eax
  00022	8b 74 24 1c	 mov	 esi, DWORD PTR _this$[esp+20]
  00026	68 00 00 00 00	 push	 OFFSET ??_C@_0BF@HAHHLCNG@EncryptedContentInfo?$AA@
  0002b	56		 push	 esi
  0002c	e8 00 00 00 00	 call	 ??0ASN1@@QAE@QBD@Z	; ASN1::ASN1
  00031	6a 00		 push	 0
  00033	8d 46 4c	 lea	 eax, DWORD PTR [esi+76]
  00036	c7 44 24 18 00
	00 00 00	 mov	 DWORD PTR __$EHRec$[esp+36], 0
  0003e	50		 push	 eax
  0003f	c7 06 00 00 00
	00		 mov	 DWORD PTR [esi], OFFSET ??_7EncryptedContentInfo@@6B@
  00045	e8 00 00 00 00	 call	 ??0Context@@QAE@IQBD@Z	; Context::Context

; 16   : }

  0004a	8b c6		 mov	 eax, esi
  0004c	8b 4c 24 0c	 mov	 ecx, DWORD PTR __$EHRec$[esp+24]
  00050	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  00057	59		 pop	 ecx
  00058	5e		 pop	 esi
  00059	83 c4 10	 add	 esp, 16			; 00000010H
  0005c	c2 04 00	 ret	 4
_TEXT	ENDS
;	COMDAT text$x
text$x	SEGMENT
__unwindfunclet$??0EncryptedContentInfo@@QAE@QBD@Z$0:
  00000	8b 45 04	 mov	 eax, DWORD PTR _this$[ebp-4]
  00003	e9 00 00 00 00	 jmp	 ??1Sequence@@QAE@XZ	; Sequence::~Sequence
__ehhandler$??0EncryptedContentInfo@@QAE@QBD@Z:
  00008	8b 54 24 08	 mov	 edx, DWORD PTR [esp+8]
  0000c	8d 42 f8	 lea	 eax, DWORD PTR [edx-8]
  0000f	8b 4a f4	 mov	 ecx, DWORD PTR [edx-12]
  00012	33 c8		 xor	 ecx, eax
  00014	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00019	b8 00 00 00 00	 mov	 eax, OFFSET __ehfuncinfo$??0EncryptedContentInfo@@QAE@QBD@Z
  0001e	e9 00 00 00 00	 jmp	 ___CxxFrameHandler3
text$x	ENDS
??0EncryptedContentInfo@@QAE@QBD@Z ENDP			; EncryptedContentInfo::EncryptedContentInfo
PUBLIC	?decrypt@EncryptedContentInfo@@QAEHPAEPAVFileInput@@PAVFileOutput@@@Z ; EncryptedContentInfo::decrypt
;	COMDAT ?Buff@?1??decrypt@EncryptedContentInfo@@QAEHPAEPAVFileInput@@PAVFileOutput@@@Z@4T<unnamed-type-Buff>@?1??12@QAEH012@Z@A
; File c:\program files\microsoft visual studio 9.0\vc\include\istream
_BSS	SEGMENT
?Buff@?1??decrypt@EncryptedContentInfo@@QAEHPAEPAVFileInput@@PAVFileOutput@@@Z@4T<unnamed-type-Buff>@?1??12@QAEH012@Z@A DB 0800H DUP (?) ; `EncryptedContentInfo::decrypt'::`2'::Buff
; Function compile flags: /Ogtpy
; File i:\渡部篤史\my project\cms\cms\asn1\pkcs7\encryptedcontentinfo.cpp
_BSS	ENDS
;	COMDAT ?decrypt@EncryptedContentInfo@@QAEHPAEPAVFileInput@@PAVFileOutput@@@Z
_TEXT	SEGMENT
_f_Plain$ = 8						; size = 4
?decrypt@EncryptedContentInfo@@QAEHPAEPAVFileInput@@PAVFileOutput@@@Z PROC ; EncryptedContentInfo::decrypt, COMDAT
; _this$ = esi
; _CEK$ = edx
; _f_Cipher$ = edi

; 126  : {

  00000	51		 push	 ecx

; 127  : 	//暗号用の処理バッファ
; 128  : 	union {
; 129  : 		unsigned	char	c[	(Encrypt_Buff)];
; 130  : 					__m128i	xmm[(Encrypt_Buff/sizeof(__m128i))];
; 131  : 	} static __declspec(align(16)) Buff;
; 132  : 
; 133  : 	int		iPad;
; 134  : 
; 135  : 	//------------------
; 136  : 	//鍵の設定
; 137  : 	contentEncryptionAlgorithm->Set_Key(CEK);

  00001	8b 4e 48	 mov	 ecx, DWORD PTR [esi+72]
  00004	8b 01		 mov	 eax, DWORD PTR [ecx]
  00006	8b 40 0c	 mov	 eax, DWORD PTR [eax+12]
  00009	53		 push	 ebx
  0000a	8b 5c 24 0c	 mov	 ebx, DWORD PTR _f_Plain$[esp+4]
  0000e	52		 push	 edx
  0000f	ff d0		 call	 eax

; 138  : 
; 139  : 	//------------------
; 140  : 	//復号処理
; 141  : 	do {
; 142  : 		//高速化の為、ある程度読み込んで、一気に暗号処理をする。
; 143  : 		f_Cipher->read((char *)Buff.c, Encrypt_Buff);

  00011	68 00 08 00 00	 push	 2048			; 00000800H
  00016	68 00 00 00 00	 push	 OFFSET ?Buff@?1??decrypt@EncryptedContentInfo@@QAEHPAEPAVFileInput@@PAVFileOutput@@@Z@4T<unnamed-type-Buff>@?1??12@QAEH012@Z@A
  0001b	57		 push	 edi
  0001c	e8 00 00 00 00	 call	 ?_Read_s@?$basic_istream@DU?$char_traits@D@std@@@std@@QAEAAV12@PADIH@Z ; std::basic_istream<char,std::char_traits<char> >::_Read_s

; 144  : 
; 145  : 		if(szContent > Encrypt_Buff){

  00021	81 be ac 00 00
	00 00 08 00 00	 cmp	 DWORD PTR [esi+172], 2048 ; 00000800H
  0002b	76 4d		 jbe	 SHORT $LN3@decrypt@2
  0002d	8d 49 00	 npad	 3
$LL6@decrypt@2:

; 146  : 			contentEncryptionAlgorithm->decipher((char *)Buff.c, Encrypt_Buff);

  00030	8b 4e 48	 mov	 ecx, DWORD PTR [esi+72]
  00033	8b 11		 mov	 edx, DWORD PTR [ecx]
  00035	8b 42 30	 mov	 eax, DWORD PTR [edx+48]
  00038	68 00 08 00 00	 push	 2048			; 00000800H
  0003d	68 00 00 00 00	 push	 OFFSET ?Buff@?1??decrypt@EncryptedContentInfo@@QAEHPAEPAVFileInput@@PAVFileOutput@@@Z@4T<unnamed-type-Buff>@?1??12@QAEH012@Z@A
  00042	ff d0		 call	 eax

; 147  : 			f_Plain->write((char *)Buff.c, Encrypt_Buff);

  00044	68 00 08 00 00	 push	 2048			; 00000800H
  00049	68 00 00 00 00	 push	 OFFSET ?Buff@?1??decrypt@EncryptedContentInfo@@QAEHPAEPAVFileInput@@PAVFileOutput@@@Z@4T<unnamed-type-Buff>@?1??12@QAEH012@Z@A
  0004e	53		 push	 ebx
  0004f	e8 00 00 00 00	 call	 ?write@?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV12@PBDH@Z ; std::basic_ostream<char,std::char_traits<char> >::write

; 148  : 			szContent -= Encrypt_Buff;

  00054	81 86 ac 00 00
	00 00 f8 ff ff	 add	 DWORD PTR [esi+172], -2048 ; fffff800H
  0005e	68 00 08 00 00	 push	 2048			; 00000800H
  00063	68 00 00 00 00	 push	 OFFSET ?Buff@?1??decrypt@EncryptedContentInfo@@QAEHPAEPAVFileInput@@PAVFileOutput@@@Z@4T<unnamed-type-Buff>@?1??12@QAEH012@Z@A
  00068	57		 push	 edi
  00069	e8 00 00 00 00	 call	 ?_Read_s@?$basic_istream@DU?$char_traits@D@std@@@std@@QAEAAV12@PADIH@Z ; std::basic_istream<char,std::char_traits<char> >::_Read_s
  0006e	81 be ac 00 00
	00 00 08 00 00	 cmp	 DWORD PTR [esi+172], 2048 ; 00000800H
  00078	77 b6		 ja	 SHORT $LL6@decrypt@2
$LN3@decrypt@2:

; 149  : 		} else {
; 150  : 			iPad = contentEncryptionAlgorithm->decipher_last((char *)Buff.c, szContent);

  0007a	8b 4e 48	 mov	 ecx, DWORD PTR [esi+72]
  0007d	8b 86 ac 00 00
	00		 mov	 eax, DWORD PTR [esi+172]
  00083	8b 11		 mov	 edx, DWORD PTR [ecx]
  00085	8b 52 38	 mov	 edx, DWORD PTR [edx+56]
  00088	50		 push	 eax
  00089	68 00 00 00 00	 push	 OFFSET ?Buff@?1??decrypt@EncryptedContentInfo@@QAEHPAEPAVFileInput@@PAVFileOutput@@@Z@4T<unnamed-type-Buff>@?1??12@QAEH012@Z@A
  0008e	ff d2		 call	 edx

; 151  : 			if(iPad == -1){

  00090	83 f8 ff	 cmp	 eax, -1
  00093	75 07		 jne	 SHORT $LN1@decrypt@2

; 152  : 				return(iPad);

  00095	0b c0		 or	 eax, eax

; 161  : }

  00097	5b		 pop	 ebx
  00098	59		 pop	 ecx
  00099	c2 04 00	 ret	 4
$LN1@decrypt@2:

; 153  : 			}
; 154  : 			//Paddingデータに基づいてファイル出力
; 155  : 			f_Plain->write((char *)Buff.c, szContent - iPad);

  0009c	8b 8e ac 00 00
	00		 mov	 ecx, DWORD PTR [esi+172]
  000a2	2b c8		 sub	 ecx, eax
  000a4	51		 push	 ecx
  000a5	68 00 00 00 00	 push	 OFFSET ?Buff@?1??decrypt@EncryptedContentInfo@@QAEHPAEPAVFileInput@@PAVFileOutput@@@Z@4T<unnamed-type-Buff>@?1??12@QAEH012@Z@A
  000aa	53		 push	 ebx
  000ab	e8 00 00 00 00	 call	 ?write@?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV12@PBDH@Z ; std::basic_ostream<char,std::char_traits<char> >::write

; 156  : 			break;
; 157  : 		}
; 158  : 	} while(1);
; 159  : 
; 160  : 	return(0);

  000b0	33 c0		 xor	 eax, eax

; 161  : }

  000b2	5b		 pop	 ebx
  000b3	59		 pop	 ecx
  000b4	c2 04 00	 ret	 4
?decrypt@EncryptedContentInfo@@QAEHPAEPAVFileInput@@PAVFileOutput@@@Z ENDP ; EncryptedContentInfo::decrypt
_TEXT	ENDS
PUBLIC	?encrypt@EncryptedContentInfo@@QAEHPAEPAVFileInput@@PAVFileOutput@@@Z ; EncryptedContentInfo::encrypt
;	COMDAT ?Buff@?1??encrypt@EncryptedContentInfo@@QAEHPAEPAVFileInput@@PAVFileOutput@@@Z@4T<unnamed-type-Buff>@?1??12@QAEH012@Z@A
; File c:\program files\microsoft visual studio 9.0\vc\include\istream
_BSS	SEGMENT
?Buff@?1??encrypt@EncryptedContentInfo@@QAEHPAEPAVFileInput@@PAVFileOutput@@@Z@4T<unnamed-type-Buff>@?1??12@QAEH012@Z@A DB 0800H DUP (?) ; `EncryptedContentInfo::encrypt'::`2'::Buff
; Function compile flags: /Ogtpy
; File i:\渡部篤史\my project\cms\cms\asn1\pkcs7\encryptedcontentinfo.cpp
_BSS	ENDS
;	COMDAT ?encrypt@EncryptedContentInfo@@QAEHPAEPAVFileInput@@PAVFileOutput@@@Z
_TEXT	SEGMENT
_f_Cipher$ = 8						; size = 4
?encrypt@EncryptedContentInfo@@QAEHPAEPAVFileInput@@PAVFileOutput@@@Z PROC ; EncryptedContentInfo::encrypt, COMDAT
; _this$ = esi
; _CEK$ = edx
; _f_Plain$ = edi

; 75   : {

  00000	51		 push	 ecx

; 76   : 	//暗号用の処理バッファ
; 77   : 	union {
; 78   : 		unsigned	char	c[	(Encrypt_Buff)];
; 79   : 					__m128i	xmm[(Encrypt_Buff/sizeof(__m128i))];
; 80   : 	} static __declspec(align(16)) Buff;
; 81   : 
; 82   : 	int		iPad;
; 83   : 
; 84   : 	//------------------
; 85   : 	//鍵の設定
; 86   : 	contentEncryptionAlgorithm->Set_Key(CEK);

  00001	8b 4e 48	 mov	 ecx, DWORD PTR [esi+72]
  00004	8b 01		 mov	 eax, DWORD PTR [ecx]
  00006	8b 40 0c	 mov	 eax, DWORD PTR [eax+12]
  00009	53		 push	 ebx
  0000a	8b 5c 24 0c	 mov	 ebx, DWORD PTR _f_Cipher$[esp+4]
  0000e	52		 push	 edx
  0000f	ff d0		 call	 eax

; 87   : 
; 88   : 	//------------------
; 89   : 	//暗号処理
; 90   : 	do{
; 91   : 		//高速化の為、ある程度読み込んで、一気に暗号処理をする。
; 92   : 		f_Plain->read((char *)Buff.c, Encrypt_Buff);

  00011	68 00 08 00 00	 push	 2048			; 00000800H
  00016	68 00 00 00 00	 push	 OFFSET ?Buff@?1??encrypt@EncryptedContentInfo@@QAEHPAEPAVFileInput@@PAVFileOutput@@@Z@4T<unnamed-type-Buff>@?1??12@QAEH012@Z@A
  0001b	57		 push	 edi
  0001c	e8 00 00 00 00	 call	 ?_Read_s@?$basic_istream@DU?$char_traits@D@std@@@std@@QAEAAV12@PADIH@Z ; std::basic_istream<char,std::char_traits<char> >::_Read_s

; 93   : 
; 94   : 		if(szContent >= Encrypt_Buff){

  00021	81 be ac 00 00
	00 00 08 00 00	 cmp	 DWORD PTR [esi+172], 2048 ; 00000800H
  0002b	72 4d		 jb	 SHORT $LN2@encrypt@2
  0002d	8d 49 00	 npad	 3
$LL5@encrypt@2:

; 95   : 			contentEncryptionAlgorithm->encipher((char *)Buff.c, Encrypt_Buff);

  00030	8b 4e 48	 mov	 ecx, DWORD PTR [esi+72]
  00033	8b 11		 mov	 edx, DWORD PTR [ecx]
  00035	8b 42 2c	 mov	 eax, DWORD PTR [edx+44]
  00038	68 00 08 00 00	 push	 2048			; 00000800H
  0003d	68 00 00 00 00	 push	 OFFSET ?Buff@?1??encrypt@EncryptedContentInfo@@QAEHPAEPAVFileInput@@PAVFileOutput@@@Z@4T<unnamed-type-Buff>@?1??12@QAEH012@Z@A
  00042	ff d0		 call	 eax

; 96   : 			f_Cipher->write((char *)Buff.c, Encrypt_Buff);

  00044	68 00 08 00 00	 push	 2048			; 00000800H
  00049	68 00 00 00 00	 push	 OFFSET ?Buff@?1??encrypt@EncryptedContentInfo@@QAEHPAEPAVFileInput@@PAVFileOutput@@@Z@4T<unnamed-type-Buff>@?1??12@QAEH012@Z@A
  0004e	53		 push	 ebx
  0004f	e8 00 00 00 00	 call	 ?write@?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV12@PBDH@Z ; std::basic_ostream<char,std::char_traits<char> >::write

; 97   : 			szContent -= Encrypt_Buff;

  00054	81 86 ac 00 00
	00 00 f8 ff ff	 add	 DWORD PTR [esi+172], -2048 ; fffff800H
  0005e	68 00 08 00 00	 push	 2048			; 00000800H
  00063	68 00 00 00 00	 push	 OFFSET ?Buff@?1??encrypt@EncryptedContentInfo@@QAEHPAEPAVFileInput@@PAVFileOutput@@@Z@4T<unnamed-type-Buff>@?1??12@QAEH012@Z@A
  00068	57		 push	 edi
  00069	e8 00 00 00 00	 call	 ?_Read_s@?$basic_istream@DU?$char_traits@D@std@@@std@@QAEAAV12@PADIH@Z ; std::basic_istream<char,std::char_traits<char> >::_Read_s
  0006e	81 be ac 00 00
	00 00 08 00 00	 cmp	 DWORD PTR [esi+172], 2048 ; 00000800H
  00078	73 b6		 jae	 SHORT $LL5@encrypt@2
$LN2@encrypt@2:

; 98   : 		} else {
; 99   : 			iPad = contentEncryptionAlgorithm->encipher_last((char *)Buff.c, szContent);

  0007a	8b 4e 48	 mov	 ecx, DWORD PTR [esi+72]
  0007d	8b 86 ac 00 00
	00		 mov	 eax, DWORD PTR [esi+172]
  00083	8b 11		 mov	 edx, DWORD PTR [ecx]
  00085	8b 52 34	 mov	 edx, DWORD PTR [edx+52]
  00088	50		 push	 eax
  00089	68 00 00 00 00	 push	 OFFSET ?Buff@?1??encrypt@EncryptedContentInfo@@QAEHPAEPAVFileInput@@PAVFileOutput@@@Z@4T<unnamed-type-Buff>@?1??12@QAEH012@Z@A
  0008e	ff d2		 call	 edx

; 100  : 			f_Cipher->write((char *)Buff.c, szContent + iPad);

  00090	8b 8e ac 00 00
	00		 mov	 ecx, DWORD PTR [esi+172]
  00096	03 c8		 add	 ecx, eax
  00098	51		 push	 ecx
  00099	68 00 00 00 00	 push	 OFFSET ?Buff@?1??encrypt@EncryptedContentInfo@@QAEHPAEPAVFileInput@@PAVFileOutput@@@Z@4T<unnamed-type-Buff>@?1??12@QAEH012@Z@A
  0009e	53		 push	 ebx
  0009f	e8 00 00 00 00	 call	 ?write@?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV12@PBDH@Z ; std::basic_ostream<char,std::char_traits<char> >::write

; 101  : 			break;
; 102  : 		}
; 103  : 
; 104  : 	} while(1);
; 105  : 
; 106  : 	return(0);

  000a4	33 c0		 xor	 eax, eax

; 107  : }

  000a6	5b		 pop	 ebx
  000a7	59		 pop	 ecx
  000a8	c2 04 00	 ret	 4
?encrypt@EncryptedContentInfo@@QAEHPAEPAVFileInput@@PAVFileOutput@@@Z ENDP ; EncryptedContentInfo::encrypt
END
