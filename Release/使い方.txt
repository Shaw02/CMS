================================================================

	AES暗号・復号処理ソフトウェア	使用方法

================================================================

本ドキュメントは、TAB=8 で記述されます。



１．特徴
━━━━━━━━━━━━
(1) 暗号文、暗号鍵の各ファイルはRFC勧告に従った標準形式で出力します。
　　（※拡張子は標準化されていない為、独自拡張子です。）
　　【暗号文ファイル（*.p7）】
	PKCS#7 Cryptographic Message Syntax (CMS)
	・Enveloped-data
	・Encrypted-data
　　【暗号鍵ファイル（*.key）】
	PKCS#8 Public-Key Cryptography Standards
	Private-Key Information Syntax Specification Version 1.2
	※対称鍵における秘密鍵用の規格ですが、共通鍵を格納しています。


(2) SSE2(SIMD)命令を用いて、高速に暗号・復号処理を行います。
　　（※SIMD化されているのは、AES暗号・復号の処理ルーチンのみです。）


(3) アセンブリ言語・Ｃ言語によるソースファイル及び、
　　Visual C++.net 2008 Express Editionのプロジェクトファイル付属。

　　尚、本クラスや、ソースコードの流用をする際は、ご一報ください。
　　又、本クラスや、ソースコードの利用により発生したいかなる損害に
　　つきましては法律が許容する最大限において責任を負いませんので、
　　使用者の責任の元、ご利用頂ければ幸いです。





２．暗号の方法
━━━━━━━━━━━━

(1) パスワードを用いる場合。
────────────────────────────
AES [filename.ext] /E /W[password]

とコマンドラインに打ち込む事で、以下のファイルを生成します。
尚、暗号鍵に使用する文字列は、256bit相当の情報量がある方が良いかと思います。

　filename.ext.p7	…　暗号文ファイル（PKCS#7形式）

暗号文のファイルを指定する場合は、オプションスイッチ"/Fc[aes-filename]"を記述して下さい。



(2) 暗号鍵ファイルを用いる場合
────────────────────────────
AES [filename.ext] /E /T6

とコマンドラインに打ち込む事で、以下のファイルを生成します。
"PKCS#7 Enveloped-data Type"タイプのファイルを出力する場合に利用可能です。

　filename.ext.p7	…　暗号文ファイル（PKCS#7形式）
　filename.ext.key	…　暗号鍵ファイル（PKCS#8形式）





３．復号の方法
━━━━━━━━━━━━

AES [filename.ext] /W[password]

とコマンドラインに打ち込む事で、以下のファイルを用いて復号します。
　filename.ext.p7	…　暗号文





４．仕様
━━━━━━━━━━━━
●出力形式
　オプションスイッチ /T[n] により、出力形式を選択できます。
　　3 …　PKCS#7 Encrypted-data Type　(Default)
　　6 …　PKCS#7 Enveloped-data Type

※"PKCS#7 Encrypted-data Type"は、パスワードによっては辞書攻撃に弱い為、
　"PKCS#7 Enveloped-data Type"形式で出力することをお勧めします。

●コンテンツ暗号アルゴリズム
　オプションスイッチ /M[n] により、暗号利用モードを選択できます。
　現在は、以下の３つのみ対応しています。
　　1 …　DES-CBC
　　2 …　DES-3EDE-CBC
　　3 …　AES-CBC 128bit
　　4 …　AES-CBC 192bit
　　5 …　AES-CBC 256bit　(Default)

●鍵管理手法（"PKCS#7 Enveloped-data Type"）
　鍵導出（パスワード）
　鍵導出関数　…　PBKDF2
　　　　　　　　　（鍵付きハッシュ関数は、HMAC-SHA-256を使用します。）
　鍵暗号関数　…　PWRI-KEK
　鍵ラップ　　…　コンテンツ暗号アルゴリズムと同じ暗号を使います
　　　　　　　　　（※初期化ベクタIVは異なります。）

●パスワード処理法（"PKCS#7 Encrypted-data Type"）
　パスワード文字列に、ハッシュ関数"SHA-256"を通した値を暗号鍵に使用します。





５．著作権
━━━━━━━━━━━━

Copyright (c) A.Watanabe (2011 - 2012), All Rights Reserved

●連絡先
・E-mail	sha_w@nifty.com
・URL		http://homepage1.nifty.com/~sha_w/
・mixi		http://mixi.jp/show_profile.pl?id=16558



●ＡＥＳ
────────
Joan Daemen博士, Vincent Rijmen博士


●ＳＨＡ
────────
アメリカ国家安全保障局（NSA）


●Mersenne Twister
────────
Copyright (C) 1997 - 2002, Makoto Matsumoto and Takuji Nishimura, All rights reserved.
松本眞教授　西村拓士助手


   A C-program for MT19937, with initialization improved 2002/1/26.
   Coded by Takuji Nishimura and Makoto Matsumoto.

   Before using, initialize the state by using init_genrand(seed)  
   or init_by_array(init_key, key_length).

   Copyright (C) 1997 - 2002, Makoto Matsumoto and Takuji Nishimura,
   All rights reserved.                          

   Redistribution and use in source and binary forms, with or without
   modification, are permitted provided that the following conditions
   are met:

     1. Redistributions of source code must retain the above copyright
        notice, this list of conditions and the following disclaimer.

     2. Redistributions in binary form must reproduce the above copyright
        notice, this list of conditions and the following disclaimer in the
        documentation and/or other materials provided with the distribution.

     3. The names of its contributors may not be used to endorse or promote 
        products derived from this software without specific prior written 
        permission.

   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
   "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
   LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
   A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR
   CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
   EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
   PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
   PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
   LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
   NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
   SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.


   Any feedback is very welcome.
   http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/emt.html
   email: m-mat @ math.sci.hiroshima-u.ac.jp (remove space)

